var Plottable;!function(a){var b;!function(b){var c;!function(b){function c(a,b,c){return Math.min(b,c)<=a&&a<=Math.max(b,c)}function d(a,b,c){return Math.min(Math.max(b,a),c)}function e(b){a.Configs.SHOW_WARNINGS&&null!=window.console&&(null!=window.console.warn?console.warn(b):null!=window.console.log&&console.log(b))}function f(a,b){if(a.length!==b.length)throw new Error("attempted to add arrays of unequal length");return a.map(function(c,d){return a[d]+b[d]})}function g(a,b){var c=d3.set();return a.forEach(function(a){b.has(a)&&c.add(a)}),c}function h(a,b){var c=d3.set();return a.forEach(function(a){return c.add(a)}),b.forEach(function(a){return c.add(a)}),c}function i(a,b){var c=d3.map();return a.forEach(function(a,d){c.set(a,b(a,d))}),c}function j(a){var b=d3.set(),c=[];return a.forEach(function(a){b.has(a)||(b.add(a),c.push(a))}),c}function k(a,b){for(var c=[],d=0;b>d;d++)c[d]="function"==typeof a?a(d):a;return c}function l(a){return Array.prototype.concat.apply([],a)}function m(a,b){if(null==a||null==b)return a===b;if(a.length!==b.length)return!1;for(var c=0;c<a.length;c++)if(a[c]!==b[c])return!1;return!0}function n(a,b){if(null==a||null==b)return a===b;var c=Object.keys(a).sort(),d=Object.keys(b).sort(),e=c.map(function(b){return a[b]}),f=d.map(function(a){return b[a]});return m(c,d)&&m(e,f)}function o(a,b,c){var d="function"==typeof b?b:null,e=null==d?b:c,f=null==d?d3.max(a):d3.max(a,d);return void 0!==f?f:e}function p(a,b,c){var d="function"==typeof b?b:null,e=null==d?b:c,f=null==d?d3.min(a):d3.min(a,d);return void 0!==f?f:e}function q(a){return a!==a}function r(b){return"number"==typeof b&&!a.Utils.Methods.isNaN(b)&&isFinite(b)}function s(a){var b={};return d3.keys(a).forEach(function(c){return b[c]=a[c]}),b}function t(a,b,c){if(void 0===c&&(c=1),0===c)throw new Error("step cannot be 0");for(var d=Math.max(Math.ceil((b-a)/c),0),e=[],f=0;d>f;++f)e[f]=a+c*f;return e}function u(a,b){for(var c=[],d=2;d<arguments.length;d++)c[d-2]=arguments[d];return 0===b?(a(c),-1):window.setTimeout(a,b,c)}function v(a,b){a.classed(b,!0);var c=a.style("background-color");if("transparent"===c)return null;var d=/\((.+)\)/.exec(c)[1].split(",").map(function(a){var b=+a,c=b.toString(16);return 16>b?"0"+c:c});if(4===d.length&&"00"===d[3])return null;var e="#"+d.join("");return a.classed(b,!1),e}function w(a,b){var c=d3.hsl(a).brighter(b);return c.rgb().toString()}function x(a,b){return Math.pow(b.y-a.y,2)+Math.pow(b.x-a.x,2)}function y(){var a=window.navigator.userAgent;return a.indexOf("MSIE ")>-1||a.indexOf("Trident/")>-1}function z(a,b,c,d){void 0===d&&(d=.5);var e=A(a),f=A(b);return c.x+c.width>=e.min-d&&c.x<=e.max+d&&c.y+c.height>=f.min-d&&c.y<=f.max+d}function A(a){if("number"==typeof a)return{min:a,max:a};if(a instanceof Object&&"min"in a&&"max"in a)return a;throw new Error("input '"+a+"' can't be parsed as an Extent")}b.inRange=c,b.clamp=d,b.warn=e,b.addArrays=f,b.intersection=g,b.union=h,b.populateMap=i,b.uniq=j,b.createFilledArray=k,b.flatten=l,b.arrayEq=m,b.objEq=n,b.max=o,b.min=p,b.isNaN=q,b.isValidNumber=r,b.copyMap=s,b.range=t,b.setTimeout=u,b.colorTest=v,b.lightenColor=w,b.distanceSquared=x,b.isIE=y,b.intersectsBBox=z,b.parseExtent=A}(c=b.Methods||(b.Methods={}))}(b=a.Utils||(a.Utils={}))}(Plottable||(Plottable={}));var Plottable;!function(a){var b;!function(a){var b;!function(a){function b(a,b,c){return a.copy().domain(b).nice(c).domain()}a.niceDomain=b}(b=a.D3Scale||(a.D3Scale={}))}(b=a.Utils||(a.Utils={}))}(Plottable||(Plottable={}));var Plottable;!function(a){var b;!function(a){var b=function(){function a(){this._keyValuePairs=[]}return a.prototype.set=function(a,b){if(a!==a)throw new Error("NaN may not be used as a key to the Map");for(var c=0;c<this._keyValuePairs.length;c++)if(this._keyValuePairs[c].key===a)return this._keyValuePairs[c].value=b,!0;return this._keyValuePairs.push({key:a,value:b}),!1},a.prototype.get=function(a){for(var b=0;b<this._keyValuePairs.length;b++)if(this._keyValuePairs[b].key===a)return this._keyValuePairs[b].value;return void 0},a.prototype.has=function(a){for(var b=0;b<this._keyValuePairs.length;b++)if(this._keyValuePairs[b].key===a)return!0;return!1},a.prototype.values=function(){return this._keyValuePairs.map(function(a){return a.value})},a.prototype.keys=function(){return this._keyValuePairs.map(function(a){return a.key})},a.prototype["delete"]=function(a){for(var b=0;b<this._keyValuePairs.length;b++)if(this._keyValuePairs[b].key===a)return this._keyValuePairs.splice(b,1),!0;return!1},a}();a.Map=b}(b=a.Utils||(a.Utils={}))}(Plottable||(Plottable={}));var Plottable;!function(a){var b;!function(a){var b=function(){function a(){this._values=[]}return a.prototype.add=function(a){return this.has(a)||this._values.push(a),this},a.prototype["delete"]=function(a){var b=this._values.indexOf(a);return-1!==b?(this._values.splice(b,1),!0):!1},a.prototype.has=function(a){return-1!==this._values.indexOf(a)},a.prototype.values=function(){return this._values},a}();a.Set=b}(b=a.Utils||(a.Utils={}))}(Plottable||(Plottable={}));var Plottable;!function(a){var b;!function(a){var b;!function(a){function b(a){var b;try{b=a.node().getBBox()}catch(c){b={x:0,y:0,width:0,height:0}}return b}function c(b){null!=window.requestAnimationFrame?window.requestAnimationFrame(b):setTimeout(b,a.POLYFILL_TIMEOUT_MSEC)}function d(a,b){var c=a.getPropertyValue(b),d=parseFloat(c);return d!==d?0:d}function e(a){for(var b=a.node();null!==b&&"svg"!==b.nodeName.toLowerCase();)b=b.parentNode;return null==b}function f(a){var b=window.getComputedStyle(a);return d(b,"width")+d(b,"padding-left")+d(b,"padding-right")+d(b,"border-left-width")+d(b,"border-right-width")}function g(a){var b=window.getComputedStyle(a);return d(b,"height")+d(b,"padding-top")+d(b,"padding-bottom")+d(b,"border-top-width")+d(b,"border-bottom-width")}function h(a){var b=a.node().clientWidth;if(0===b){var c=a.attr("width");if(-1!==c.indexOf("%")){for(var d=a.node().parentNode;null!=d&&0===d.clientWidth;)d=d.parentNode;if(null==d)throw new Error("Could not compute width of element");b=d.clientWidth*parseFloat(c)/100}else b=parseFloat(c)}return b}function i(a,b,c){var d=d3.transform(a.attr("transform"));return null==b?d.translate:(c=null==c?0:c,d.translate[0]=b,d.translate[1]=c,a.attr("transform",d.toString()),a)}function j(a,b){return a.right<b.left?!1:a.left>b.right?!1:a.bottom<b.top?!1:a.top>b.bottom?!1:!0}function k(a,b){return Math.floor(b.left)<=Math.ceil(a.left)&&Math.floor(b.top)<=Math.ceil(a.top)&&Math.floor(a.right)<=Math.ceil(b.right)&&Math.floor(a.bottom)<=Math.ceil(b.bottom)}function l(a){var b=a.ownerSVGElement;return null!=b?b:"svg"===a.nodeName.toLowerCase()?a:null}function m(){return"plottableClipPath"+ ++n}a.getBBox=b,a.POLYFILL_TIMEOUT_MSEC=1e3/60,a.requestAnimationFramePolyfill=c,a.isSelectionRemovedFromSVG=e,a.getElementWidth=f,a.getElementHeight=g,a.getSVGPixelWidth=h,a.translate=i,a.boxesOverlap=j,a.boxIsInside=k,a.getBoundingSVG=l;var n=0;a.getUniqueClipPathId=m}(b=a.DOM||(a.DOM={}))}(b=a.Utils||(a.Utils={}))}(Plottable||(Plottable={}));var Plottable;!function(a){var b;!function(a){var b;!function(a){function b(a){var b=d3.rgb(a),c=function(a){return a/=255,.03928>=a?a/12.92:Math.pow((a+.055)/1.055,2.4)},d=c(b.r),e=c(b.g),f=c(b.b);return.2126*d+.7152*e+.0722*f}function c(a,c){var d=b(a)+.05,e=b(c)+.05;return d>e?d/e:e/d}a.contrast=c}(b=a.Colors||(a.Colors={}))}(b=a.Utils||(a.Utils={}))}(Plottable||(Plottable={}));var __extends=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c},Plottable;!function(a){var b;!function(a){var b=function(a){function b(){a.apply(this,arguments)}return __extends(b,a),b.prototype.callCallbacks=function(){for(var a=this,b=[],c=0;c<arguments.length;c++)b[c-0]=arguments[c];return this.values().forEach(function(c){c.apply(a,b)}),this},b}(a.Set);a.CallbackSet=b}(b=a.Utils||(a.Utils={}))}(Plottable||(Plottable={}));var Plottable;!function(a){a.MILLISECONDS_IN_ONE_DAY=864e5;var b;!function(b){function c(a,c,d){void 0===a&&(a=2),void 0===c&&(c="$"),void 0===d&&(d=!0);var e=b.fixed(a);return function(a){var b=e(Math.abs(a));return""!==b&&(d?b=c+b:b+=c,0>a&&(b="-"+b)),b}}function d(a){return void 0===a&&(a=3),m(a),function(b){return b.toFixed(a)}}function e(a){return void 0===a&&(a=3),m(a),function(b){if("number"==typeof b){var c=Math.pow(10,a);return String(Math.round(b*c)/c)}return String(b)}}function f(){return function(a){return String(a)}}function g(a){void 0===a&&(a=0);var c=b.fixed(a);return function(a){var b=100*a,d=a.toString(),e=Math.pow(10,d.length-(d.indexOf(".")+1));return b=parseInt((b*e).toString(),10)/e,c(b)+"%"}}function h(a){return void 0===a&&(a=3),m(a),function(b){return d3.format("."+a+"s")(b)}}function i(){var a=8,b={};return b[0]={format:".%L",filter:function(a){return 0!==a.getMilliseconds()}},b[1]={format:":%S",filter:function(a){return 0!==a.getSeconds()}},b[2]={format:"%I:%M",filter:function(a){return 0!==a.getMinutes()}},b[3]={format:"%I %p",filter:function(a){return 0!==a.getHours()}},b[4]={format:"%a %d",filter:function(a){return 0!==a.getDay()&&1!==a.getDate()}},b[5]={format:"%b %d",filter:function(a){return 1!==a.getDate()}},b[6]={format:"%b",filter:function(a){return 0!==a.getMonth()}},b[7]={format:"%Y",filter:function(){return!0}},function(c){for(var d=0;a>d;d++)if(b[d].filter(c))return d3.time.format(b[d].format)(c)}}function j(a){return d3.time.format(a)}function k(b){switch(b){case a.TimeInterval.second:return d3.time.second;case a.TimeInterval.minute:return d3.time.minute;case a.TimeInterval.hour:return d3.time.hour;case a.TimeInterval.day:return d3.time.day;case a.TimeInterval.week:return d3.time.week;case a.TimeInterval.month:return d3.time.month;case a.TimeInterval.year:return d3.time.year;default:throw Error("TimeInterval specified does not exist: "+b)}}function l(b,c,d){return void 0===b&&(b=0),void 0===c&&(c=a.MILLISECONDS_IN_ONE_DAY),void 0===d&&(d=""),function(a){var e=Math.round((a.valueOf()-b)/c);return e.toString()+d}}function m(a){if(0>a||a>20)throw new RangeError("Formatter precision must be between 0 and 20")}b.currency=c,b.fixed=d,b.general=e,b.identity=f,b.percentage=g,b.siSuffix=h,b.multiTime=i,b.time=j,b.timeIntervalToD3Time=k,b.relativeDate=l}(b=a.Formatters||(a.Formatters={}))}(Plottable||(Plottable={}));var Plottable;!function(a){var b;!function(a){function b(){return function(a){return d3.svg.symbol().type("circle").size(Math.PI*Math.pow(a/2,2))()}}function c(){return function(a){return d3.svg.symbol().type("square").size(Math.pow(a,2))()}}function d(){return function(a){return d3.svg.symbol().type("cross").size(5/9*Math.pow(a,2))()}}function e(){return function(a){return d3.svg.symbol().type("diamond").size(Math.tan(Math.PI/6)*Math.pow(a,2)/2)()}}function f(){return function(a){return d3.svg.symbol().type("triangle-up").size(Math.sqrt(3)*Math.pow(a/2,2))()}}function g(){return function(a){return d3.svg.symbol().type("triangle-down").size(Math.sqrt(3)*Math.pow(a/2,2))()}}a.circle=b,a.square=c,a.cross=d,a.diamond=e,a.triangleUp=f,a.triangleDown=g}(b=a.SymbolFactories||(a.SymbolFactories={}))}(Plottable||(Plottable={}));var Plottable;!function(a){var b;!function(a){var b=function(){function b(a){this._svg=a,this._measureRect=document.createElementNS(a.namespaceURI,"rect"),this._measureRect.setAttribute("class","measure-rect"),this._measureRect.setAttribute("style","opacity: 0; visibility: hidden;"),this._measureRect.setAttribute("width","1"),this._measureRect.setAttribute("height","1"),this._svg.appendChild(this._measureRect)}return b.getTranslator=function(c){var d=a.DOM.getBoundingSVG(c),e=d[b._TRANSLATOR_KEY];return null==e&&(e=new b(d),d[b._TRANSLATOR_KEY]=e),e},b.prototype.computePosition=function(a,b){this._measureRect.setAttribute("x","0"),this._measureRect.setAttribute("y","0");var c=this._measureRect.getBoundingClientRect(),d={x:c.left,y:c.top},e=100;this._measureRect.setAttribute("x",String(e)),this._measureRect.setAttribute("y",String(e)),c=this._measureRect.getBoundingClientRect();var f={x:c.left,y:c.top};if(d.x===f.x||d.y===f.y)return null;var g=(f.x-d.x)/e,h=(f.y-d.y)/e;this._measureRect.setAttribute("x",String((a-d.x)/g)),this._measureRect.setAttribute("y",String((b-d.y)/h)),c=this._measureRect.getBoundingClientRect();var i={x:c.left,y:c.top},j={x:(i.x-d.x)/g,y:(i.y-d.y)/h};return j},b._TRANSLATOR_KEY="__Plottable_ClientToSVGTranslator",b}();a.ClientToSVGTranslator=b}(b=a.Utils||(a.Utils={}))}(Plottable||(Plottable={}));var Plottable;!function(a){var b;!function(a){a.SHOW_WARNINGS=!0}(b=a.Configs||(a.Configs={}))}(Plottable||(Plottable={}));var Plottable;!function(a){a.version="1.0.0-rc2"}(Plottable||(Plottable={}));var Plottable;!function(a){var b=function(){function b(b,c){void 0===b&&(b=[]),void 0===c&&(c={}),this._data=b,this._metadata=c,this._callbacks=new a.Utils.CallbackSet}return b.prototype.onUpdate=function(a){this._callbacks.add(a)},b.prototype.offUpdate=function(a){this._callbacks["delete"](a)},b.prototype.data=function(a){return null==a?this._data:(this._data=a,this._callbacks.callCallbacks(this),this)},b.prototype.metadata=function(a){return null==a?this._metadata:(this._metadata=a,this._callbacks.callCallbacks(this),this)},b}();a.Dataset=b}(Plottable||(Plottable={}));var Plottable;!function(a){var b;!function(b){var c=function(){function b(){}return b.prototype.render=function(){a.RenderController.flush()},b}();b.Immediate=c;var d=function(){function b(){}return b.prototype.render=function(){a.Utils.DOM.requestAnimationFramePolyfill(a.RenderController.flush)},b}();b.AnimationFrame=d;var e=function(){function b(){this._timeoutMsec=a.Utils.DOM.POLYFILL_TIMEOUT_MSEC}return b.prototype.render=function(){setTimeout(a.RenderController.flush,this._timeoutMsec)},b}();b.Timeout=e}(b=a.RenderPolicies||(a.RenderPolicies={}))}(Plottable||(Plottable={}));var Plottable;!function(a){var b;!function(b){function c(c){if("string"==typeof c)switch(c.toLowerCase()){case"immediate":c=new a.RenderPolicies.Immediate;break;case"animationframe":c=new a.RenderPolicies.AnimationFrame;break;case"timeout":c=new a.RenderPolicies.Timeout;break;default:return void a.Utils.Methods.warn("Unrecognized renderPolicy: "+c)}b._renderPolicy=c}function d(b){k&&a.Utils.Methods.warn("Registered to render while other components are flushing: request may be ignored"),h.add(b),f()}function e(a){i.add(a),h.add(a),f()}function f(){j||(j=!0,b._renderPolicy.render())}function g(){if(j){i.values().forEach(function(a){return a.computeLayout()}),h.values().forEach(function(a){return a.render()}),k=!0;var b=new a.Utils.Set;h.values().forEach(function(a){try{a.renderImmediately()}catch(c){window.setTimeout(function(){throw c},0),b.add(a)}}),i=new a.Utils.Set,h=b,j=!1,k=!1}}var h=new a.Utils.Set,i=new a.Utils.Set,j=!1,k=!1;b._renderPolicy=new a.RenderPolicies.AnimationFrame,b.setRenderPolicy=c,b.registerToRender=d,b.registerToComputeLayout=e,b.flush=g}(b=a.RenderController||(a.RenderController={}))}(Plottable||(Plottable={}));var Plottable;!function(){}(Plottable||(Plottable={}));var Plottable;!function(a){var b=function(){function b(){this._autoDomainAutomatically=!0,this._domainModificationInProgress=!1,this._callbacks=new a.Utils.CallbackSet,this._extentsProviders=new a.Utils.Set}return b.prototype.extentOfValues=function(){return[]},b.prototype._getAllExtents=function(){var a=this;return d3.merge(this._extentsProviders.values().map(function(b){return b(a)}))},b.prototype._getExtent=function(){return[]},b.prototype.onUpdate=function(a){return this._callbacks.add(a),this},b.prototype.offUpdate=function(a){return this._callbacks["delete"](a),this},b.prototype._dispatchUpdate=function(){this._callbacks.callCallbacks(this)},b.prototype.autoDomain=function(){return this._autoDomainAutomatically=!0,this._setDomain(this._getExtent()),this},b.prototype._autoDomainIfAutomaticMode=function(){this._autoDomainAutomatically&&this.autoDomain()},b.prototype.scale=function(){throw new Error("Subclasses should override scale")},b.prototype.domain=function(a){return null==a?this._getDomain():(this._autoDomainAutomatically=!1,this._setDomain(a),this)},b.prototype._getDomain=function(){throw new Error("Subclasses should override _getDomain")},b.prototype._setDomain=function(a){this._domainModificationInProgress||(this._domainModificationInProgress=!0,this._setBackingScaleDomain(a),this._dispatchUpdate(),this._domainModificationInProgress=!1)},b.prototype._setBackingScaleDomain=function(){throw new Error("Subclasses should override _setBackingDomain")},b.prototype.range=function(a){return null==a?this._getRange():(this._setRange(a),this)},b.prototype._getRange=function(){throw new Error("Subclasses should override _getRange")},b.prototype._setRange=function(){throw new Error("Subclasses should override _setRange")},b.prototype.addExtentsProvider=function(a){return this._extentsProviders.add(a),this._autoDomainIfAutomaticMode(),this},b.prototype.removeExtentsProvider=function(a){return this._extentsProviders["delete"](a),this._autoDomainIfAutomaticMode(),this},b}();a.Scale=b}(Plottable||(Plottable={}));var __extends=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c},Plottable;!function(a){var b=function(b){function c(){b.call(this),this._tickGenerator=function(a){return a.getDefaultTicks()},this._padProportion=.05,this._paddingExceptions=new a.Utils.Map,this._includedValues=new a.Utils.Map}return __extends(c,b),c.prototype.autoDomain=function(){return this._domainMin=null,this._domainMax=null,b.prototype.autoDomain.call(this),this},c.prototype._autoDomainIfAutomaticMode=function(){if(null!=this._domainMin&&null!=this._domainMax)return void this._setDomain([this._domainMin,this._domainMax]);var a=this._getExtent();if(null!=this._domainMin){var c=a[1];return this._domainMin>=c&&(c=this._expandSingleValueDomain([this._domainMin,this._domainMin])[1]),void this._setDomain([this._domainMin,c])}if(null!=this._domainMax){var d=a[0];return this._domainMax<=d&&(d=this._expandSingleValueDomain([this._domainMax,this._domainMax])[0]),void this._setDomain([d,this._domainMax])}b.prototype._autoDomainIfAutomaticMode.call(this)},c.prototype._getExtent=function(){var b,c=this._getAllExtents().filter(function(a){return a.length>0}),d=this._defaultExtent();if(0===c.length)b=d;else{var e=[a.Utils.Methods.min(c,function(a){return a[0]},d[0]),a.Utils.Methods.max(c,function(a){return a[1]},d[1])],f=this._includeValues(e);b=this._padDomain(f)}return null!=this._domainMin&&(b[0]=this._domainMin),null!=this._domainMax&&(b[1]=this._domainMax),b},c.prototype.addPaddingException=function(a,b){return this._paddingExceptions.set(a,b),this._autoDomainIfAutomaticMode(),this},c.prototype.removePaddingException=function(a){return this._paddingExceptions["delete"](a),this._autoDomainIfAutomaticMode(),this},c.prototype.addIncludedValue=function(a,b){return this._includedValues.set(a,b),this._autoDomainIfAutomaticMode(),this},c.prototype.removeIncludedValue=function(a){return this._includedValues["delete"](a),this._autoDomainIfAutomaticMode(),this},c.prototype.padProportion=function(a){if(null==a)return this._padProportion;if(0>a)throw new Error("padProportion must be non-negative");return this._padProportion=a,this._autoDomainIfAutomaticMode(),this},c.prototype._includeValues=function(a){return this._includedValues.values().forEach(function(b){b<a[0]&&(a[0]=b),b>a[1]&&(a[1]=b)}),a},c.prototype._padDomain=function(a){if(a[0].valueOf()===a[1].valueOf())return this._expandSingleValueDomain(a);if(0===this._padProportion)return a;var b=this._padProportion/2,c=a[0],d=a[1],e=this._paddingExceptions.values(),f=-1===e.indexOf(c)?this.invert(this.scale(c)-(this.scale(d)-this.scale(c))*b):c,g=-1===e.indexOf(d)?this.invert(this.scale(d)+(this.scale(d)-this.scale(c))*b):d;return this._niceDomain([f,g])},c.prototype._expandSingleValueDomain=function(a){return a},c.prototype.invert=function(){throw new Error("Subclasses should override _invert")},c.prototype.domain=function(a){return null!=a&&(this._domainMin=a[0],this._domainMax=a[1]),b.prototype.domain.call(this,a)},c.prototype.domainMin=function(a){return null==a?this.domain()[0]:(this._domainMin=a,this._autoDomainIfAutomaticMode(),this)},c.prototype.domainMax=function(a){return null==a?this.domain()[1]:(this._domainMax=a,this._autoDomainIfAutomaticMode(),this)},c.prototype.extentOfValues=function(a){var b=d3.extent(a);return null==b[0]||null==b[1]?[]:b},c.prototype._setDomain=function(c){var d=function(a){return a!==a||1/0===a||a===-1/0};return d(c[0])||d(c[1])?void a.Utils.Methods.warn("Warning: QuantitativeScales cannot take NaN or Infinity as a domain value. Ignoring."):void b.prototype._setDomain.call(this,c)},c.prototype.getDefaultTicks=function(){throw new Error("Subclasses should override _getDefaultTicks")},c.prototype.ticks=function(){return this._tickGenerator(this)},c.prototype._niceDomain=function(){throw new Error("Subclasses should override _niceDomain")},c.prototype._defaultExtent=function(){throw new Error("Subclasses should override _defaultExtent")},c.prototype.tickGenerator=function(a){return null==a?this._tickGenerator:(this._tickGenerator=a,this)},c._DEFAULT_NUM_TICKS=10,c}(a.Scale);a.QuantitativeScale=b}(Plottable||(Plottable={}));var __extends=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c},Plottable;!function(a){var b;!function(b){var c=function(b){function c(){b.call(this),this._d3Scale=d3.scale.linear()}return __extends(c,b),c.prototype._defaultExtent=function(){return[0,1]},c.prototype._expandSingleValueDomain=function(a){return a[0]===a[1]?[a[0]-1,a[1]+1]:a},c.prototype.scale=function(a){return this._d3Scale(a)},c.prototype._getDomain=function(){return this._d3Scale.domain()},c.prototype._setBackingScaleDomain=function(a){this._d3Scale.domain(a)},c.prototype._getRange=function(){return this._d3Scale.range()},c.prototype._setRange=function(a){this._d3Scale.range(a)},c.prototype.invert=function(a){return this._d3Scale.invert(a)},c.prototype.getDefaultTicks=function(){return this._d3Scale.ticks(a.QuantitativeScale._DEFAULT_NUM_TICKS)},c.prototype._niceDomain=function(b,c){return a.Utils.D3Scale.niceDomain(this._d3Scale,b,c)},c}(a.QuantitativeScale);b.Linear=c}(b=a.Scales||(a.Scales={}))}(Plottable||(Plottable={}));var __extends=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c},Plottable;!function(a){var b;!function(b){var c=function(b){function c(a){if(void 0===a&&(a=10),b.call(this),this._showIntermediateTicks=!1,this._d3Scale=d3.scale.linear(),this._base=a,this._pivot=this._base,this._setDomain(this._defaultExtent()),1>=a)throw new Error("ModifiedLogScale: The base must be > 1")}return __extends(c,b),c.prototype.adjustedLog=function(a){var b=0>a?-1:1;return a*=b,a<this._pivot&&(a+=(this._pivot-a)/this._pivot),a=Math.log(a)/Math.log(this._base),a*=b},c.prototype.invertedAdjustedLog=function(a){var b=0>a?-1:1;return a*=b,a=Math.pow(this._base,a),a<this._pivot&&(a=this._pivot*(a-1)/(this._pivot-1)),a*=b},c.prototype.scale=function(a){return this._d3Scale(this.adjustedLog(a))},c.prototype.invert=function(a){return this.invertedAdjustedLog(this._d3Scale.invert(a))},c.prototype._getDomain=function(){return this._untransformedDomain},c.prototype._setDomain=function(a){this._untransformedDomain=a;var c=[this.adjustedLog(a[0]),this.adjustedLog(a[1])];b.prototype._setDomain.call(this,c)},c.prototype._setBackingScaleDomain=function(a){this._d3Scale.domain(a)},c.prototype.ticks=function(){var b=function(a,b,c){return[a,b,c].sort(function(a,b){return a-b})[1]},d=a.Utils.Methods.min(this._untransformedDomain,0),e=a.Utils.Methods.max(this._untransformedDomain,0),f=d,g=b(d,e,-this._pivot),h=b(d,e,this._pivot),i=e,j=this.logTicks(-g,-f).map(function(a){return-a}).reverse(),k=this.logTicks(h,i),l=this._showIntermediateTicks?d3.scale.linear().domain([g,h]).ticks(this._howManyTicks(g,h)):[-this._pivot,0,this._pivot].filter(function(a){return a>=d&&e>=a}),m=j.concat(l).concat(k);return m.length<=1&&(m=d3.scale.linear().domain([d,e]).ticks(c._DEFAULT_NUM_TICKS)),m},c.prototype.logTicks=function(b,c){var d=this,e=this._howManyTicks(b,c);if(0===e)return[];var f=Math.floor(Math.log(b)/Math.log(this._base)),g=Math.ceil(Math.log(c)/Math.log(this._base)),h=d3.range(g,f,-Math.ceil((g-f)/e)),i=this._showIntermediateTicks?Math.floor(e/h.length):1,j=d3.range(this._base,1,-(this._base-1)/i).map(Math.floor),k=a.Utils.Methods.uniq(j),l=h.map(function(a){return k.map(function(b){return Math.pow(d._base,a-1)*b})}),m=a.Utils.Methods.flatten(l),n=m.filter(function(a){return a>=b&&c>=a}),o=n.sort(function(a,b){return a-b});return o},c.prototype._howManyTicks=function(b,d){var e=this.adjustedLog(a.Utils.Methods.min(this._untransformedDomain,0)),f=this.adjustedLog(a.Utils.Methods.max(this._untransformedDomain,0)),g=this.adjustedLog(b),h=this.adjustedLog(d),i=(h-g)/(f-e),j=Math.ceil(i*c._DEFAULT_NUM_TICKS);return j},c.prototype._niceDomain=function(a){return a},c.prototype.showIntermediateTicks=function(a){return null==a?this._showIntermediateTicks:void(this._showIntermediateTicks=a)},c.prototype._defaultExtent=function(){return[0,this._base]},c.prototype._expandSingleValueDomain=function(a){if(a[0]===a[1]){var b=a[0];return b>0?[b/this._base,b*this._base]:0===b?[-this._base,this._base]:[b*this._base,b/this._base]}return a},c.prototype._getRange=function(){return this._d3Scale.range()},c.prototype._setRange=function(a){this._d3Scale.range(a)},c.prototype.getDefaultTicks=function(){return this._d3Scale.ticks(a.QuantitativeScale._DEFAULT_NUM_TICKS)},c}(a.QuantitativeScale);b.ModifiedLog=c}(b=a.Scales||(a.Scales={}))}(Plottable||(Plottable={}));var __extends=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c},Plottable;!function(a){var b;!function(b){var c=function(b){function c(){b.call(this),this._range=[0,1],this._d3Scale=d3.scale.ordinal();var a=.3;this._innerPadding=c._convertToPlottableInnerPadding(a),this._outerPadding=c._convertToPlottableOuterPadding(.5,a)}return __extends(c,b),c.prototype.extentOfValues=function(b){return a.Utils.Methods.uniq(b)},c.prototype._getExtent=function(){var b=this._getAllExtents();return a.Utils.Methods.uniq(a.Utils.Methods.flatten(b))},c.prototype.domain=function(a){return b.prototype.domain.call(this,a)},c.prototype._setDomain=function(a){b.prototype._setDomain.call(this,a),this.range(this.range())},c.prototype.range=function(a){if(null==a)return this._range;this._range=a;var b=1-1/(1+this.innerPadding()),c=this.outerPadding()/(1+this.innerPadding());return this._d3Scale.rangeBands(a,b,c),this},c._convertToPlottableInnerPadding=function(a){return 1/(1-a)-1},c._convertToPlottableOuterPadding=function(a,b){return a/(1-b)},c.prototype.rangeBand=function(){return this._d3Scale.rangeBand()},c.prototype.stepWidth=function(){return this.rangeBand()*(1+this.innerPadding())},c.prototype.innerPadding=function(a){return null==a?this._innerPadding:(this._innerPadding=a,this.range(this.range()),this._dispatchUpdate(),this)},c.prototype.outerPadding=function(a){return null==a?this._outerPadding:(this._outerPadding=a,this.range(this.range()),this._dispatchUpdate(),this)},c.prototype.scale=function(a){return this._d3Scale(a)+this.rangeBand()/2},c.prototype._getDomain=function(){return this._d3Scale.domain()},c.prototype._setBackingScaleDomain=function(a){this._d3Scale.domain(a)},c.prototype._getRange=function(){return this._d3Scale.range()},c.prototype._setRange=function(a){this._d3Scale.range(a)},c}(a.Scale);b.Category=c}(b=a.Scales||(a.Scales={}))}(Plottable||(Plottable={}));var __extends=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c},Plottable;!function(a){var b;!function(b){var c=function(b){function c(a){b.call(this);var d;switch(a){case null:case void 0:d=d3.scale.ordinal().range(c._getPlottableColors());break;case"Category10":case"category10":case"10":d=d3.scale.category10();break;case"Category20":case"category20":case"20":d=d3.scale.category20();break;case"Category20b":case"category20b":case"20b":d=d3.scale.category20b();break;case"Category20c":case"category20c":case"20c":d=d3.scale.category20c();break;default:throw new Error("Unsupported ColorScale type")}this._d3Scale=d}return __extends(c,b),c.prototype.extentOfValues=function(b){return a.Utils.Methods.uniq(b)},c.prototype._getExtent=function(){var b=this._getAllExtents(),c=[];return b.forEach(function(a){c=c.concat(a)}),a.Utils.Methods.uniq(c)},c._getPlottableColors=function(){for(var b,c=[],d=d3.select("body").append("plottable-color-tester"),e=a.Utils.Methods.colorTest(d,""),f=0;null!==(b=a.Utils.Methods.colorTest(d,"plottable-colors-"+f))&&f<this.MAXIMUM_COLORS_FROM_CSS&&(b!==e||b!==c[c.length-1]);)c.push(b),f++;return d.remove(),c},c.prototype.scale=function(b){var d=this._d3Scale(b),e=this.domain().indexOf(b),f=Math.floor(e/this.range().length),g=Math.log(f*c.LOOP_LIGHTEN_FACTOR+1);return a.Utils.Methods.lightenColor(d,g)},c.prototype._getDomain=function(){return this._d3Scale.domain()},c.prototype._setBackingScaleDomain=function(a){this._d3Scale.domain(a)},c.prototype._getRange=function(){return this._d3Scale.range()},c.prototype._setRange=function(a){this._d3Scale.range(a)},c.LOOP_LIGHTEN_FACTOR=1.6,c.MAXIMUM_COLORS_FROM_CSS=256,c}(a.Scale);b.Color=c}(b=a.Scales||(a.Scales={}))}(Plottable||(Plottable={}));var __extends=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c},Plottable;!function(a){var b;!function(b){var c=function(b){function c(){b.call(this),this._d3Scale=d3.time.scale()}return __extends(c,b),c.prototype.tickInterval=function(b,c){var d=d3.time.scale(),e=a.Formatters.timeIntervalToD3Time(b);return d.domain(this.domain()),d.range(this.range()),d.ticks(e.range,c)},c.prototype._setDomain=function(a){if(a[1]<a[0])throw new Error("Scale.Time domain values must be in chronological order");return b.prototype._setDomain.call(this,a)},c.prototype._defaultExtent=function(){var b=(new Date).valueOf(),c=b-a.MILLISECONDS_IN_ONE_DAY;return[new Date(c),new Date(b)]},c.prototype._expandSingleValueDomain=function(b){var c=b[0].getTime(),d=b[1].getTime();return c===d?[new Date(c-a.MILLISECONDS_IN_ONE_DAY),new Date(d+a.MILLISECONDS_IN_ONE_DAY)]:b},c.prototype.scale=function(a){return this._d3Scale(a)},c.prototype._getDomain=function(){return this._d3Scale.domain()},c.prototype._setBackingScaleDomain=function(a){this._d3Scale.domain(a)},c.prototype._getRange=function(){return this._d3Scale.range()},c.prototype._setRange=function(a){this._d3Scale.range(a)},c.prototype.invert=function(a){return this._d3Scale.invert(a)},c.prototype.getDefaultTicks=function(){return this._d3Scale.ticks(a.QuantitativeScale._DEFAULT_NUM_TICKS)},c.prototype._niceDomain=function(b,c){return a.Utils.D3Scale.niceDomain(this._d3Scale,b,c)},c}(a.QuantitativeScale);b.Time=c}(b=a.Scales||(a.Scales={}))}(Plottable||(Plottable={}));var __extends=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c},Plottable;!function(a){var b;!function(b){var c=function(b){function c(a,d){switch(void 0===a&&(a=c.REDS),void 0===d&&(d="linear"),b.call(this),this._colorRange=a,d){case"linear":this._colorScale=d3.scale.linear();break;case"log":this._colorScale=d3.scale.log();break;case"sqrt":this._colorScale=d3.scale.sqrt();break;case"pow":this._colorScale=d3.scale.pow()}if(null==this._colorScale)throw new Error("unknown QuantitativeScale scale type "+d);
this._d3Scale=this._D3InterpolatedScale()}return __extends(c,b),c.prototype.extentOfValues=function(a){var b=d3.extent(a);return null==b[0]||null==b[1]?[]:b},c.prototype._D3InterpolatedScale=function(){return this._colorScale.range([0,1]).interpolate(this._interpolateColors())},c.prototype._interpolateColors=function(){var a=this._colorRange;if(a.length<2)throw new Error("Color scale arrays must have at least two elements.");return function(){return function(b){b=Math.max(0,Math.min(1,b));var c=b*(a.length-1),d=Math.floor(c),e=Math.ceil(c),f=c-d;return d3.interpolateLab(a[d],a[e])(f)}}},c.prototype.colorRange=function(a){return null==a?this._colorRange:(this._colorRange=a,this._resetScale(),this)},c.prototype._resetScale=function(){this._d3Scale=this._D3InterpolatedScale(),this._autoDomainIfAutomaticMode(),this._dispatchUpdate()},c.prototype.autoDomain=function(){var b=this._getAllExtents();return b.length>0&&this._setDomain([a.Utils.Methods.min(b,function(a){return a[0]},0),a.Utils.Methods.max(b,function(a){return a[1]},0)]),this},c.prototype.scale=function(a){return this._d3Scale(a)},c.prototype._getDomain=function(){return this._d3Scale.domain()},c.prototype._setBackingScaleDomain=function(a){this._d3Scale.domain(a)},c.prototype._getRange=function(){return this.colorRange()},c.prototype._setRange=function(a){this.colorRange(a)},c.REDS=["#FFFFFF","#FFF6E1","#FEF4C0","#FED976","#FEB24C","#FD8D3C","#FC4E2A","#E31A1C","#B10026"],c.BLUES=["#FFFFFF","#CCFFFF","#A5FFFD","#85F7FB","#6ED3EF","#55A7E0","#417FD0","#2545D3","#0B02E1"],c.POSNEG=["#0B02E1","#2545D3","#417FD0","#55A7E0","#6ED3EF","#85F7FB","#A5FFFD","#CCFFFF","#FFFFFF","#FFF6E1","#FEF4C0","#FED976","#FEB24C","#FD8D3C","#FC4E2A","#E31A1C","#B10026"],c}(a.Scale);b.InterpolatedColor=c}(b=a.Scales||(a.Scales={}))}(Plottable||(Plottable={}));var Plottable;!function(a){var b;!function(b){var c;!function(b){function c(b){if(0>=b)throw new Error("interval must be positive number");return function(c){var d=c.domain(),e=Math.min(d[0],d[1]),f=Math.max(d[0],d[1]),g=Math.ceil(e/b)*b,h=Math.floor((f-g)/b)+1,i=e%b===0?[]:[e],j=a.Utils.Methods.range(0,h).map(function(a){return g+a*b}),k=f%b===0?[]:[f];return i.concat(j).concat(k)}}function d(){return function(a){var b=a.getDefaultTicks();return b.filter(function(a,c){return a%1===0||0===c||c===b.length-1})}}b.intervalTickGenerator=c,b.integerTickGenerator=d}(c=b.TickGenerators||(b.TickGenerators={}))}(b=a.Scales||(a.Scales={}))}(Plottable||(Plottable={}));var Plottable;!function(a){var b;!function(b){var c=function(){function b(a){this.key=a}return b.prototype.setClass=function(a){return this._className=a,this},b.prototype.setup=function(a){this._renderArea=a},b.prototype.remove=function(){null!=this._getRenderArea()&&this._getRenderArea().remove()},b.prototype._enterData=function(){},b.prototype._drawStep=function(){},b.prototype._numberOfAnimationIterations=function(a){return a.length},b.prototype._applyMetadata=function(a,b){var c={};return d3.keys(a).forEach(function(d){c[d]=function(c,e){return a[d](c,e,b)}}),c},b.prototype._prepareDrawSteps=function(){},b.prototype._prepareData=function(a){return a},b.prototype.draw=function(b,c,d){var e=this,f=c.map(function(b){var c=e._applyMetadata(b.attrToProjector,d);return e._attrToProjector=a.Utils.Methods.copyMap(c),{attrToProjector:c,animator:b.animator}}),g=this._prepareData(b,f);this._prepareDrawSteps(f),this._enterData(g);var h=this._numberOfAnimationIterations(g),i=0;return f.forEach(function(b){a.Utils.Methods.setTimeout(function(){return e._drawStep(b)},i),i+=b.animator.getTiming(h)}),i},b.prototype._getRenderArea=function(){return this._renderArea},b.prototype._getSelector=function(){return""},b.prototype._getPixelPoint=function(){return null},b.prototype._getSelection=function(a){var b=this._getRenderArea().selectAll(this._getSelector());return d3.select(b[0][a])},b}();b.AbstractDrawer=c}(b=a.Drawers||(a.Drawers={}))}(Plottable||(Plottable={}));var __extends=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c},Plottable;!function(a){var b;!function(b){var c=function(b){function c(){b.apply(this,arguments)}return __extends(c,b),c.prototype._enterData=function(a){b.prototype._enterData.call(this,a),this._pathSelection.datum(a)},c.prototype.setup=function(a){this._pathSelection=a.append("path").classed(c.LINE_CLASS,!0).style({fill:"none","vector-effect":"non-scaling-stroke"}),b.prototype.setup.call(this,a)},c.prototype._createLine=function(a,b,c){return c||(c=function(){return!0}),d3.svg.line().x(a).y(b).defined(c)},c.prototype._numberOfAnimationIterations=function(){return 1},c.prototype._drawStep=function(d){b.prototype._drawStep.call(this,d);var e=a.Utils.Methods.copyMap(d.attrToProjector),f=e.defined,g=e.x,h=e.y;delete e.x,delete e.y,e.defined&&delete e.defined,e.d=this._createLine(g,h,f),e.fill&&this._pathSelection.attr("fill",e.fill),e["class"]&&(this._pathSelection.attr("class",e["class"]),this._pathSelection.classed(c.LINE_CLASS,!0),delete e["class"]),d.animator.animate(this._pathSelection,e)},c.prototype._getSelector=function(){return"."+c.LINE_CLASS},c.prototype._getPixelPoint=function(a,b){return{x:this._attrToProjector.x(a,b),y:this._attrToProjector.y(a,b)}},c.prototype._getSelection=function(){return this._getRenderArea().select(this._getSelector())},c.LINE_CLASS="line",c}(b.AbstractDrawer);b.Line=c}(b=a.Drawers||(a.Drawers={}))}(Plottable||(Plottable={}));var __extends=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c},Plottable;!function(a){var b;!function(b){var c=function(c){function d(){c.apply(this,arguments),this._drawLine=!0}return __extends(d,c),d.prototype._enterData=function(a){this._drawLine?c.prototype._enterData.call(this,a):b.AbstractDrawer.prototype._enterData.call(this,a),this._areaSelection.datum(a)},d.prototype.drawLine=function(a){return this._drawLine=a,this},d.prototype.setup=function(a){this._areaSelection=a.append("path").classed(d.AREA_CLASS,!0).style({stroke:"none"}),this._drawLine?c.prototype.setup.call(this,a):b.AbstractDrawer.prototype.setup.call(this,a)},d.prototype._createArea=function(a,b,c,d){return d||(d=function(){return!0}),d3.svg.area().x(a).y0(b).y1(c).defined(d)},d.prototype._drawStep=function(e){this._drawLine?c.prototype._drawStep.call(this,e):b.AbstractDrawer.prototype._drawStep.call(this,e);var f=a.Utils.Methods.copyMap(e.attrToProjector),g=f.x,h=f.y0,i=f.y,j=f.defined;delete f.x,delete f.y0,delete f.y,f.defined&&delete f.defined,f.d=this._createArea(g,h,i,j),f.fill&&this._areaSelection.attr("fill",f.fill),f["class"]&&(this._areaSelection.attr("class",f["class"]),this._areaSelection.classed(d.AREA_CLASS,!0),delete f["class"]),e.animator.animate(this._areaSelection,f)},d.prototype._getSelector=function(){return"path"},d.AREA_CLASS="area",d}(b.Line);b.Area=c}(b=a.Drawers||(a.Drawers={}))}(Plottable||(Plottable={}));var __extends=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c},Plottable;!function(a){var b;!function(a){var b=function(a){function b(){a.apply(this,arguments)}return __extends(b,a),b.prototype.svgElement=function(a){return this._svgElement=a,this},b.prototype._getDrawSelection=function(){return this._getRenderArea().selectAll(this._svgElement)},b.prototype._drawStep=function(b){a.prototype._drawStep.call(this,b);var c=this._getDrawSelection();b.attrToProjector.fill&&c.attr("fill",b.attrToProjector.fill),b.animator.animate(c,b.attrToProjector)},b.prototype._enterData=function(b){a.prototype._enterData.call(this,b);var c=this._getDrawSelection().data(b);c.enter().append(this._svgElement),null!=this._className&&c.classed(this._className,!0),c.exit().remove()},b.prototype._filterDefinedData=function(a,b){return b?a.filter(b):a},b.prototype._prepareDrawSteps=function(b){a.prototype._prepareDrawSteps.call(this,b),b.forEach(function(a){a.attrToProjector.defined&&delete a.attrToProjector.defined})},b.prototype._prepareData=function(b,c){var d=this;return c.reduce(function(a,b){return d._filterDefinedData(a,b.attrToProjector.defined)},a.prototype._prepareData.call(this,b,c))},b.prototype._getSelector=function(){return this._svgElement},b}(a.AbstractDrawer);a.Element=b}(b=a.Drawers||(a.Drawers={}))}(Plottable||(Plottable={}));var __extends=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c},Plottable;!function(a){var b;!function(b){var c=5,d=5,e=function(b){function e(a,c){b.call(this,a),this._labelsTooWide=!1,this.svgElement("rect"),this._isVertical=c}return __extends(e,b),e.prototype.setup=function(a){b.prototype.setup.call(this,a.append("g").classed("bar-area",!0)),this._textArea=a.append("g").classed("bar-label-text-area",!0),this._measurer=new SVGTypewriter.Measurers.CacheCharacterMeasurer(this._textArea),this._writer=new SVGTypewriter.Writers.Writer(this._measurer)},e.prototype.removeLabels=function(){this._textArea.selectAll("g").remove()},e.prototype._getIfLabelsTooWide=function(){return this._labelsTooWide},e.prototype.drawText=function(b,e,f){var g=this,h=b.map(function(b,h){var i=e.label(b,h,f).toString(),j=e.width(b,h,f),k=e.height(b,h,f),l=e.x(b,h,f),m=e.y(b,h,f),n=e.positive(b,h,f),o=g._measurer.measure(i),p=e.fill(b,h,f),q=1.6*a.Utils.Colors.contrast("white",p)<a.Utils.Colors.contrast("black",p),r=g._isVertical?k:j,s=g._isVertical?o.height:o.width,t=g._isVertical?o.width:o.height,u=g._isVertical?j:k,v=t+2*d>u;if(o.height<=k&&o.width<=j){var w=Math.min((r-s)/2,c);n||(w=-1*w),g._isVertical?m+=w:l+=w;var x=g._textArea.append("g").attr("transform","translate("+l+","+m+")"),y=q?"dark-label":"light-label";x.classed(y,!0);var z,A;g._isVertical?(z="center",A=n?"top":"bottom"):(z=n?"left":"right",A="center");var B={selection:x,xAlign:z,yAlign:A,textRotation:0};g._writer.write(i,j,k,B)}return v});this._labelsTooWide=h.some(function(a){return a})},e.prototype._getPixelPoint=function(a,b){var c=this._attrToProjector.x(a,b),d=this._attrToProjector.y(a,b),e=this._attrToProjector.width(a,b),f=this._attrToProjector.height(a,b),g=this._isVertical?c+e/2:c+e,h=this._isVertical?d:d+f/2;return{x:g,y:h}},e.prototype.draw=function(c,d,e){var f=d[0].attrToProjector,g=a.Utils.Methods.isValidNumber;return c=c.filter(function(a){return g(f.x(a,null,e))&&g(f.y(a,null,e))&&g(f.width(a,null,e))&&g(f.height(a,null,e))}),b.prototype.draw.call(this,c,d,e)},e}(b.Element);b.Rect=e}(b=a.Drawers||(a.Drawers={}))}(Plottable||(Plottable={}));var __extends=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c},Plottable;!function(a){var b;!function(b){var c=function(b){function c(a){b.call(this,a),this._svgElement="path"}return __extends(c,b),c.prototype._createArc=function(a,b){return d3.svg.arc().innerRadius(a).outerRadius(b)},c.prototype.retargetProjectors=function(a){var b={};return d3.entries(a).forEach(function(a){b[a.key]=function(b,c){return a.value(b.data,c)}}),b},c.prototype._drawStep=function(c){var d=a.Utils.Methods.copyMap(c.attrToProjector);d=this.retargetProjectors(d),this._attrToProjector=this.retargetProjectors(this._attrToProjector);var e=d["inner-radius"],f=d["outer-radius"];return delete d["inner-radius"],delete d["outer-radius"],d.d=this._createArc(e,f),b.prototype._drawStep.call(this,{attrToProjector:d,animator:c.animator})},c.prototype.draw=function(c,d,e){var f=function(a,b){return d[0].attrToProjector["sector-value"](a,b,e)};c=c.filter(function(b){return a.Utils.Methods.isValidNumber(+f(b,null))});var g=d3.layout.pie().sort(null).value(f)(c);return d.forEach(function(a){return delete a.attrToProjector["sector-value"]}),g.forEach(function(b){b.value<0&&a.Utils.Methods.warn("Negative values will not render correctly in a pie chart.")}),b.prototype.draw.call(this,g,d,e)},c.prototype._getPixelPoint=function(a,b){var c=this._attrToProjector["inner-radius"],d=this._attrToProjector["outer-radius"],e=(c(a,b)+d(a,b))/2,f=+this._getSelection(b).datum().startAngle,g=+this._getSelection(b).datum().endAngle,h=(f+g)/2;return{x:e*Math.sin(h),y:-e*Math.cos(h)}},c}(b.Element);b.Arc=c}(b=a.Drawers||(a.Drawers={}))}(Plottable||(Plottable={}));var __extends=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c},Plottable;!function(a){var b;!function(b){var c=function(b){function c(a){b.call(this,a),this._svgElement="path",this._className="symbol"}return __extends(c,b),c.prototype._drawStep=function(c){this._attrToProjector=a.Utils.Methods.copyMap(c.attrToProjector),b.prototype._drawStep.call(this,c)},c.prototype._getPixelPoint=function(a,b){return{x:this._attrToProjector.x(a,b),y:this._attrToProjector.y(a,b)}},c}(b.Element);b.Symbol=c}(b=a.Drawers||(a.Drawers={}))}(Plottable||(Plottable={}));var Plottable;!function(a){var b;!function(a){var b=function(){function a(){}return a.TOP="top",a.BOTTOM="bottom",a.LEFT="left",a.RIGHT="right",a.CENTER="center",a}();a.Alignment=b}(b=a.Components||(a.Components={}));var c=function(){function b(){this._clipPathEnabled=!1,this._origin={x:0,y:0},this._xAlignment="left",this._yAlignment="top",this._isSetup=!1,this._isAnchored=!1,this._boxes=[],this._isTopLevelComponent=!1,this._cssClasses=["component"],this._destroyed=!1,this._onAnchorCallbacks=new a.Utils.CallbackSet,this._onDetachCallbacks=new a.Utils.CallbackSet}return b.prototype.anchor=function(a){if(this._destroyed)throw new Error("Can't reuse destroy()-ed components!");return"svg"===a.node().nodeName.toLowerCase()&&(this._rootSVG=a,this._rootSVG.classed("plottable",!0),this._rootSVG.style("overflow","visible"),this._isTopLevelComponent=!0),null!=this._element?a.node().appendChild(this._element.node()):(this._element=a.append("g"),this._setup()),this._isAnchored=!0,this._onAnchorCallbacks.callCallbacks(this),this},b.prototype.onAnchor=function(a){return this._isAnchored&&a(this),this._onAnchorCallbacks.add(a),this},b.prototype.offAnchor=function(a){return this._onAnchorCallbacks["delete"](a),this},b.prototype._setup=function(){var a=this;this._isSetup||(this._cssClasses.forEach(function(b){a._element.classed(b,!0)}),this._cssClasses=null,this._backgroundContainer=this._element.append("g").classed("background-container",!0),this._addBox("background-fill",this._backgroundContainer),this._content=this._element.append("g").classed("content",!0),this._foregroundContainer=this._element.append("g").classed("foreground-container",!0),this._boxContainer=this._element.append("g").classed("box-container",!0),this._clipPathEnabled&&this._generateClipPath(),this._boundingBox=this._addBox("bounding-box"),this._isSetup=!0)},b.prototype.requestedSpace=function(){return{minWidth:0,minHeight:0}},b.prototype.computeLayout=function(c,d,e){var f=this;if(null==c||null==d||null==e){if(null==this._element)throw new Error("anchor() must be called before computeLayout()");if(!this._isTopLevelComponent)throw new Error("null arguments cannot be passed to computeLayout() on a non-root node");c={x:0,y:0},null==this._rootSVG.attr("width")&&this._rootSVG.attr("width","100%"),null==this._rootSVG.attr("height")&&this._rootSVG.attr("height","100%");var g=this._rootSVG.node();d=a.Utils.DOM.getElementWidth(g),e=a.Utils.DOM.getElementHeight(g)}var h=this._getSize(d,e);this._width=h.width,this._height=h.height;var i=b._xAlignToProportion[this._xAlignment],j=b._yAlignToProportion[this._yAlignment];return this._origin={x:c.x+(d-this.width())*i,y:c.y+(e-this.height())*j},this._element.attr("transform","translate("+this._origin.x+","+this._origin.y+")"),this._boxes.forEach(function(a){return a.attr("width",f.width()).attr("height",f.height())}),this},b.prototype._getSize=function(a,b){var c=this.requestedSpace(a,b);return{width:this.fixedWidth()?Math.min(a,c.minWidth):a,height:this.fixedHeight()?Math.min(b,c.minHeight):b}},b.prototype.render=function(){return this._isAnchored&&this._isSetup&&this.width()>=0&&this.height()>=0&&a.RenderController.registerToRender(this),this},b.prototype._scheduleComputeLayout=function(){this._isAnchored&&this._isSetup&&a.RenderController.registerToComputeLayout(this)},b.prototype.renderImmediately=function(){return this},b.prototype.redraw=function(){return this._isAnchored&&this._isSetup&&(this._isTopLevelComponent?this._scheduleComputeLayout():this.parent().redraw()),this},b.prototype.renderTo=function(b){if(this.detach(),null!=b){var c;if(c="string"==typeof b?d3.select(b):b,!c.node()||"svg"!==c.node().nodeName.toLowerCase())throw new Error("Plottable requires a valid SVG to renderTo");this.anchor(c)}if(null==this._element)throw new Error("If a component has never been rendered before, then renderTo must be given a node to render to,           or a D3.Selection, or a selector string");return this.computeLayout(),this.render(),a.RenderController.flush(),this},b.prototype.xAlignment=function(a){if(null==a)return this._xAlignment;if(a=a.toLowerCase(),null==b._xAlignToProportion[a])throw new Error("Unsupported alignment: "+a);return this._xAlignment=a,this.redraw(),this},b.prototype.yAlignment=function(a){if(null==a)return this._yAlignment;if(a=a.toLowerCase(),null==b._yAlignToProportion[a])throw new Error("Unsupported alignment: "+a);return this._yAlignment=a,this.redraw(),this},b.prototype._addBox=function(a,b){if(null==this._element)throw new Error("Adding boxes before anchoring is currently disallowed");b=null==b?this._boxContainer:b;var c=b.append("rect");return null!=a&&c.classed(a,!0),this._boxes.push(c),null!=this.width()&&null!=this.height()&&c.attr("width",this.width()).attr("height",this.height()),c},b.prototype._generateClipPath=function(){var b=/MSIE [5-9]/.test(navigator.userAgent)?"":document.location.href;b=b.split("#")[0];var c=a.Utils.DOM.getUniqueClipPathId();this._element.attr("clip-path",'url("'+b+"#"+c+'")');var d=this._boxContainer.append("clipPath").attr("id",c);this._addBox("clip-rect",d)},b.prototype.classed=function(a,b){if(null==b)return null==a?!1:null==this._element?-1!==this._cssClasses.indexOf(a):this._element.classed(a);if(null==a)return this;if(null==this._element){var c=this._cssClasses.indexOf(a);b&&-1===c?this._cssClasses.push(a):b||-1===c||this._cssClasses.splice(c,1)}else this._element.classed(a,b);return this},b.prototype.fixedWidth=function(){return!1},b.prototype.fixedHeight=function(){return!1},b.prototype.detach=function(){return this.parent(null),this._isAnchored&&this._element.remove(),this._isAnchored=!1,this._onDetachCallbacks.callCallbacks(this),this},b.prototype.onDetach=function(a){return this._onDetachCallbacks.add(a),this},b.prototype.offDetach=function(a){return this._onDetachCallbacks["delete"](a),this},b.prototype.parent=function(a){if(void 0===a)return this._parent;if(null!==a&&!a.has(this))throw new Error("Passed invalid parent");return this._parent=a,this},b.prototype.destroy=function(){this._destroyed=!0,this.detach()},b.prototype.width=function(){return this._width},b.prototype.height=function(){return this._height},b.prototype.origin=function(){return{x:this._origin.x,y:this._origin.y}},b.prototype.originToSVG=function(){for(var a=this.origin(),b=this.parent();null!=b;){var c=b.origin();a.x+=c.x,a.y+=c.y,b=b.parent()}return a},b.prototype.foreground=function(){return this._foregroundContainer},b.prototype.content=function(){return this._content},b.prototype.background=function(){return this._backgroundContainer},b._xAlignToProportion={left:0,center:.5,right:1},b._yAlignToProportion={top:0,center:.5,bottom:1},b}();a.Component=c}(Plottable||(Plottable={}));var __extends=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c},Plottable;!function(a){var b=function(a){function b(){var b=this;a.call(this),this._detachCallback=function(a){return b.remove(a)}}return __extends(b,a),b.prototype.anchor=function(b){var c=this;return a.prototype.anchor.call(this,b),this._forEach(function(a){return a.anchor(c._content)}),this},b.prototype.render=function(){return this._forEach(function(a){return a.render()}),this},b.prototype.has=function(){throw new Error("has() is not implemented on ComponentContainer")},b.prototype._adoptAndAnchor=function(a){a.parent(this),a.onDetach(this._detachCallback),this._isAnchored&&a.anchor(this._content)},b.prototype.remove=function(a){return this.has(a)&&(a.offDetach(this._detachCallback),this._remove(a),a.detach(),this.redraw()),this},b.prototype._remove=function(){return!1},b.prototype._forEach=function(){throw new Error("_forEach() is not implemented on ComponentContainer")},b.prototype.destroy=function(){a.prototype.destroy.call(this),this._forEach(function(a){return a.destroy()})},b}(a.Component);a.ComponentContainer=b}(Plottable||(Plottable={}));var __extends=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c},Plottable;!function(a){var b;!function(b){var c=function(b){function c(a){var c=this;void 0===a&&(a=[]),b.call(this),this._components=[],this.classed("component-group",!0),a.forEach(function(a){return c.append(a)})}return __extends(c,b),c.prototype._forEach=function(a){this._components.forEach(a)},c.prototype.has=function(a){return this._components.indexOf(a)>=0},c.prototype.requestedSpace=function(b,c){var d=this._components.map(function(a){return a.requestedSpace(b,c)});return{minWidth:a.Utils.Methods.max(d,function(a){return a.minWidth},0),minHeight:a.Utils.Methods.max(d,function(a){return a.minHeight},0)}},c.prototype.computeLayout=function(a,c,d){var e=this;return b.prototype.computeLayout.call(this,a,c,d),this._forEach(function(a){a.computeLayout({x:0,y:0},e.width(),e.height())}),this},c.prototype._getSize=function(a,b){return{width:a,height:b}},c.prototype.fixedWidth=function(){return this._components.every(function(a){return a.fixedWidth()})},c.prototype.fixedHeight=function(){return this._components.every(function(a){return a.fixedHeight()})},c.prototype.components=function(){return this._components.slice()},c.prototype.append=function(a){return null==a||this.has(a)||(a.detach(),this._components.push(a),this._adoptAndAnchor(a),this.redraw()),this},c.prototype._remove=function(a){var b=this._components.indexOf(a);return b>=0?(this._components.splice(b,1),!0):!1},c}(a.ComponentContainer);b.Group=c}(b=a.Components||(a.Components={}))}(Plottable||(Plottable={}));var __extends=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c},Plottable;!function(a){var b=function(b){function c(c,d,e){var f=this;if(void 0===e&&(e=a.Formatters.identity()),b.call(this),this._endTickLength=5,this._tickLength=5,this._tickLabelPadding=10,this._gutter=15,this._showEndTickLabels=!1,null==c||null==d)throw new Error("Axis requires a scale and orientation");this._scale=c,this.orientation(d),this._setDefaultAlignment(),this.classed("axis",!0),this._isHorizontal()?this.classed("x-axis",!0):this.classed("y-axis",!0),this.formatter(e),this._rescaleCallback=function(){return f._rescale()},this._scale.onUpdate(this._rescaleCallback)}return __extends(c,b),c.prototype.destroy=function(){b.prototype.destroy.call(this),this._scale.offUpdate(this._rescaleCallback)},c.prototype._isHorizontal=function(){return"top"===this._orientation||"bottom"===this._orientation},c.prototype._computeWidth=function(){return this._computedWidth=this._maxLabelTickLength(),this._computedWidth},c.prototype._computeHeight=function(){return this._computedHeight=this._maxLabelTickLength(),this._computedHeight},c.prototype.requestedSpace=function(){var a=0,b=0;return this._isHorizontal()?(null==this._computedHeight&&this._computeHeight(),b=this._computedHeight+this._gutter):(null==this._computedWidth&&this._computeWidth(),a=this._computedWidth+this._gutter),{minWidth:a,minHeight:b}},c.prototype.fixedHeight=function(){return this._isHorizontal()},c.prototype.fixedWidth=function(){return!this._isHorizontal()},c.prototype._rescale=function(){this.render()},c.prototype.computeLayout=function(a,c,d){return b.prototype.computeLayout.call(this,a,c,d),this._scale.range(this._isHorizontal()?[0,this.width()]:[this.height(),0]),this},c.prototype._setup=function(){b.prototype._setup.call(this),this._tickMarkContainer=this._content.append("g").classed(c.TICK_MARK_CLASS+"-container",!0),this._tickLabelContainer=this._content.append("g").classed(c.TICK_LABEL_CLASS+"-container",!0),this._baseline=this._content.append("line").classed("baseline",!0)},c.prototype._getTickValues=function(){return[]},c.prototype.renderImmediately=function(){var a=this._getTickValues(),b=this._tickMarkContainer.selectAll("."+c.TICK_MARK_CLASS).data(a);return b.enter().append("line").classed(c.TICK_MARK_CLASS,!0),b.attr(this._generateTickMarkAttrHash()),d3.select(b[0][0]).classed(c.END_TICK_MARK_CLASS,!0).attr(this._generateTickMarkAttrHash(!0)),d3.select(b[0][a.length-1]).classed(c.END_TICK_MARK_CLASS,!0).attr(this._generateTickMarkAttrHash(!0)),b.exit().remove(),this._baseline.attr(this._generateBaselineAttrHash()),this},c.prototype._generateBaselineAttrHash=function(){var a={x1:0,y1:0,x2:0,y2:0};switch(this._orientation){case"bottom":a.x2=this.width();break;case"top":a.x2=this.width(),a.y1=this.height(),a.y2=this.height();break;case"left":a.x1=this.width(),a.x2=this.width(),a.y2=this.height();break;case"right":a.y2=this.height()}return a},c.prototype._generateTickMarkAttrHash=function(a){var b=this;void 0===a&&(a=!1);var c={x1:0,y1:0,x2:0,y2:0},d=function(a){return b._scale.scale(a)};this._isHorizontal()?(c.x1=d,c.x2=d):(c.y1=d,c.y2=d);var e=a?this._endTickLength:this._tickLength;switch(this._orientation){case"bottom":c.y2=e;break;case"top":c.y1=this.height(),c.y2=this.height()-e;break;case"left":c.x1=this.width(),c.x2=this.width()-e;break;case"right":c.x2=e}return c},c.prototype.redraw=function(){return this._computedWidth=null,this._computedHeight=null,b.prototype.redraw.call(this)},c.prototype._setDefaultAlignment=function(){switch(this._orientation){case"bottom":this.yAlignment("top");break;case"top":this.yAlignment("bottom");break;case"left":this.xAlignment("right");break;case"right":this.xAlignment("left")}},c.prototype.formatter=function(a){return void 0===a?this._formatter:(this._formatter=a,this.redraw(),this)},c.prototype.tickLength=function(a){if(null==a)return this._tickLength;if(0>a)throw new Error("tick length must be positive");return this._tickLength=a,this.redraw(),this},c.prototype.endTickLength=function(a){if(null==a)return this._endTickLength;if(0>a)throw new Error("end tick length must be positive");return this._endTickLength=a,this.redraw(),this},c.prototype._maxLabelTickLength=function(){return this.showEndTickLabels()?Math.max(this.tickLength(),this.endTickLength()):this.tickLength()},c.prototype.tickLabelPadding=function(a){if(null==a)return this._tickLabelPadding;if(0>a)throw new Error("tick label padding must be positive");return this._tickLabelPadding=a,this.redraw(),this},c.prototype.gutter=function(a){if(null==a)return this._gutter;if(0>a)throw new Error("gutter size must be positive");return this._gutter=a,this.redraw(),this},c.prototype.orientation=function(a){if(null==a)return this._orientation;var b=a.toLowerCase();if("top"!==b&&"bottom"!==b&&"left"!==b&&"right"!==b)throw new Error("unsupported orientation");return this._orientation=b,this.redraw(),this},c.prototype.showEndTickLabels=function(a){return null==a?this._showEndTickLabels:(this._showEndTickLabels=a,this.render(),this)},c.END_TICK_MARK_CLASS="end-tick-mark",c.TICK_MARK_CLASS="tick-mark",c.TICK_LABEL_CLASS="tick-label",c}(a.Component);a.Axis=b}(Plottable||(Plottable={}));var __extends=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c},Plottable;!function(a){var b;!function(a){a.second="second",a.minute="minute",a.hour="hour",a.day="day",a.week="week",a.month="month",a.year="year"}(b=a.TimeInterval||(a.TimeInterval={}));var c;!function(c){var d=function(c){function d(a,b){c.call(this,a,b),this._tierLabelPositions=[],this.classed("time-axis",!0),this.tickLabelPadding(5),this.axisConfigurations(d._DEFAULT_TIME_AXIS_CONFIGURATIONS)}return __extends(d,c),d.prototype.tierLabelPositions=function(a){if(null==a)return this._tierLabelPositions;if(!a.every(function(a){return"between"===a.toLowerCase()||"center"===a.toLowerCase()}))throw new Error("Unsupported position for tier labels");return this._tierLabelPositions=a,this.redraw(),this},d.prototype.axisConfigurations=function(b){if(null==b)return this._possibleTimeAxisConfigurations;this._possibleTimeAxisConfigurations=b,this._numTiers=a.Utils.Methods.max(this._possibleTimeAxisConfigurations.map(function(a){return a.length}),0),this._isAnchored&&this._setupDomElements();for(var c=this.tierLabelPositions(),d=[],e=0;e<this._numTiers;e++)d.push(c[e]||"between");return this.tierLabelPositions(d),this.redraw(),this},d.prototype._getMostPreciseConfigurationIndex=function(){var b=this,c=this._possibleTimeAxisConfigurations.length;return this._possibleTimeAxisConfigurations.forEach(function(a,d){c>d&&a.every(function(a){return b._checkTimeAxisTierConfigurationWidth(a)})&&(c=d)}),c===this._possibleTimeAxisConfigurations.length&&(a.Utils.Methods.warn("zoomed out too far: could not find suitable interval to display labels"),--c),c},d.prototype.orientation=function(a){if(a&&("right"===a.toLowerCase()||"left"===a.toLowerCase()))throw new Error(a+" is not a supported orientation for TimeAxis - only horizontal orientations are supported");return c.prototype.orientation.call(this,a)},d.prototype._computeHeight=function(){var a=this._measurer.measure().height;this._tierHeights=[];for(var b=0;b<this._numTiers;b++)this._tierHeights.push(a+this.tickLabelPadding()+("between"===this._tierLabelPositions[b]?0:this._maxLabelTickLength()));return this._computedHeight=d3.sum(this._tierHeights),this._computedHeight},d.prototype._getIntervalLength=function(b){var c=this._scale.domain()[0],d=a.Formatters.timeIntervalToD3Time(b.interval),e=d.offset(c,b.step);if(e>this._scale.domain()[1])return this.width();var f=Math.abs(this._scale.scale(e)-this._scale.scale(c));return f},d.prototype._maxWidthForInterval=function(a){return this._measurer.measure(a.formatter(d._LONG_DATE)).width},d.prototype._checkTimeAxisTierConfigurationWidth=function(a){var b=this._maxWidthForInterval(a)+2*this.tickLabelPadding();return Math.min(this._getIntervalLength(a),this.width())>=b},d.prototype._getSize=function(a,b){var d=c.prototype._getSize.call(this,a,b);return d.height=this._tierHeights.reduce(function(a,b){return a+b>d.height?a:a+b}),d},d.prototype._setup=function(){c.prototype._setup.call(this),this._setupDomElements()},d.prototype._setupDomElements=function(){this._element.selectAll("."+d.TIME_AXIS_TIER_CLASS).remove(),this._tierLabelContainers=[],this._tierMarkContainers=[],this._tierBaselines=[],this._tickLabelContainer.remove(),this._baseline.remove();for(var b=0;b<this._numTiers;++b){var c=this._content.append("g").classed(d.TIME_AXIS_TIER_CLASS,!0);this._tierLabelContainers.push(c.append("g").classed(a.Axis.TICK_LABEL_CLASS+"-container",!0)),this._tierMarkContainers.push(c.append("g").classed(a.Axis.TICK_MARK_CLASS+"-container",!0)),this._tierBaselines.push(c.append("line").classed("baseline",!0))}this._measurer=new SVGTypewriter.Measurers.Measurer(this._tierLabelContainers[0])},d.prototype._getTickIntervalValues=function(a){return this._scale.tickInterval(a.interval,a.step)},d.prototype._getTickValues=function(){var a=this;return this._possibleTimeAxisConfigurations[this._mostPreciseConfigIndex].reduce(function(b,c){return b.concat(a._getTickIntervalValues(c))
},[])},d.prototype._cleanTiers=function(){for(var b=0;b<this._tierLabelContainers.length;b++)this._tierLabelContainers[b].selectAll("."+a.Axis.TICK_LABEL_CLASS).remove(),this._tierMarkContainers[b].selectAll("."+a.Axis.TICK_MARK_CLASS).remove(),this._tierBaselines[b].style("visibility","hidden")},d.prototype._getTickValuesForConfiguration=function(a){var b=this._scale.tickInterval(a.interval,a.step),c=this._scale.domain(),d=b.map(function(a){return a.valueOf()});return-1===d.indexOf(c[0].valueOf())&&b.unshift(c[0]),-1===d.indexOf(c[1].valueOf())&&b.push(c[1]),b},d.prototype._renderTierLabels=function(b,c,d){var e=this,f=this._getTickValuesForConfiguration(c),g=[];"between"===this._tierLabelPositions[d]&&1===c.step?f.map(function(a,b){b+1>=f.length||g.push(new Date((f[b+1].valueOf()-f[b].valueOf())/2+f[b].valueOf()))}):g=f;var h=b.selectAll("."+a.Axis.TICK_LABEL_CLASS).data(g,function(a){return a.valueOf()}),i=h.enter().append("g").classed(a.Axis.TICK_LABEL_CLASS,!0);i.append("text");var j="center"===this._tierLabelPositions[d]||1===c.step?0:this.tickLabelPadding(),k="bottom"===this.orientation()?d3.sum(this._tierHeights.slice(0,d+1))-this.tickLabelPadding():this.height()-d3.sum(this._tierHeights.slice(0,d))-this.tickLabelPadding(),l=h.selectAll("text");l.size()>0&&a.Utils.DOM.translate(l,j,k),h.exit().remove(),h.attr("transform",function(a){return"translate("+e._scale.scale(a)+",0)"});var m="center"===this._tierLabelPositions[d]||1===c.step?"middle":"start";h.selectAll("text").text(c.formatter).style("text-anchor",m)},d.prototype._renderTickMarks=function(b,c){var d=this._tierMarkContainers[c].selectAll("."+a.Axis.TICK_MARK_CLASS).data(b);d.enter().append("line").classed(a.Axis.TICK_MARK_CLASS,!0);var e=this._generateTickMarkAttrHash(),f=this._tierHeights.slice(0,c).reduce(function(a,b){return a+b},0);"bottom"===this.orientation()?(e.y1=f,e.y2=f+("center"===this._tierLabelPositions[c]?this.tickLength():this._tierHeights[c])):(e.y1=this.height()-f,e.y2=this.height()-(f+("center"===this._tierLabelPositions[c]?this.tickLength():this._tierHeights[c]))),d.attr(e),"bottom"===this.orientation()?(e.y1=f,e.y2=f+this._tierHeights[c]):(e.y1=this.height()-f,e.y2=this.height()-(f+this._tierHeights[c])),d3.select(d[0][0]).attr(e),d3.select(d[0][0]).classed(a.Axis.END_TICK_MARK_CLASS,!0),d3.select(d[0][d.size()-1]).classed(a.Axis.END_TICK_MARK_CLASS,!0),d.exit().remove()},d.prototype._renderLabellessTickMarks=function(b){var c=this._tickMarkContainer.selectAll("."+a.Axis.TICK_MARK_CLASS).data(b);c.enter().append("line").classed(a.Axis.TICK_MARK_CLASS,!0);var d=this._generateTickMarkAttrHash();d.y2="bottom"===this.orientation()?this.tickLabelPadding():this.height()-this.tickLabelPadding(),c.attr(d),c.exit().remove()},d.prototype._generateLabellessTicks=function(){return this._mostPreciseConfigIndex<1?[]:this._getTickIntervalValues(this._possibleTimeAxisConfigurations[this._mostPreciseConfigIndex-1][0])},d.prototype.renderImmediately=function(){var a=this;this._mostPreciseConfigIndex=this._getMostPreciseConfigurationIndex();var b=this._possibleTimeAxisConfigurations[this._mostPreciseConfigIndex];this._cleanTiers(),b.forEach(function(b,c){return a._renderTierLabels(a._tierLabelContainers[c],b,c)});for(var c=b.map(function(b){return a._getTickValuesForConfiguration(b)}),d=0,e=0;e<Math.max(b.length,1);++e){var f=this._generateBaselineAttrHash();f.y1+="bottom"===this.orientation()?d:-d,f.y2=f.y1,this._tierBaselines[e].attr(f).style("visibility","inherit"),d+=this._tierHeights[e]}var g=[],h=this._scale.domain(),i=this._scale.scale(h[1])-this._scale.scale(h[0]);for(1.5*this._getIntervalLength(b[0])>=i&&(g=this._generateLabellessTicks()),this._renderLabellessTickMarks(g),this._hideOverflowingTiers(),e=0;e<b.length;++e)this._renderTickMarks(c[e],e),this._hideOverlappingAndCutOffLabels(e);return this},d.prototype._hideOverflowingTiers=function(){var a=this,b=this.height(),c=0;this._element.selectAll("."+d.TIME_AXIS_TIER_CLASS).attr("visibility",function(d,e){return c+=a._tierHeights[e],b>=c?"inherit":"hidden"})},d.prototype._hideOverlappingAndCutOffLabels=function(b){var c,d=this,e=this._element.select(".bounding-box")[0][0].getBoundingClientRect(),f=function(a){return Math.floor(e.left)<=Math.ceil(a.left)&&Math.floor(e.top)<=Math.ceil(a.top)&&Math.floor(a.right)<=Math.ceil(e.left+d.width())&&Math.floor(a.bottom)<=Math.ceil(e.top+d.height())},g=this._tierMarkContainers[b].selectAll("."+a.Axis.TICK_MARK_CLASS).filter(function(){var a=d3.select(this).style("visibility");return"visible"===a||"inherit"===a}),h=g[0].map(function(a){return a.getBoundingClientRect()}),i=this._tierLabelContainers[b].selectAll("."+a.Axis.TICK_LABEL_CLASS).filter(function(){var a=d3.select(this).style("visibility");return"visible"===a||"inherit"===a});i.each(function(b,d){var e=this.getBoundingClientRect(),g=d3.select(this),i=h[d],j=h[d+1];!f(e)||null!=c&&a.Utils.DOM.boxesOverlap(e,c)||i.right>e.left||j.left<e.right?g.style("visibility","hidden"):(c=e,g.style("visibility","inherit"))})},d.TIME_AXIS_TIER_CLASS="time-axis-tier",d._DEFAULT_TIME_AXIS_CONFIGURATIONS=[[{interval:b.second,step:1,formatter:a.Formatters.time("%I:%M:%S %p")},{interval:b.day,step:1,formatter:a.Formatters.time("%B %e, %Y")}],[{interval:b.second,step:5,formatter:a.Formatters.time("%I:%M:%S %p")},{interval:b.day,step:1,formatter:a.Formatters.time("%B %e, %Y")}],[{interval:b.second,step:10,formatter:a.Formatters.time("%I:%M:%S %p")},{interval:b.day,step:1,formatter:a.Formatters.time("%B %e, %Y")}],[{interval:b.second,step:15,formatter:a.Formatters.time("%I:%M:%S %p")},{interval:b.day,step:1,formatter:a.Formatters.time("%B %e, %Y")}],[{interval:b.second,step:30,formatter:a.Formatters.time("%I:%M:%S %p")},{interval:b.day,step:1,formatter:a.Formatters.time("%B %e, %Y")}],[{interval:b.minute,step:1,formatter:a.Formatters.time("%I:%M %p")},{interval:b.day,step:1,formatter:a.Formatters.time("%B %e, %Y")}],[{interval:b.minute,step:5,formatter:a.Formatters.time("%I:%M %p")},{interval:b.day,step:1,formatter:a.Formatters.time("%B %e, %Y")}],[{interval:b.minute,step:10,formatter:a.Formatters.time("%I:%M %p")},{interval:b.day,step:1,formatter:a.Formatters.time("%B %e, %Y")}],[{interval:b.minute,step:15,formatter:a.Formatters.time("%I:%M %p")},{interval:b.day,step:1,formatter:a.Formatters.time("%B %e, %Y")}],[{interval:b.minute,step:30,formatter:a.Formatters.time("%I:%M %p")},{interval:b.day,step:1,formatter:a.Formatters.time("%B %e, %Y")}],[{interval:b.hour,step:1,formatter:a.Formatters.time("%I %p")},{interval:b.day,step:1,formatter:a.Formatters.time("%B %e, %Y")}],[{interval:b.hour,step:3,formatter:a.Formatters.time("%I %p")},{interval:b.day,step:1,formatter:a.Formatters.time("%B %e, %Y")}],[{interval:b.hour,step:6,formatter:a.Formatters.time("%I %p")},{interval:b.day,step:1,formatter:a.Formatters.time("%B %e, %Y")}],[{interval:b.hour,step:12,formatter:a.Formatters.time("%I %p")},{interval:b.day,step:1,formatter:a.Formatters.time("%B %e, %Y")}],[{interval:b.day,step:1,formatter:a.Formatters.time("%a %e")},{interval:b.month,step:1,formatter:a.Formatters.time("%B %Y")}],[{interval:b.day,step:1,formatter:a.Formatters.time("%e")},{interval:b.month,step:1,formatter:a.Formatters.time("%B %Y")}],[{interval:b.month,step:1,formatter:a.Formatters.time("%B")},{interval:b.year,step:1,formatter:a.Formatters.time("%Y")}],[{interval:b.month,step:1,formatter:a.Formatters.time("%b")},{interval:b.year,step:1,formatter:a.Formatters.time("%Y")}],[{interval:b.month,step:3,formatter:a.Formatters.time("%b")},{interval:b.year,step:1,formatter:a.Formatters.time("%Y")}],[{interval:b.month,step:6,formatter:a.Formatters.time("%b")},{interval:b.year,step:1,formatter:a.Formatters.time("%Y")}],[{interval:b.year,step:1,formatter:a.Formatters.time("%Y")}],[{interval:b.year,step:1,formatter:a.Formatters.time("%y")}],[{interval:b.year,step:5,formatter:a.Formatters.time("%Y")}],[{interval:b.year,step:25,formatter:a.Formatters.time("%Y")}],[{interval:b.year,step:50,formatter:a.Formatters.time("%Y")}],[{interval:b.year,step:100,formatter:a.Formatters.time("%Y")}],[{interval:b.year,step:200,formatter:a.Formatters.time("%Y")}],[{interval:b.year,step:500,formatter:a.Formatters.time("%Y")}],[{interval:b.year,step:1e3,formatter:a.Formatters.time("%Y")}]],d._LONG_DATE=new Date(9999,8,29,12,59,9999),d}(a.Axis);c.Time=d}(c=a.Axes||(a.Axes={}))}(Plottable||(Plottable={}));var __extends=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c},Plottable;!function(a){var b;!function(b){var c=function(b){function c(c,d,e){void 0===e&&(e=a.Formatters.general()),b.call(this,c,d,e),this._tickLabelPositioning="center",this._showFirstTickLabel=!1,this._showLastTickLabel=!1}return __extends(c,b),c.prototype._setup=function(){b.prototype._setup.call(this),this._measurer=new SVGTypewriter.Measurers.Measurer(this._tickLabelContainer,a.Axis.TICK_LABEL_CLASS),this._wrapper=(new SVGTypewriter.Wrappers.Wrapper).maxLines(1)},c.prototype._computeWidth=function(){var b=this,c=this._getTickValues(),d=c.map(function(a){var c=b.formatter()(a);return b._measurer.measure(c).width}),e=a.Utils.Methods.max(d,0);return this._computedWidth="center"===this._tickLabelPositioning?this._maxLabelTickLength()+this.tickLabelPadding()+e:Math.max(this._maxLabelTickLength(),this.tickLabelPadding()+e),this._computedWidth},c.prototype._computeHeight=function(){var a=this._measurer.measure().height;return this._computedHeight="center"===this._tickLabelPositioning?this._maxLabelTickLength()+this.tickLabelPadding()+a:Math.max(this._maxLabelTickLength(),this.tickLabelPadding()+a),this._computedHeight},c.prototype._getTickValues=function(){var a=this._scale,b=a.domain(),c=b[0]<=b[1]?b[0]:b[1],d=b[0]>=b[1]?b[0]:b[1];return c===b[0]?a.ticks().filter(function(a){return a>=c&&d>=a}):a.ticks().filter(function(a){return a>=c&&d>=a}).reverse()},c.prototype._rescale=function(){if(this._isSetup){if(!this._isHorizontal()){var a=this._computeWidth();if(a>this.width()||a<this.width()-this.gutter())return void this.redraw()}this.render()}},c.prototype.renderImmediately=function(){var c=this;b.prototype.renderImmediately.call(this);var d={x:0,y:0,dx:"0em",dy:"0.3em"},e=this._maxLabelTickLength(),f=this.tickLabelPadding(),g="middle",h=0,i=0,j=0,k=0;if(this._isHorizontal())switch(this._tickLabelPositioning){case"left":g="end",h=-f,k=f;break;case"center":k=e+f;break;case"right":g="start",h=f,k=f}else switch(this._tickLabelPositioning){case"top":d.dy="-0.3em",j=f,i=-f;break;case"center":j=e+f;break;case"bottom":d.dy="1em",j=f,i=f}var l=this._generateTickMarkAttrHash();switch(this.orientation()){case"bottom":d.x=l.x1,d.dy="0.95em",i=l.y1+k;break;case"top":d.x=l.x1,d.dy="-.25em",i=l.y1-k;break;case"left":g="end",h=l.x1-j,d.y=l.y1;break;case"right":g="start",h=l.x1+j,d.y=l.y1}var m=this._getTickValues(),n=this._tickLabelContainer.selectAll("."+a.Axis.TICK_LABEL_CLASS).data(m);n.enter().append("text").classed(a.Axis.TICK_LABEL_CLASS,!0),n.exit().remove(),n.style("text-anchor",g).style("visibility","inherit").attr(d).text(function(a){var b=c.formatter()(a);if(!c._isHorizontal()){var d=c.width()-c.tickLabelPadding();d-="center"===c._tickLabelPositioning?c._maxLabelTickLength():0,b=c._wrapper.wrap(b,c._measurer,d).wrappedText}return b});var o="translate("+h+", "+i+")";return this._tickLabelContainer.attr("transform",o),this._showAllTickMarks(),this.showEndTickLabels()||this._hideEndTickLabels(),this._hideOverflowingTickLabels(),this._hideOverlappingTickLabels(),("bottom"===this._tickLabelPositioning||"top"===this._tickLabelPositioning||"left"===this._tickLabelPositioning||"right"===this._tickLabelPositioning)&&this._hideTickMarksWithoutLabel(),this},c.prototype._showAllTickMarks=function(){this._tickMarkContainer.selectAll("."+a.Axis.TICK_MARK_CLASS).each(function(){d3.select(this).style("visibility","inherit")})},c.prototype._hideTickMarksWithoutLabel=function(){var b=this._tickMarkContainer.selectAll("."+a.Axis.TICK_MARK_CLASS),c=this._tickLabelContainer.selectAll("."+a.Axis.TICK_LABEL_CLASS).filter(function(){var a=d3.select(this).style("visibility");return"inherit"===a||"visible"===a}),d=[];c.each(function(a){return d.push(a)}),b.each(function(a){-1===d.indexOf(a)&&d3.select(this).style("visibility","hidden")})},c.prototype.tickLabelPosition=function(a){if(null==a)return this._tickLabelPositioning;var b=a.toLowerCase();if(this._isHorizontal()){if("left"!==b&&"center"!==b&&"right"!==b)throw new Error(b+" is not a valid tick label position for a horizontal NumericAxis")}else if("top"!==b&&"center"!==b&&"bottom"!==b)throw new Error(b+" is not a valid tick label position for a vertical NumericAxis");return this._tickLabelPositioning=b,this.redraw(),this},c.prototype.showEndTickLabel=function(a,b){if(this._isHorizontal()&&"left"===a||!this._isHorizontal()&&"bottom"===a)return void 0===b?this._showFirstTickLabel:(this._showFirstTickLabel=b,this.render(),this);if(this._isHorizontal()&&"right"===a||!this._isHorizontal()&&"top"===a)return void 0===b?this._showLastTickLabel:(this._showLastTickLabel=b,this.render(),this);throw new Error("Attempt to show "+a+" tick label on a "+(this._isHorizontal()?"horizontal":"vertical")+" axis")},c.prototype._hideEndTickLabels=function(){var b=this._boundingBox.node().getBoundingClientRect(),c=this._tickLabelContainer.selectAll("."+a.Axis.TICK_LABEL_CLASS);if(0!==c[0].length){var d=c[0][0];a.Utils.DOM.boxIsInside(d.getBoundingClientRect(),b)||d3.select(d).style("visibility","hidden");var e=c[0][c[0].length-1];a.Utils.DOM.boxIsInside(e.getBoundingClientRect(),b)||d3.select(e).style("visibility","hidden")}},c.prototype._hideOverflowingTickLabels=function(){var b=this._boundingBox.node().getBoundingClientRect(),c=this._tickLabelContainer.selectAll("."+a.Axis.TICK_LABEL_CLASS);c.empty()||c.each(function(){a.Utils.DOM.boxIsInside(this.getBoundingClientRect(),b)||d3.select(this).style("visibility","hidden")})},c.prototype._hideOverlappingTickLabels=function(){for(var b=this._tickLabelContainer.selectAll("."+a.Axis.TICK_LABEL_CLASS).filter(function(){var a=d3.select(this).style("visibility");return"inherit"===a||"visible"===a}),c=b[0].map(function(a){return a.getBoundingClientRect()}),d=1;!this._hasOverlapWithInterval(d,c)&&d<c.length;)d+=1;b.each(function(a,b){var c=d3.select(this);b%d!==0&&c.style("visibility","hidden")})},c.prototype._hasOverlapWithInterval=function(a,b){var c=this.tickLabelPadding();("bottom"===this._tickLabelPositioning||"top"===this._tickLabelPositioning||"left"===this._tickLabelPositioning||"right"===this._tickLabelPositioning)&&(c*=3);for(var d=0;d<b.length-a;d+=a){var e=b[d],f=b[d+a];if(this._isHorizontal()){if(e.right+c>=f.left)return!1}else if(e.top-c<=f.bottom)return!1}return!0},c}(a.Axis);b.Numeric=c}(b=a.Axes||(a.Axes={}))}(Plottable||(Plottable={}));var __extends=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c},Plottable;!function(a){var b;!function(b){var c=function(b){function c(c,d,e){void 0===d&&(d="bottom"),void 0===e&&(e=a.Formatters.identity()),b.call(this,c,d,e),this._tickLabelAngle=0,this.classed("category-axis",!0)}return __extends(c,b),c.prototype._setup=function(){b.prototype._setup.call(this),this._measurer=new SVGTypewriter.Measurers.CacheCharacterMeasurer(this._tickLabelContainer),this._wrapper=new SVGTypewriter.Wrappers.SingleLineWrapper,this._writer=new SVGTypewriter.Writers.Writer(this._measurer,this._wrapper)},c.prototype._rescale=function(){return this.redraw()},c.prototype.requestedSpace=function(a,b){var c=this._isHorizontal()?0:this._maxLabelTickLength()+this.tickLabelPadding()+this.gutter(),d=this._isHorizontal()?this._maxLabelTickLength()+this.tickLabelPadding()+this.gutter():0;if(0===this._scale.domain().length)return{minWidth:0,minHeight:0};var e=this._scale,f=this._measureTicks(a,b,e,e.domain());return{minWidth:f.usedWidth+c,minHeight:f.usedHeight+d}},c.prototype._getTickValues=function(){return this._scale.domain()},c.prototype.tickLabelAngle=function(a){if(null==a)return this._tickLabelAngle;if(0!==a&&90!==a&&-90!==a)throw new Error("Angle "+a+" not supported; only 0, 90, and -90 are valid values");return this._tickLabelAngle=a,this.redraw(),this},c.prototype._drawTicks=function(a,b,c,d){var e,f,g=this;switch(this.tickLabelAngle()){case 0:e={left:"right",right:"left",top:"center",bottom:"center"},f={left:"center",right:"center",top:"bottom",bottom:"top"};break;case 90:e={left:"center",right:"center",top:"right",bottom:"left"},f={left:"top",right:"bottom",top:"center",bottom:"center"};break;case-90:e={left:"center",right:"center",top:"left",bottom:"right"},f={left:"bottom",right:"top",top:"center",bottom:"center"}}d.each(function(d){var h=c.stepWidth(),i=g._isHorizontal()?h:a-g._maxLabelTickLength()-g.tickLabelPadding(),j=g._isHorizontal()?b-g._maxLabelTickLength()-g.tickLabelPadding():h,k={selection:d3.select(this),xAlign:e[g.orientation()],yAlign:f[g.orientation()],textRotation:g.tickLabelAngle()};g._writer.write(g.formatter()(d),i,j,k)})},c.prototype._measureTicks=function(b,c,d,e){var f=this,g=this._isHorizontal()?b:c,h=2*d.outerPadding(),i=(e.length-1)*d.innerPadding(),j=g/(h+i+e.length),k=j*(1+d.innerPadding()),l=e.map(function(a){var d=b-f._maxLabelTickLength()-f.tickLabelPadding();f._isHorizontal()&&(d=k,0!==f._tickLabelAngle&&(d=c-f._maxLabelTickLength()-f.tickLabelPadding()),d=Math.max(d,0));var e=k;return f._isHorizontal()&&(e=c-f._maxLabelTickLength()-f.tickLabelPadding(),0!==f._tickLabelAngle&&(e=b-f._maxLabelTickLength()-f.tickLabelPadding()),e=Math.max(e,0)),f._wrapper.wrap(f.formatter()(a),f._measurer,d,e)}),m=this._isHorizontal()&&0===this._tickLabelAngle?d3.sum:a.Utils.Methods.max,n=this._isHorizontal()&&0===this._tickLabelAngle?a.Utils.Methods.max:d3.sum,o=l.every(function(a){return!SVGTypewriter.Utils.StringMethods.isNotEmptyString(a.truncatedText)&&1===a.noLines}),p=m(l,function(a){return f._measurer.measure(a.wrappedText).width},0),q=n(l,function(a){return f._measurer.measure(a.wrappedText).height},0);if(0!==this._tickLabelAngle){var r=q;q=p,p=r}return{textFits:o,usedWidth:p,usedHeight:q}},c.prototype.renderImmediately=function(){var c=this;b.prototype.renderImmediately.call(this);var d=this._scale,e=this._tickLabelContainer.selectAll("."+a.Axis.TICK_LABEL_CLASS).data(this._scale.domain(),function(a){return a}),f=function(a){var b=d.stepWidth()-d.rangeBand(),e=d.scale(a)-d.rangeBand()/2-b/2,f=c._isHorizontal()?e:0,g=c._isHorizontal()?0:e;return"translate("+f+","+g+")"};e.enter().append("g").classed(a.Axis.TICK_LABEL_CLASS,!0),e.exit().remove(),e.attr("transform",f),e.text(""),this._drawTicks(this.width(),this.height(),d,e);var g="right"===this.orientation()?this._maxLabelTickLength()+this.tickLabelPadding():0,h="bottom"===this.orientation()?this._maxLabelTickLength()+this.tickLabelPadding():0;return a.Utils.DOM.translate(this._tickLabelContainer,g,h),this},c.prototype.computeLayout=function(a,c,d){return this._measurer.reset(),b.prototype.computeLayout.call(this,a,c,d)},c}(a.Axis);b.Category=c}(b=a.Axes||(a.Axes={}))}(Plottable||(Plottable={}));var __extends=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c},Plottable;!function(a){var b;!function(b){var c=function(a){function b(b){void 0===b&&(b=""),a.call(this),this.classed("label",!0),this.text(b),this.angle(0),this.xAlignment("center").yAlignment("center"),this._padding=0}return __extends(b,a),b.prototype.requestedSpace=function(){var a=this._measurer.measure(this._text),b=(0===this.angle()?a.width:a.height)+2*this.padding(),c=(0===this.angle()?a.height:a.width)+2*this.padding();return{minWidth:b,minHeight:c}},b.prototype._setup=function(){a.prototype._setup.call(this),this._textContainer=this._content.append("g"),this._measurer=new SVGTypewriter.Measurers.Measurer(this._textContainer),this._wrapper=new SVGTypewriter.Wrappers.Wrapper,this._writer=new SVGTypewriter.Writers.Writer(this._measurer,this._wrapper),this.text(this._text)},b.prototype.text=function(a){return void 0===a?this._text:(this._text=a,this.redraw(),this)},b.prototype.angle=function(a){if(null==a)return this._angle;if(-90!==a&&0!==a&&90!==a)throw new Error(a+" is not a valid angle for Label");return this._angle=a,this.redraw(),this},b.prototype.padding=function(a){if(null==a)return this._padding;if(a=+a,0>a)throw new Error(a+" is not a valid padding value. Cannot be less than 0.");return this._padding=a,this.redraw(),this},b.prototype.fixedWidth=function(){return!0},b.prototype.fixedHeight=function(){return!0},b.prototype.renderImmediately=function(){a.prototype.renderImmediately.call(this),this._textContainer.selectAll("g").remove();var b=this._measurer.measure(this._text),c=Math.max(Math.min((this.height()-b.height)/2,this.padding()),0),d=Math.max(Math.min((this.width()-b.width)/2,this.padding()),0);this._textContainer.attr("transform","translate("+d+","+c+")");var e=this.width()-2*d,f=this.height()-2*c,g={selection:this._textContainer,xAlign:this.xAlignment(),yAlign:this.yAlignment(),textRotation:this.angle()};return this._writer.write(this._text,e,f,g),this},b}(a.Component);b.Label=c;var d=function(a){function b(c){a.call(this,c),this.classed(b.TITLE_LABEL_CLASS,!0)}return __extends(b,a),b.TITLE_LABEL_CLASS="title-label",b}(c);b.TitleLabel=d;var e=function(a){function b(c){a.call(this,c),this.classed(b.AXIS_LABEL_CLASS,!0)}return __extends(b,a),b.AXIS_LABEL_CLASS="axis-label",b}(c);b.AxisLabel=e}(b=a.Components||(a.Components={}))}(Plottable||(Plottable={}));var __extends=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c},Plottable;!function(a){var b;!function(b){var c=function(b){function c(c){var d=this;if(b.call(this),this._padding=5,this.classed("legend",!0),this.maxEntriesPerRow(1),null==c)throw new Error("Legend requires a colorScale");this._scale=c,this._redrawCallback=function(){return d.redraw()},this._scale.onUpdate(this._redrawCallback),this.xAlignment("right").yAlignment("top"),this.comparator(function(a,b){return d._scale.domain().indexOf(a)-d._scale.domain().indexOf(b)}),this._symbolFactoryAccessor=function(){return a.SymbolFactories.circle()}}return __extends(c,b),c.prototype._setup=function(){b.prototype._setup.call(this);var a=this._content.append("g").classed(c.LEGEND_ROW_CLASS,!0),d=a.append("g").classed(c.LEGEND_ENTRY_CLASS,!0);d.append("text"),this._measurer=new SVGTypewriter.Measurers.Measurer(a),this._wrapper=(new SVGTypewriter.Wrappers.Wrapper).maxLines(1),this._writer=new SVGTypewriter.Writers.Writer(this._measurer,this._wrapper).addTitleElement(!0)},c.prototype.maxEntriesPerRow=function(a){return null==a?this._maxEntriesPerRow:(this._maxEntriesPerRow=a,this.redraw(),this)},c.prototype.comparator=function(a){return null==a?this._comparator:(this._comparator=a,this.redraw(),this)},c.prototype.scale=function(a){return null!=a?(this._scale.offUpdate(this._redrawCallback),this._scale=a,this._scale.onUpdate(this._redrawCallback),this.redraw(),this):this._scale},c.prototype.destroy=function(){b.prototype.destroy.call(this),this._scale.offUpdate(this._redrawCallback)},c.prototype._calculateLayoutInfo=function(a,b){var c=this,d=this._measurer.measure().height,e=Math.max(0,a-this._padding),f=this._scale.domain().slice();f.sort(this.comparator());var g=d3.map(),h=d3.map();f.forEach(function(a){var b=d+c._measurer.measure(a).width+c._padding,f=Math.min(b,e);g.set(a,f),h.set(a,b)});var i=this._packRows(e,f,g),j=Math.floor((b-2*this._padding)/d);return j!==j&&(j=0),{textHeight:d,entryLengths:g,untruncatedEntryLengths:h,rows:i,numRowsToDraw:Math.max(Math.min(j,i.length),0)}},c.prototype.requestedSpace=function(b,c){var d=this._calculateLayoutInfo(b,c),e=d.rows.map(function(a){return d3.sum(a,function(a){return d.untruncatedEntryLengths.get(a)})}),f=a.Utils.Methods.max(e,0);return{minWidth:this._padding+f,minHeight:d.rows.length*d.textHeight+2*this._padding}},c.prototype._packRows=function(a,b,c){var d=this,e=[],f=[],g=a;return b.forEach(function(b){var h=c.get(b);(h>g||f.length===d._maxEntriesPerRow)&&(e.push(f),f=[],g=a),f.push(b),g-=h}),0!==f.length&&e.push(f),e},c.prototype.getEntry=function(a){if(!this._isSetup)return d3.select();var b=d3.select(),d=this._calculateLayoutInfo(this.width(),this.height()),e=this._padding;return this._content.selectAll("g."+c.LEGEND_ROW_CLASS).each(function(f,g){var h=g*d.textHeight+e,i=(g+1)*d.textHeight+e,j=e,k=e;d3.select(this).selectAll("g."+c.LEGEND_ENTRY_CLASS).each(function(c){k+=d.entryLengths.get(c),k>=a.x&&j<=a.x&&i>=a.y&&h<=a.y&&(b=d3.select(this)),j+=d.entryLengths.get(c)})}),b},c.prototype.renderImmediately=function(){var a=this;b.prototype.renderImmediately.call(this);var d=this._calculateLayoutInfo(this.width(),this.height()),e=d.rows.slice(0,d.numRowsToDraw),f=this._content.selectAll("g."+c.LEGEND_ROW_CLASS).data(e);f.enter().append("g").classed(c.LEGEND_ROW_CLASS,!0),f.exit().remove(),f.attr("transform",function(b,c){return"translate(0, "+(c*d.textHeight+a._padding)+")"});var g=f.selectAll("g."+c.LEGEND_ENTRY_CLASS).data(function(a){return a}),h=g.enter().append("g").classed(c.LEGEND_ENTRY_CLASS,!0);h.append("path"),h.append("g").classed("text-container",!0),g.exit().remove();var i=this._padding;f.each(function(){var a=i,b=d3.select(this).selectAll("g."+c.LEGEND_ENTRY_CLASS);b.attr("transform",function(b){var c="translate("+a+", 0)";return a+=d.entryLengths.get(b),c})}),g.select("path").attr("d",function(b,c){return a.symbolFactoryAccessor()(b,c)(.6*d.textHeight)}).attr("transform","translate("+d.textHeight/2+","+d.textHeight/2+")").attr("fill",function(b){return a._scale.scale(b)}).classed(c.LEGEND_SYMBOL_CLASS,!0);var j=this._padding,k=g.select("g.text-container");k.text(""),k.append("title").text(function(a){return a});var l=this;return k.attr("transform","translate("+d.textHeight+", 0)").each(function(a){var b=d3.select(this),c=d.entryLengths.get(a)-d.textHeight-j,e={selection:b,xAlign:"left",yAlign:"top",textRotation:0};l._writer.write(a,c,l.height(),e)}),this},c.prototype.symbolFactoryAccessor=function(a){return null==a?this._symbolFactoryAccessor:(this._symbolFactoryAccessor=a,this.render(),this)},c.prototype.fixedWidth=function(){return!0},c.prototype.fixedHeight=function(){return!0},c.LEGEND_ROW_CLASS="legend-row",c.LEGEND_ENTRY_CLASS="legend-entry",c.LEGEND_SYMBOL_CLASS="legend-symbol",c}(a.Component);b.Legend=c}(b=a.Components||(a.Components={}))}(Plottable||(Plottable={}));var __extends=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c},Plottable;!function(a){var b;!function(b){var c=function(b){function c(d,e,f){var g=this;if(void 0===e&&(e="horizontal"),void 0===f&&(f=a.Formatters.general()),b.call(this),this._padding=5,this._numSwatches=10,null==d)throw new Error("InterpolatedColorLegend requires a interpolatedColorScale");this._scale=d,this._redrawCallback=function(){return g.redraw()},this._scale.onUpdate(this._redrawCallback),this._formatter=f,this._orientation=c._ensureOrientation(e),this.classed("legend",!0).classed("interpolated-color-legend",!0)}return __extends(c,b),c.prototype.destroy=function(){b.prototype.destroy.call(this),this._scale.offUpdate(this._redrawCallback)},c.prototype.formatter=function(a){return void 0===a?this._formatter:(this._formatter=a,this.redraw(),this)},c._ensureOrientation=function(a){if(a=a.toLowerCase(),"horizontal"===a||"left"===a||"right"===a)return a;throw new Error('"'+a+'" is not a valid orientation for InterpolatedColorLegend')},c.prototype.orientation=function(a){return null==a?this._orientation:(this._orientation=c._ensureOrientation(a),this.redraw(),this)},c.prototype.fixedWidth=function(){return!0},c.prototype.fixedHeight=function(){return!0},c.prototype._generateTicks=function(){for(var a=this._scale.domain(),b=(a[1]-a[0])/this._numSwatches,c=[],d=0;d<=this._numSwatches;d++)c.push(a[0]+b*d);return c},c.prototype._setup=function(){b.prototype._setup.call(this),this._swatchContainer=this._content.append("g").classed("swatch-container",!0),this._swatchBoundingBox=this._content.append("rect").classed("swatch-bounding-box",!0),this._lowerLabel=this._content.append("g").classed(c.LEGEND_LABEL_CLASS,!0),this._upperLabel=this._content.append("g").classed(c.LEGEND_LABEL_CLASS,!0),this._measurer=new SVGTypewriter.Measurers.Measurer(this._content),this._wrapper=new SVGTypewriter.Wrappers.Wrapper,this._writer=new SVGTypewriter.Writers.Writer(this._measurer,this._wrapper)},c.prototype.requestedSpace=function(){var b,c,d=this,e=this._measurer.measure().height,f=this._generateTicks(),g=f.length,h=this._scale.domain(),i=h.map(function(a){return d._measurer.measure(d._formatter(a)).width});if(this._isVertical()){var j=a.Utils.Methods.max(i,0);c=this._padding+e+this._padding+j+this._padding,b=this._padding+g*e+this._padding}else b=this._padding+e+this._padding,c=this._padding+i[0]+this._padding+g*e+this._padding+i[1]+this._padding;return{minWidth:c,minHeight:b}},c.prototype._isVertical=function(){return"horizontal"!==this._orientation},c.prototype.renderImmediately=function(){var a=this;b.prototype.renderImmediately.call(this);var c,d,e,f,g=this._scale.domain(),h=this._formatter(g[0]),i=this._measurer.measure(h).width,j=this._formatter(g[1]),k=this._measurer.measure(j).width,l=this._generateTicks(),m=l.length,n=this._padding,o={x:0,y:0},p={x:0,y:0},q={selection:this._lowerLabel,xAlign:"center",yAlign:"center",textRotation:0},r={selection:this._upperLabel,xAlign:"center",yAlign:"center",textRotation:0},s={x:0,y:n,width:0,height:0};if(this._isVertical()){var t=Math.max(i,k);c=Math.max(this.width()-3*n-t,0),d=Math.max((this.height()-2*n)/m,0),f=function(a,b){return n+(m-(b+1))*d},r.yAlign="top",o.y=n,q.yAlign="bottom",p.y=-n,"left"===this._orientation?(e=function(){return n+t+n},r.xAlign="right",o.x=-(n+c+n),q.xAlign="right",p.x=-(n+c+n)):(e=function(){return n},r.xAlign="left",o.x=n+c+n,q.xAlign="left",p.x=n+c+n),s.width=c,s.height=m*d}else c=Math.max((this.width()-4*n-i-k)/m,0),d=Math.max(this.height()-2*n,0),e=function(a,b){return n+i+n+b*c},f=function(){return n},r.xAlign="right",o.x=-n,q.xAlign="left",p.x=n,s.width=m*c,s.height=d;s.x=e(null,0),this._upperLabel.text(""),this._writer.write(j,this.width(),this.height(),r);var u="translate("+o.x+", "+o.y+")";this._upperLabel.attr("transform",u),this._lowerLabel.text(""),this._writer.write(h,this.width(),this.height(),q);var v="translate("+p.x+", "+p.y+")";this._lowerLabel.attr("transform",v),this._swatchBoundingBox.attr(s);var w=this._swatchContainer.selectAll("rect.swatch").data(l);return w.enter().append("rect").classed("swatch",!0),w.exit().remove(),w.attr({fill:function(b){return a._scale.scale(b)},width:c,height:d,x:e,y:f}),this},c.LEGEND_LABEL_CLASS="legend-label",c}(a.Component);b.InterpolatedColorLegend=c}(b=a.Components||(a.Components={}))}(Plottable||(Plottable={}));var __extends=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c},Plottable;!function(a){var b;!function(b){var c=function(b){function c(c,d){var e=this;if(null!=c&&!a.QuantitativeScale.prototype.isPrototypeOf(c))throw new Error("xScale needs to inherit from Scale.QuantitativeScale");if(null!=d&&!a.QuantitativeScale.prototype.isPrototypeOf(d))throw new Error("yScale needs to inherit from Scale.QuantitativeScale");b.call(this),this.classed("gridlines",!0),this._xScale=c,this._yScale=d,this._renderCallback=function(){return e.render()},this._xScale&&this._xScale.onUpdate(this._renderCallback),this._yScale&&this._yScale.onUpdate(this._renderCallback)}return __extends(c,b),c.prototype.destroy=function(){return b.prototype.destroy.call(this),this._xScale&&this._xScale.offUpdate(this._renderCallback),this._yScale&&this._yScale.offUpdate(this._renderCallback),this
},c.prototype._setup=function(){b.prototype._setup.call(this),this._xLinesContainer=this._content.append("g").classed("x-gridlines",!0),this._yLinesContainer=this._content.append("g").classed("y-gridlines",!0)},c.prototype.renderImmediately=function(){return b.prototype.renderImmediately.call(this),this._redrawXLines(),this._redrawYLines(),this},c.prototype._redrawXLines=function(){var a=this;if(this._xScale){var b=this._xScale.ticks(),c=function(b){return a._xScale.scale(b)},d=this._xLinesContainer.selectAll("line").data(b);d.enter().append("line"),d.attr("x1",c).attr("y1",0).attr("x2",c).attr("y2",this.height()).classed("zeroline",function(a){return 0===a}),d.exit().remove()}},c.prototype._redrawYLines=function(){var a=this;if(this._yScale){var b=this._yScale.ticks(),c=function(b){return a._yScale.scale(b)},d=this._yLinesContainer.selectAll("line").data(b);d.enter().append("line"),d.attr("x1",0).attr("y1",c).attr("x2",this.width()).attr("y2",c).classed("zeroline",function(a){return 0===a}),d.exit().remove()}},c}(a.Component);b.Gridlines=c}(b=a.Components||(a.Components={}))}(Plottable||(Plottable={}));var __extends=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c},Plottable;!function(a){var b;!function(b){var c=function(b){function c(a){var c=this;void 0===a&&(a=[]),b.call(this),this._rowPadding=0,this._columnPadding=0,this._rows=[],this._rowWeights=[],this._columnWeights=[],this._nRows=0,this._nCols=0,this._calculatedLayout=null,this.classed("table",!0),a.forEach(function(a,b){a.forEach(function(a,d){null!=a&&c.add(a,b,d)})})}return __extends(c,b),c.prototype._forEach=function(a){for(var b=0;b<this._nRows;b++)for(var c=0;c<this._nCols;c++)null!=this._rows[b][c]&&a(this._rows[b][c])},c.prototype.has=function(a){for(var b=0;b<this._nRows;b++)for(var c=0;c<this._nCols;c++)if(this._rows[b][c]===a)return!0;return!1},c.prototype.add=function(a,b,c){if(null==a)throw Error("Cannot add null to a table cell");if(!this.has(a)){var d=this._rows[b]&&this._rows[b][c];if(null!=d)throw new Error("cell is occupied");a.detach(),this._nRows=Math.max(b+1,this._nRows),this._nCols=Math.max(c+1,this._nCols),this._padTableToSize(this._nRows,this._nCols),this._rows[b][c]=a,this._adoptAndAnchor(a),this.redraw()}return this},c.prototype._remove=function(a){for(var b=0;b<this._nRows;b++)for(var c=0;c<this._nCols;c++)if(this._rows[b][c]===a)return this._rows[b][c]=null,!0;return!1},c.prototype._iterateLayout=function(b,d,e){void 0===e&&(e=!1);for(var f,g,h=this._rows,i=d3.transpose(this._rows),j=b-this._columnPadding*(this._nCols-1),k=d-this._rowPadding*(this._nRows-1),l=c._calcComponentWeights(this._rowWeights,h,function(a){return null==a||a.fixedHeight()}),m=c._calcComponentWeights(this._columnWeights,i,function(a){return null==a||a.fixedWidth()}),n=m.map(function(a){return 0===a?.5:a}),o=l.map(function(a){return 0===a?.5:a}),p=c._calcProportionalSpace(n,j),q=c._calcProportionalSpace(o,k),r=a.Utils.Methods.createFilledArray(0,this._nCols),s=a.Utils.Methods.createFilledArray(0,this._nRows),t=0;;){var u=a.Utils.Methods.addArrays(s,q),v=a.Utils.Methods.addArrays(r,p),w=this._determineGuarantees(v,u,e);r=w.guaranteedWidths,s=w.guaranteedHeights;var x=w.wantsWidthArr.some(function(a){return a}),y=w.wantsHeightArr.some(function(a){return a}),z=f,A=g;f=j-d3.sum(w.guaranteedWidths),g=k-d3.sum(w.guaranteedHeights);var B;x?(B=w.wantsWidthArr.map(function(a){return a?.1:0}),B=a.Utils.Methods.addArrays(B,m)):B=m;var C;y?(C=w.wantsHeightArr.map(function(a){return a?.1:0}),C=a.Utils.Methods.addArrays(C,l)):C=l,p=c._calcProportionalSpace(B,f),q=c._calcProportionalSpace(C,g),t++;var D=f>0&&f!==z,E=g>0&&g!==A;if(!D&&!E)break;if(t>5)break}return f=j-d3.sum(w.guaranteedWidths),g=k-d3.sum(w.guaranteedHeights),p=c._calcProportionalSpace(m,f),q=c._calcProportionalSpace(l,g),{colProportionalSpace:p,rowProportionalSpace:q,guaranteedWidths:w.guaranteedWidths,guaranteedHeights:w.guaranteedHeights,wantsWidth:x,wantsHeight:y}},c.prototype._determineGuarantees=function(b,c,d){void 0===d&&(d=!1);var e=a.Utils.Methods.createFilledArray(0,this._nCols),f=a.Utils.Methods.createFilledArray(0,this._nRows),g=a.Utils.Methods.createFilledArray(!1,this._nCols),h=a.Utils.Methods.createFilledArray(!1,this._nRows);return this._rows.forEach(function(a,i){a.forEach(function(a,j){var k;k=null!=a?a.requestedSpace(b[j],c[i]):{minWidth:0,minHeight:0};var l=d?Math.min(k.minWidth,b[j]):k.minWidth;e[j]=Math.max(e[j],l);var m=d?Math.min(k.minHeight,c[i]):k.minHeight;f[i]=Math.max(f[i],m);var n=k.minWidth>b[j];g[j]=g[j]||n;var o=k.minHeight>c[i];h[i]=h[i]||o})}),{guaranteedWidths:e,guaranteedHeights:f,wantsWidthArr:g,wantsHeightArr:h}},c.prototype.requestedSpace=function(a,b){return this._calculatedLayout=this._iterateLayout(a,b),{minWidth:d3.sum(this._calculatedLayout.guaranteedWidths),minHeight:d3.sum(this._calculatedLayout.guaranteedHeights)}},c.prototype.computeLayout=function(c,d,e){var f=this;b.prototype.computeLayout.call(this,c,d,e);var g=d3.sum(this._calculatedLayout.guaranteedWidths),h=d3.sum(this._calculatedLayout.guaranteedHeights),i=this._calculatedLayout;(g>this.width()||h>this.height())&&(i=this._iterateLayout(this.width(),this.height(),!0));var j=0,k=a.Utils.Methods.addArrays(i.rowProportionalSpace,i.guaranteedHeights),l=a.Utils.Methods.addArrays(i.colProportionalSpace,i.guaranteedWidths);return this._rows.forEach(function(a,b){var c=0;a.forEach(function(a,d){null!=a&&a.computeLayout({x:c,y:j},l[d],k[b]),c+=l[d]+f._columnPadding}),j+=k[b]+f._rowPadding}),this},c.prototype.rowPadding=function(a){return null==a?this._rowPadding:(this._rowPadding=a,this.redraw(),this)},c.prototype.columnPadding=function(a){return null==a?this._columnPadding:(this._columnPadding=a,this.redraw(),this)},c.prototype.rowWeight=function(a,b){return null==b?this._rowWeights[a]:(this._rowWeights[a]=b,this.redraw(),this)},c.prototype.columnWeight=function(a,b){return null==b?this._columnWeights[a]:(this._columnWeights[a]=b,this.redraw(),this)},c.prototype.fixedWidth=function(){var a=d3.transpose(this._rows);return c._fixedSpace(a,function(a){return null==a||a.fixedWidth()})},c.prototype.fixedHeight=function(){return c._fixedSpace(this._rows,function(a){return null==a||a.fixedHeight()})},c.prototype._padTableToSize=function(a,b){for(var c=0;a>c;c++){void 0===this._rows[c]&&(this._rows[c]=[],this._rowWeights[c]=null);for(var d=0;b>d;d++)void 0===this._rows[c][d]&&(this._rows[c][d]=null)}for(d=0;b>d;d++)void 0===this._columnWeights[d]&&(this._columnWeights[d]=null)},c._calcComponentWeights=function(a,b,c){return a.map(function(a,d){if(null!=a)return a;var e=b[d].map(c),f=e.reduce(function(a,b){return a&&b},!0);return f?0:1})},c._calcProportionalSpace=function(b,c){var d=d3.sum(b);return 0===d?a.Utils.Methods.createFilledArray(0,b.length):b.map(function(a){return c*a/d})},c._fixedSpace=function(a,b){var c=function(a){return a.reduce(function(a,b){return a&&b},!0)},d=function(a){return c(a.map(b))};return c(a.map(d))},c}(a.ComponentContainer);b.Table=c}(b=a.Components||(a.Components={}))}(Plottable||(Plottable={}));var __extends=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c},Plottable;!function(a){var b;!function(b){var c=function(a){function b(){a.call(this),this._boxVisible=!1,this._boxBounds={topLeft:{x:0,y:0},bottomRight:{x:0,y:0}},this.classed("selection-box-layer",!0)}return __extends(b,a),b.prototype._setup=function(){a.prototype._setup.call(this),this._box=this._content.append("g").classed("selection-box",!0).remove(),this._boxArea=this._box.append("rect").classed("selection-area",!0)},b.prototype._getSize=function(a,b){return{width:a,height:b}},b.prototype.bounds=function(a){return null==a?this._boxBounds:(this._setBounds(a),this.render(),this)},b.prototype._setBounds=function(a){var b={x:Math.min(a.topLeft.x,a.bottomRight.x),y:Math.min(a.topLeft.y,a.bottomRight.y)},c={x:Math.max(a.topLeft.x,a.bottomRight.x),y:Math.max(a.topLeft.y,a.bottomRight.y)};this._boxBounds={topLeft:b,bottomRight:c}},b.prototype.renderImmediately=function(){if(this._boxVisible){var a=this._boxBounds.topLeft.y,b=this._boxBounds.bottomRight.y,c=this._boxBounds.topLeft.x,d=this._boxBounds.bottomRight.x;this._boxArea.attr({x:c,y:a,width:d-c,height:b-a}),this._content.node().appendChild(this._box.node())}else this._box.remove();return this},b.prototype.boxVisible=function(a){return null==a?this._boxVisible:(this._boxVisible=a,this.render(),this)},b.prototype.fixedWidth=function(){return!0},b.prototype.fixedHeight=function(){return!0},b}(a.Component);b.SelectionBoxLayer=c}(b=a.Components||(a.Components={}))}(Plottable||(Plottable={}));var __extends=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c},Plottable;!function(a){var b;!function(){}(b=a.Plots||(a.Plots={}));var c=function(b){function c(){var a=this;b.call(this),this._dataChanged=!1,this._animate=!1,this._animators={},this._animateOnNextRender=!0,this._clipPathEnabled=!0,this.classed("plot",!0),this._key2PlotDatasetKey=d3.map(),this._attrBindings=d3.map(),this._attrExtents=d3.map(),this._extentsProvider=function(b){return a._extentsForScale(b)},this._datasetKeysInOrder=[],this._nextSeriesIndex=0,this._renderCallback=function(){return a.render()},this._onDatasetUpdateCallback=function(){return a._onDatasetUpdate()},this._propertyBindings=d3.map(),this._propertyExtents=d3.map()}return __extends(c,b),c.prototype.anchor=function(a){return b.prototype.anchor.call(this,a),this._animateOnNextRender=!0,this._dataChanged=!0,this._updateExtents(),this},c.prototype._setup=function(){var a=this;b.prototype._setup.call(this),this._renderArea=this._content.append("g").classed("render-area",!0),this._getDrawersInOrder().forEach(function(b){return b.setup(a._renderArea.append("g"))})},c.prototype.destroy=function(){var a=this;b.prototype.destroy.call(this),this._scales().forEach(function(b){return b.offUpdate(a._renderCallback)}),this.datasets().forEach(function(b){return a.removeDataset(b)})},c.prototype.addDataset=function(a){var b="_"+this._nextSeriesIndex++;this._key2PlotDatasetKey.has(b)&&this.removeDataset(a);var c=this._getDrawer(b),d={drawer:c,dataset:a,key:b};return this._datasetKeysInOrder.push(b),this._key2PlotDatasetKey.set(b,d),this._isSetup&&c.setup(this._renderArea.append("g")),a.onUpdate(this._onDatasetUpdateCallback),this._onDatasetUpdate(),this},c.prototype._getDrawer=function(b){return new a.Drawers.AbstractDrawer(b)},c.prototype._getAnimator=function(b){return this._animate&&this._animateOnNextRender?this._animators[b]||new a.Animators.Null:new a.Animators.Null},c.prototype._onDatasetUpdate=function(){this._updateExtents(),this._animateOnNextRender=!0,this._dataChanged=!0,this.render()},c.prototype.attr=function(a,b,c){return null==b?this._attrBindings.get(a):(this._bindAttr(a,b,c),this.render(),this)},c.prototype._bindProperty=function(a,b,c){this._bind(a,b,c,this._propertyBindings,this._propertyExtents),this._updateExtentsForProperty(a)},c.prototype._bindAttr=function(a,b,c){this._bind(a,b,c,this._attrBindings,this._attrExtents),this._updateExtentsForAttr(a)},c.prototype._bind=function(a,b,c,d){var e=d.get(a),f=null!=e?e.scale:null;null!=f&&this._uninstallScaleForKey(f,a),null!=c&&this._installScaleForKey(c,a),d.set(a,{accessor:d3.functor(b),scale:c})},c.prototype._generateAttrToProjector=function(){var a={};this._attrBindings.forEach(function(b,c){var d=c.accessor,e=c.scale,f=e?function(a,b,c){return e.scale(d(a,b,c))}:d;a[b]=f});var b=this._propertyProjectors();return Object.keys(b).forEach(function(c){null==a[c]&&(a[c]=b[c])}),a},c.prototype.renderImmediately=function(){return this._isAnchored&&(this._paint(),this._dataChanged=!1,this._animateOnNextRender=!1),this},c.prototype.animate=function(a){return this._animate=a,this},c.prototype.detach=function(){return b.prototype.detach.call(this),this._updateExtents(),this},c.prototype._scales=function(){var a=[];return this._attrBindings.forEach(function(b,c){var d=c.scale;null!=d&&-1===a.indexOf(d)&&a.push(d)}),this._propertyBindings.forEach(function(b,c){var d=c.scale;null!=d&&-1===a.indexOf(d)&&a.push(d)}),a},c.prototype._updateExtents=function(){var a=this;this._attrBindings.forEach(function(b){return a._updateExtentsForAttr(b)}),this._propertyExtents.forEach(function(b){return a._updateExtentsForProperty(b)}),this._scales().forEach(function(b){return b.addExtentsProvider(a._extentsProvider)})},c.prototype._updateExtentsForAttr=function(a){this._updateExtentsForKey(a,this._attrBindings,this._attrExtents,null)},c.prototype._updateExtentsForProperty=function(a){this._updateExtentsForKey(a,this._propertyBindings,this._propertyExtents,this._filterForProperty(a))},c.prototype._filterForProperty=function(){return null},c.prototype._updateExtentsForKey=function(a,b,c,d){var e=this,f=b.get(a);null!=f.accessor&&c.set(a,this._datasetKeysInOrder.map(function(a){var b=e._key2PlotDatasetKey.get(a),c=b.dataset;return e._computeExtent(c,f,d)}))},c.prototype._computeExtent=function(a,b,c){var d=b.accessor,e=b.scale;if(null==e)return[];var f=a.data();null!=c&&(f=f.filter(function(b,d){return c(b,d,a)}));var g=function(b,c){return d(b,c,a)},h=f.map(g);return e.extentOfValues(h)},c.prototype._extentsForProperty=function(a){return this._propertyExtents.get(a)},c.prototype._extentsForScale=function(a){var b=this;if(!this._isAnchored)return[];var c=[];return this._attrBindings.forEach(function(d,e){if(e.scale===a){var f=b._attrExtents.get(d);null!=f&&c.push(f)}}),this._propertyBindings.forEach(function(d,e){if(e.scale===a){var f=b._extentsForProperty(d);null!=f&&c.push(f)}}),d3.merge(c)},c.prototype.animator=function(a,b){return void 0===b?this._animators[a]:(this._animators[a]=b,this)},c.prototype.removeDataset=function(a){var b=this._keyForDataset(a);if(null!=b&&this._key2PlotDatasetKey.has(b)){var c=this._key2PlotDatasetKey.get(b);c.drawer.remove(),c.dataset.offUpdate(this._onDatasetUpdateCallback),this._datasetKeysInOrder.splice(this._datasetKeysInOrder.indexOf(b),1),this._key2PlotDatasetKey.remove(b),this._onDatasetUpdate()}return this},c.prototype._keyForDataset=function(a){return this._datasetKeysInOrder[this.datasets().indexOf(a)]},c.prototype._keysForDatasets=function(a){var b=this;return a.map(function(a){return b._keyForDataset(a)}).filter(function(a){return null!=a})},c.prototype.datasets=function(a){var b=this,c=this._datasetKeysInOrder.map(function(a){return b._key2PlotDatasetKey.get(a).dataset});return null==a?c:(c.forEach(function(a){return b.removeDataset(a)}),a.forEach(function(a){return b.addDataset(a)}),this)},c.prototype._getDrawersInOrder=function(){var a=this;return this._datasetKeysInOrder.map(function(b){return a._key2PlotDatasetKey.get(b).drawer})},c.prototype._generateDrawSteps=function(){return[{attrToProjector:this._generateAttrToProjector(),animator:new a.Animators.Null}]},c.prototype._additionalPaint=function(){},c.prototype._getDataToDraw=function(){var a=this,b=d3.map();return this._datasetKeysInOrder.forEach(function(c){b.set(c,a._key2PlotDatasetKey.get(c).dataset.data())}),b},c.prototype._paint=function(){var b=this,c=this._generateDrawSteps(),d=this._getDataToDraw(),e=this._getDrawersInOrder(),f=this._datasetKeysInOrder.map(function(a,f){return e[f].draw(d.get(a),c,b._key2PlotDatasetKey.get(a).dataset)}),g=a.Utils.Methods.max(f,0);this._additionalPaint(g)},c.prototype.getAllSelections=function(a,b){var c=this;void 0===a&&(a=this.datasets()),void 0===b&&(b=!1);var d=this._keysForDatasets(a);if(b){var e=d3.set(d);d=this._datasetKeysInOrder.filter(function(a){return!e.has(a)})}var f=[];return d.forEach(function(a){var b=c._key2PlotDatasetKey.get(a);if(null!=b){var d=b.drawer;d._getRenderArea().selectAll(d._getSelector()).each(function(){f.push(this)})}}),d3.selectAll(f)},c.prototype.getAllPlotData=function(a){var b=this;void 0===a&&(a=this.datasets());var c=[],d=[],e=[];return this._keysForDatasets(a).forEach(function(a){var f=b._key2PlotDatasetKey.get(a);if(null!=f){var g=f.drawer;f.dataset.data().forEach(function(a,b){var f=g._getPixelPoint(a,b);f.x===f.x&&f.y===f.y&&(c.push(a),d.push(f),e.push(g._getSelection(b).node()))})}}),{data:c,pixelPoints:d,selection:d3.selectAll(e)}},c.prototype.getClosestPlotData=function(b){var c,d=this,e=1/0,f=this.getAllPlotData();return f.pixelPoints.forEach(function(g,h){var i=f.data[h],j=d3.select(f.selection[0][h]);if(d._isVisibleOnPlot(i,g,j)){var k=a.Utils.Methods.distanceSquared(g,b);e>k&&(e=k,c=h)}}),null==c?{data:[],pixelPoints:[],selection:d3.select()}:{data:[f.data[c]],pixelPoints:[f.pixelPoints[c]],selection:d3.select(f.selection[0][c])}},c.prototype._isVisibleOnPlot=function(a,b){return!(b.x<0||b.y<0||b.x>this.width()||b.y>this.height())},c.prototype._uninstallScaleForKey=function(a){a.offUpdate(this._renderCallback),a.removeExtentsProvider(this._extentsProvider)},c.prototype._installScaleForKey=function(a){a.onUpdate(this._renderCallback),a.addExtentsProvider(this._extentsProvider)},c.prototype._propertyProjectors=function(){var a={};return this._propertyBindings.forEach(function(b,c){var d=function(a,b,d){return c.scale.scale(c.accessor(a,b,d))};a[b]=null==c.scale?c.accessor:d}),a},c}(a.Component);a.Plot=c}(Plottable||(Plottable={}));var __extends=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c},Plottable;!function(a){var b;!function(b){var c=function(b){function c(){var c=this;b.call(this),this.innerRadius(0),this.outerRadius(function(){return Math.min(c.width(),c.height())/2}),this.classed("pie-plot",!0),this.attr("fill",function(a,b){return String(b)},new a.Scales.Color)}return __extends(c,b),c.prototype.computeLayout=function(a,c,d){b.prototype.computeLayout.call(this,a,c,d),this._renderArea.attr("transform","translate("+this.width()/2+","+this.height()/2+")");var e=Math.min(this.width(),this.height())/2;return null!=this.innerRadius().scale&&this.innerRadius().scale.range([0,e]),null!=this.outerRadius().scale&&this.outerRadius().scale.range([0,e]),this},c.prototype.addDataset=function(c){return 1===this._datasetKeysInOrder.length?(a.Utils.Methods.warn("Only one dataset is supported in Pie plots"),this):(b.prototype.addDataset.call(this,c),this)},c.prototype._getDrawer=function(b){return new a.Drawers.Arc(b).setClass("arc")},c.prototype.getAllPlotData=function(a){var c=this;void 0===a&&(a=this.datasets());var d=b.prototype.getAllPlotData.call(this,a);return d.pixelPoints.forEach(function(a){a.x=a.x+c.width()/2,a.y=a.y+c.height()/2}),d},c.prototype.sectorValue=function(a,b){return null==a?this._propertyBindings.get(c._SECTOR_VALUE_KEY):(this._bindProperty(c._SECTOR_VALUE_KEY,a,b),this.renderImmediately(),this)},c.prototype.innerRadius=function(a,b){return null==a?this._propertyBindings.get(c._INNER_RADIUS_KEY):(this._bindProperty(c._INNER_RADIUS_KEY,a,b),this.renderImmediately(),this)},c.prototype.outerRadius=function(a,b){return null==a?this._propertyBindings.get(c._OUTER_RADIUS_KEY):(this._bindProperty(c._OUTER_RADIUS_KEY,a,b),this.renderImmediately(),this)},c._INNER_RADIUS_KEY="inner-radius",c._OUTER_RADIUS_KEY="outer-radius",c._SECTOR_VALUE_KEY="sector-value",c}(a.Plot);b.Pie=c}(b=a.Plots||(a.Plots={}))}(Plottable||(Plottable={}));var __extends=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c},Plottable;!function(a){var b=function(b){function c(a,d){var e=this;if(b.call(this),this._autoAdjustXScaleDomain=!1,this._autoAdjustYScaleDomain=!1,null==a||null==d)throw new Error("XYPlots require an xScale and yScale");this.classed("xy-plot",!0),this._propertyBindings.set(c._X_KEY,{accessor:null,scale:a}),this._propertyBindings.set(c._Y_KEY,{accessor:null,scale:d}),this._adjustYDomainOnChangeFromXCallback=function(){return e._adjustYDomainOnChangeFromX()},this._adjustXDomainOnChangeFromYCallback=function(){return e._adjustXDomainOnChangeFromY()},a.onUpdate(this._adjustYDomainOnChangeFromXCallback),d.onUpdate(this._adjustXDomainOnChangeFromYCallback)}return __extends(c,b),c.prototype.x=function(a,b){return null==a?this._propertyBindings.get(c._X_KEY):(this._bindProperty(c._X_KEY,a,b),this._autoAdjustYScaleDomain&&this._updateYExtentsAndAutodomain(),this.renderImmediately(),this)},c.prototype.y=function(a,b){return null==a?this._propertyBindings.get(c._Y_KEY):(this._bindProperty(c._Y_KEY,a,b),this._autoAdjustXScaleDomain&&this._updateXExtentsAndAutodomain(),this.renderImmediately(),this)},c.prototype._filterForProperty=function(a){return"x"===a&&this._autoAdjustXScaleDomain?this._makeFilterByProperty("y"):"y"===a&&this._autoAdjustYScaleDomain?this._makeFilterByProperty("x"):null},c.prototype._makeFilterByProperty=function(b){var c=this._propertyBindings.get(b);if(null!=c){var d=c.accessor,e=c.scale;if(null!=e)return function(b,c,f){var g=e.range();return a.Utils.Methods.inRange(e.scale(d(b,c,f)),g[0],g[1])}}return null},c.prototype._uninstallScaleForKey=function(a,d){b.prototype._uninstallScaleForKey.call(this,a,d);var e=d===c._X_KEY?this._adjustYDomainOnChangeFromXCallback:this._adjustXDomainOnChangeFromYCallback;a.offUpdate(e)},c.prototype._installScaleForKey=function(a,d){b.prototype._installScaleForKey.call(this,a,d);var e=d===c._X_KEY?this._adjustYDomainOnChangeFromXCallback:this._adjustXDomainOnChangeFromYCallback;a.onUpdate(e)},c.prototype.destroy=function(){return b.prototype.destroy.call(this),this.x().scale&&this.x().scale.offUpdate(this._adjustYDomainOnChangeFromXCallback),this.y().scale&&this.y().scale.offUpdate(this._adjustXDomainOnChangeFromYCallback),this},c.prototype.autorange=function(a){switch(a){case"x":this._autoAdjustXScaleDomain=!0,this._autoAdjustYScaleDomain=!1,this._adjustXDomainOnChangeFromY();break;case"y":this._autoAdjustXScaleDomain=!1,this._autoAdjustYScaleDomain=!0,this._adjustYDomainOnChangeFromX();break;case"none":this._autoAdjustXScaleDomain=!1,this._autoAdjustYScaleDomain=!1;break;default:throw new Error("Invalid scale name '"+a+"', must be 'x', 'y' or 'none'")}return this},c.prototype._propertyProjectors=function(){var a=b.prototype._propertyProjectors.call(this),c=a.x,d=a.y;return a.defined=function(a,b,e){var f=c(a,b,e),g=d(a,b,e);return null!=f&&f===f&&null!=g&&g===g},a},c.prototype.computeLayout=function(c,d,e){b.prototype.computeLayout.call(this,c,d,e);var f=this.x().scale;null!=f&&f.range([0,this.width()]);var g=this.y().scale;return null!=g&&this.y().scale.range(this.y().scale instanceof a.Scales.Category?[0,this.height()]:[this.height(),0]),this},c.prototype._updateXExtentsAndAutodomain=function(){this._updateExtentsForProperty("x");var a=this.x().scale;null!=a&&a.autoDomain()},c.prototype._updateYExtentsAndAutodomain=function(){this._updateExtentsForProperty("y");var a=this.y().scale;null!=a&&a.autoDomain()},c.prototype.showAllData=function(){return this._updateXExtentsAndAutodomain(),this._updateYExtentsAndAutodomain(),this},c.prototype._adjustYDomainOnChangeFromX=function(){this._projectorsReady()&&this._autoAdjustYScaleDomain&&this._updateYExtentsAndAutodomain()},c.prototype._adjustXDomainOnChangeFromY=function(){this._projectorsReady()&&this._autoAdjustXScaleDomain&&this._updateXExtentsAndAutodomain()},c.prototype._projectorsReady=function(){return null!=this.x().accessor&&null!=this.y().accessor},c._X_KEY="x",c._Y_KEY="y",c}(a.Plot);a.XYPlot=b}(Plottable||(Plottable={}));var __extends=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c},Plottable;!function(a){var b;!function(b){var c=function(b){function c(c,d){b.call(this,c,d),this.classed("rectangle-plot",!0),this.attr("fill",(new a.Scales.Color).range()[0])}return __extends(c,b),c.prototype._getDrawer=function(b){return new a.Drawers.Rect(b,!0)},c.prototype._generateAttrToProjector=function(){var a=b.prototype._generateAttrToProjector.call(this),c=a.x1,d=a.y1,e=a.x2,f=a.y2;return a.width=function(a,b,d){return Math.abs(e(a,b,d)-c(a,b,d))},a.x=function(a,b,d){return Math.min(c(a,b,d),e(a,b,d))},a.height=function(a,b,c){return Math.abs(f(a,b,c)-d(a,b,c))},a.y=function(b,c,e){return Math.max(d(b,c,e),f(b,c,e))-a.height(b,c,e)},delete a.x1,delete a.y1,delete a.x2,delete a.y2,a},c.prototype._generateDrawSteps=function(){return[{attrToProjector:this._generateAttrToProjector(),animator:this._getAnimator("rectangles")}]},c.prototype.x1=function(a,b){return null==a?this._propertyBindings.get(c._X1_KEY):(this._bindProperty(c._X1_KEY,a,b),this.renderImmediately(),this)},c.prototype.x2=function(a,b){return null==a?this._propertyBindings.get(c._X2_KEY):(this._bindProperty(c._X2_KEY,a,b),this.renderImmediately(),this)},c.prototype.y1=function(a,b){return null==a?this._propertyBindings.get(c._Y1_KEY):(this._bindProperty(c._Y1_KEY,a,b),this.renderImmediately(),this)},c.prototype.y2=function(a,b){return null==a?this._propertyBindings.get(c._Y2_KEY):(this._bindProperty(c._Y2_KEY,a,b),this.renderImmediately(),this)},c._X1_KEY="x1",c._X2_KEY="x2",c._Y1_KEY="y1",c._Y2_KEY="y2",c}(a.XYPlot);b.Rectangle=c}(b=a.Plots||(a.Plots={}))}(Plottable||(Plottable={}));var __extends=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c},Plottable;!function(a){var b;!function(b){var c=function(b){function c(c,d){b.call(this,c,d),this.classed("scatter-plot",!0),this.animator("symbols-reset",new a.Animators.Null),this.animator("symbols",(new a.Animators.Base).duration(250).delay(5)),this.attr("opacity",.6),this.attr("fill",(new a.Scales.Color).range()[0]),this.size(6);var e=a.SymbolFactories.circle();this.symbol(function(){return e})}return __extends(c,b),c.prototype._getDrawer=function(b){return new a.Drawers.Symbol(b)},c.prototype.size=function(a,b){return null==a?this._propertyBindings.get(c._SIZE_KEY):(this._bindProperty(c._SIZE_KEY,a,b),this.renderImmediately(),this)},c.prototype.symbol=function(a){return null==a?this._propertyBindings.get(c._SYMBOL_KEY):(this._propertyBindings.set(c._SYMBOL_KEY,{accessor:a}),this.renderImmediately(),this)},c.prototype._generateDrawSteps=function(){var a=[];if(this._dataChanged&&this._animate){var b=this._generateAttrToProjector();b.d=function(){return""},a.push({attrToProjector:b,animator:this._getAnimator("symbols-reset")})}return a.push({attrToProjector:this._generateAttrToProjector(),animator:this._getAnimator("symbols")}),a},c.prototype._isVisibleOnPlot=function(b,c,d){var e={min:0,max:this.width()},f={min:0,max:this.height()},g=d3.transform(d.attr("transform")).translate,h=d[0][0].getBBox(),i={x:h.x+g[0],y:h.y+g[1],width:h.width,height:h.height};return a.Utils.Methods.intersectsBBox(e,f,i)},c.prototype._propertyProjectors=function(){var d=b.prototype._propertyProjectors.call(this),e=d[a.XYPlot._X_KEY],f=d[a.XYPlot._Y_KEY],g=d[c._SIZE_KEY];delete d[c._SIZE_KEY],d.transform=function(a,b,c){return"translate("+e(a,b,c)+","+f(a,b,c)+")"};var h=d[c._SYMBOL_KEY];return delete d[c._SYMBOL_KEY],d.d=function(a,b,c){return h(a,b,c)(g(a,b,c))},d},c._SIZE_KEY="size",c._SYMBOL_KEY="symbol",c}(a.XYPlot);b.Scatter=c}(b=a.Plots||(a.Plots={}))}(Plottable||(Plottable={}));var __extends=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c},Plottable;!function(a){var b;!function(b){var c=function(b){function c(c,d){b.call(this,c,d),this.classed("grid-plot",!0),c instanceof a.Scales.Category&&c.innerPadding(0).outerPadding(0),d instanceof a.Scales.Category&&d.innerPadding(0).outerPadding(0),this.animator("cells",new a.Animators.Null)}return __extends(c,b),c.prototype.addDataset=function(c){return 1===this._datasetKeysInOrder.length?(a.Utils.Methods.warn("Only one dataset is supported in Grid plots"),this):(b.prototype.addDataset.call(this,c),this)},c.prototype._getDrawer=function(b){return new a.Drawers.Rect(b,!0)},c.prototype._generateDrawSteps=function(){return[{attrToProjector:this._generateAttrToProjector(),animator:this._getAnimator("cells")}]},c.prototype.x=function(c,d){var e=this;if(null==c)return b.prototype.x.call(this);if(null==d)b.prototype.x.call(this,c);else if(b.prototype.x.call(this,c,d),d instanceof a.Scales.Category){var f=d;this.x1(function(a,b,c){return d.scale(e.x().accessor(a,b,c))-f.rangeBand()/2}),this.x2(function(a,b,c){return d.scale(e.x().accessor(a,b,c))+f.rangeBand()/2})}else d instanceof a.QuantitativeScale&&this.x1(function(a,b,c){return d.scale(e.x().accessor(a,b,c))});return this},c.prototype.y=function(c,d){var e=this;if(null==c)return b.prototype.y.call(this);if(null==d)b.prototype.y.call(this,c);else if(b.prototype.y.call(this,c,d),d instanceof a.Scales.Category){var f=d;this.y1(function(a,b,c){return d.scale(e.y().accessor(a,b,c))-f.rangeBand()/2}),this.y2(function(a,b,c){return d.scale(e.y().accessor(a,b,c))+f.rangeBand()/2})}else d instanceof a.QuantitativeScale&&this.y1(function(a,b,c){return d.scale(e.y().accessor(a,b,c))});return this},c}(b.Rectangle);b.Grid=c}(b=a.Plots||(a.Plots={}))}(Plottable||(Plottable={}));var __extends=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c},Plottable;!function(a){var b;!function(b){var c=function(b){function c(d,e,f){var g=this;if(void 0===f&&(f=c.ORIENTATION_VERTICAL),b.call(this,d,e),this._barAlignmentFactor=.5,this._labelFormatter=a.Formatters.identity(),this._labelsEnabled=!1,this._hideBarsIfAnyAreTooWide=!0,this.classed("bar-plot",!0),f!==c.ORIENTATION_VERTICAL&&f!==c.ORIENTATION_HORIZONTAL)throw new Error(f+" is not a valid orientation for Plots.Bar");this._isVertical=f===c.ORIENTATION_VERTICAL,this.animator("bars-reset",new a.Animators.Null),this.animator("bars",new a.Animators.Base),this.animator("baseline",new a.Animators.Null),this.baseline(0),this.attr("fill",(new a.Scales.Color).range()[0]),this.attr("width",function(){return g._getBarPixelWidth()})}return __extends(c,b),c.prototype._getDrawer=function(b){return new a.Drawers.Rect(b,this._isVertical)},c.prototype._setup=function(){b.prototype._setup.call(this),this._baseline=this._renderArea.append("line").classed("baseline",!0)},c.prototype.baseline=function(a){return null==a?this._baselineValue:(this._baselineValue=a,this._updateValueScale(),this.render(),this)},c.prototype.barAlignment=function(a){var b=a.toLowerCase(),c=this.constructor._BarAlignmentToFactor;if(void 0===c[b])throw new Error("unsupported bar alignment");return this._barAlignmentFactor=c[b],this.render(),this},c.prototype.labelsEnabled=function(a){return void 0===a?this._labelsEnabled:(this._labelsEnabled=a,this.render(),this)},c.prototype.labelFormatter=function(a){return null==a?this._labelFormatter:(this._labelFormatter=a,this.render(),this)},c.prototype.getClosestPlotData=function(b){var c=this,d=1/0,e=1/0,f=[],g=[],h=[],i=this._isVertical?b.x:b.y,j=this._isVertical?b.y:b.x,k=.5;return this.datasets().forEach(function(l){var m=c.getAllPlotData([l]);m.pixelPoints.forEach(function(l,n){var o=m.data[n],p=m.selection[0][n];if(c._isVisibleOnPlot(o,l,d3.select(p))){var q=0,r=0,s=p.getBBox();if(!a.Utils.Methods.intersectsBBox(b.x,b.y,s,k)){var t=c._isVertical?l.x:l.y;q=Math.abs(i-t);var u=c._isVertical?s.y:s.x,v=u+(c._isVertical?s.height:s.width);if(j>=u-k&&v+k>=j)r=0;else{var w=c._isVertical?l.y:l.x;r=Math.abs(j-w)}}(d>q||q===d&&e>r)&&(f=[],g=[],h=[],d=q,e=r),q===d&&r===e&&(f.push(o),g.push(l),h.push(p))}})}),{data:f,pixelPoints:g,selection:d3.selectAll(h)}},c.prototype._isVisibleOnPlot=function(b,c,d){var e={min:0,max:this.width()},f={min:0,max:this.height()},g=d[0][0].getBBox();return a.Utils.Methods.intersectsBBox(e,f,g)},c.prototype.getBars=function(a,b){var c=this;
if(!this._isSetup)return d3.select();var d=this._datasetKeysInOrder.reduce(function(d,e){return d.concat(c._getBarsFromDataset(e,a,b))},[]);return d3.selectAll(d)},c.prototype._getBarsFromDataset=function(b,c,d){var e=[],f=this._key2PlotDatasetKey.get(b).drawer;return f._getRenderArea().selectAll("rect").each(function(){a.Utils.Methods.intersectsBBox(c,d,this.getBBox())&&e.push(this)}),e},c.prototype._updateValueScale=function(){var b=this._isVertical?this.y().scale:this.x().scale;if(b instanceof a.QuantitativeScale){var c=b;null!=this._baselineValue?(c.addPaddingException(this,this._baselineValue),c.addIncludedValue(this,this._baselineValue)):(c.removePaddingException(this),c.removeIncludedValue(this))}},c.prototype._additionalPaint=function(b){var c=this,d=this._isVertical?this.y().scale:this.x().scale,e=d.scale(this._baselineValue),f={x1:this._isVertical?0:e,y1:this._isVertical?e:0,x2:this._isVertical?this.width():e,y2:this._isVertical?e:this.height()};this._getAnimator("baseline").animate(this._baseline,f);var g=this._getDrawersInOrder();g.forEach(function(a){return a.removeLabels()}),this._labelsEnabled&&a.Utils.Methods.setTimeout(function(){return c._drawLabels()},b)},c.prototype._drawLabels=function(){var a=this,b=this._getDrawersInOrder(),c=this._generateAttrToProjector(),d=this._getDataToDraw();this._datasetKeysInOrder.forEach(function(e,f){return b[f].drawText(d.get(e),c,a._key2PlotDatasetKey.get(e).dataset)}),this._hideBarsIfAnyAreTooWide&&b.some(function(a){return a._getIfLabelsTooWide()})&&b.forEach(function(a){return a.removeLabels()})},c.prototype._generateDrawSteps=function(){var a=[];if(this._dataChanged&&this._animate){var b=this._generateAttrToProjector(),c=this._isVertical?this.y().scale:this.x().scale,d=c.scale(this._baselineValue),e=this._isVertical?"y":"x",f=this._isVertical?"height":"width";b[e]=function(){return d},b[f]=function(){return 0},a.push({attrToProjector:b,animator:this._getAnimator("bars-reset")})}return a.push({attrToProjector:this._generateAttrToProjector(),animator:this._getAnimator("bars")}),a},c.prototype._generateAttrToProjector=function(){var c=this,d=b.prototype._generateAttrToProjector.call(this),e=this._isVertical?this.y().scale:this.x().scale,f=this._isVertical?this.x().scale:this.y().scale,g=this._isVertical?"y":"x",h=this._isVertical?"x":"y",i=e.scale(this._baselineValue),j=d[h],k=d.width,l=d[g],m=function(a,b,c){return Math.abs(i-l(a,b,c))};d.width=this._isVertical?k:m,d.height=this._isVertical?m:k,d[h]=f instanceof a.Scales.Category?function(a,b,c){return j(a,b,c)-k(a,b,c)/2}:function(a,b,d){return j(a,b,d)-k(a,b,d)*c._barAlignmentFactor},d[g]=function(a,b,c){var d=l(a,b,c);return d>i?i:d};var n=this._propertyBindings.get(g).accessor;return this._labelsEnabled&&this._labelFormatter&&(d.label=function(a,b,d){return c._labelFormatter(n(a,b,d))},d.positive=function(a,b,c){return l(a,b,c)<=i}),d},c.prototype._getBarPixelWidth=function(){var b=this;if(!this._projectorsReady())return 0;var d,e=this._isVertical?this.x().scale:this.y().scale;if(e instanceof a.Scales.Category)d=e.rangeBand();else{var f=this._isVertical?this.x().accessor:this.y().accessor,g=d3.set(a.Utils.Methods.flatten(this._datasetKeysInOrder.map(function(a){var c=b._key2PlotDatasetKey.get(a).dataset;return c.data().map(function(a,b){return f(a,b,c)}).filter(function(a){return null!=a}).map(function(a){return a.valueOf()})}))).values().map(function(a){return+a});g.sort(function(a,b){return a-b});var h=d3.pairs(g),i=this._isVertical?this.width():this.height();d=a.Utils.Methods.min(h,function(a){return Math.abs(e.scale(a[1])-e.scale(a[0]))},i*c._SINGLE_BAR_DIMENSION_RATIO);var j=g.map(function(a){return e.scale(a)}),k=a.Utils.Methods.min(j,0);0!==this._barAlignmentFactor&&k>0&&(d=Math.min(d,k/this._barAlignmentFactor));var l=a.Utils.Methods.max(j,0);if(1!==this._barAlignmentFactor&&i>l){var m=i-l;d=Math.min(d,m/(1-this._barAlignmentFactor))}d*=c._BAR_WIDTH_RATIO}return d},c.prototype.getAllPlotData=function(a){void 0===a&&(a=this.datasets());var c=b.prototype.getAllPlotData.call(this,a),d=(this._isVertical?this.y().scale:this.x().scale).scale(this.baseline()),e=this._isVertical,f=this._barAlignmentFactor;return c.selection.each(function(a,b){var g=d3.select(this);e&&Math.floor(+g.attr("y"))>=Math.floor(d)?c.pixelPoints[b].y+=+g.attr("height"):!e&&Math.floor(+g.attr("x"))<Math.floor(d)&&(c.pixelPoints[b].x-=+g.attr("width")),e?c.pixelPoints[b].x=+g.attr("x")+ +g.attr("width")*f:c.pixelPoints[b].y=+g.attr("y")+ +g.attr("height")*f}),c},c.ORIENTATION_VERTICAL="vertical",c.ORIENTATION_HORIZONTAL="horizontal",c._BarAlignmentToFactor={left:0,center:.5,right:1},c._DEFAULT_WIDTH=10,c._BAR_WIDTH_RATIO=.95,c._SINGLE_BAR_DIMENSION_RATIO=.4,c}(a.XYPlot);b.Bar=c}(b=a.Plots||(a.Plots={}))}(Plottable||(Plottable={}));var __extends=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c},Plottable;!function(a){var b;!function(b){var c=function(b){function c(c,d){b.call(this,c,d),this.classed("line-plot",!0),this.animator("reset",new a.Animators.Null),this.animator("main",(new a.Animators.Base).duration(600).easing("exp-in-out")),this.attr("stroke",(new a.Scales.Color).range()[0]),this.attr("stroke-width","2px")}return __extends(c,b),c.prototype._getDrawer=function(b){return new a.Drawers.Line(b)},c.prototype._getResetYFunction=function(){var a=this.y().scale.domain(),b=Math.max(a[0],a[1]),c=Math.min(a[0],a[1]),d=0>b&&b||c>0&&c||0,e=this.y().scale.scale(d);return function(){return e}},c.prototype._generateDrawSteps=function(){var a=[];if(this._dataChanged&&this._animate){var b=this._generateAttrToProjector();b.y=this._getResetYFunction(),a.push({attrToProjector:b,animator:this._getAnimator("reset")})}return a.push({attrToProjector:this._generateAttrToProjector(),animator:this._getAnimator("main")}),a},c.prototype._generateAttrToProjector=function(){var a=b.prototype._generateAttrToProjector.call(this),c=this._wholeDatumAttributes(),d=function(a){return-1===c.indexOf(a)},e=d3.keys(a).filter(d);return e.forEach(function(b){var c=a[b];a[b]=function(a,b,d){return a.length>0?c(a[0],b,d):null}}),a},c.prototype._wholeDatumAttributes=function(){return["x","y","defined"]},c.prototype.getAllPlotData=function(a){var b=this;void 0===a&&(a=this.datasets());var c=[],d=[],e=[];return this._keysForDatasets(a).forEach(function(a){var f=b._key2PlotDatasetKey.get(a);if(null!=f){var g=f.drawer;f.dataset.data().forEach(function(a,b){var e=g._getPixelPoint(a,b);e.x===e.x&&e.y===e.y&&(c.push(a),d.push(e))}),f.dataset.data().length>0&&e.push(g._getSelection(0).node())}}),{data:c,pixelPoints:d,selection:d3.selectAll(e)}},c.prototype.getClosestPlotData=function(a){var b=this,c=1/0,d=1/0,e=[],f=[],g=[];return this.datasets().forEach(function(h){var i=b.getAllPlotData([h]);i.pixelPoints.forEach(function(h,j){var k=i.data[j],l=i.selection[0][0];if(b._isVisibleOnPlot(k,h,d3.select(l))){var m=Math.abs(a.x-h.x),n=Math.abs(a.y-h.y);(c>m||m===c&&d>n)&&(e=[],f=[],g=[],c=m,d=n),m===c&&n===d&&(e.push(k),f.push(h),g.push(l))}})}),{data:e,pixelPoints:f,selection:d3.selectAll(g)}},c}(a.XYPlot);b.Line=c}(b=a.Plots||(a.Plots={}))}(Plottable||(Plottable={}));var __extends=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c},Plottable;!function(a){var b;!function(b){var c=function(b){function c(c,d){b.call(this,c,d),this.classed("area-plot",!0),this.y0(0,d),this.animator("reset",new a.Animators.Null),this.animator("main",(new a.Animators.Base).duration(600).easing("exp-in-out"));var e=(new a.Scales.Color).range()[0];this.attr("fill-opacity",.25),this.attr("fill",e),this.attr("stroke",e)}return __extends(c,b),c.prototype.y0=function(a,b){return null==a?this._propertyBindings.get(c._Y0_KEY):(this._bindProperty(c._Y0_KEY,a,b),this._updateYScale(),this.renderImmediately(),this)},c.prototype._onDatasetUpdate=function(){b.prototype._onDatasetUpdate.call(this),null!=this.y().scale&&this._updateYScale()},c.prototype._getDrawer=function(b){return new a.Drawers.Area(b)},c.prototype._updateYScale=function(){var b=this._propertyExtents.get("y0"),c=a.Utils.Methods.flatten(b),d=a.Utils.Methods.uniq(c),e=1===d.length?d[0]:null,f=this.y().scale;null!=e?f.addPaddingException(this,e):f.removePaddingException(this)},c.prototype._getResetYFunction=function(){return this._generateAttrToProjector().y0},c.prototype._wholeDatumAttributes=function(){var a=b.prototype._wholeDatumAttributes.call(this);return a.push("y0"),a},c._Y0_KEY="y0",c}(b.Line);b.Area=c}(b=a.Plots||(a.Plots={}))}(Plottable||(Plottable={}));var __extends=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c},Plottable;!function(a){var b;!function(b){var c=function(c){function d(d,e,f){void 0===f&&(f=b.Bar.ORIENTATION_VERTICAL),c.call(this,d,e,f),this._clusterOffsets=new a.Utils.Map}return __extends(d,c),d.prototype._generateAttrToProjector=function(){var a=this,b=c.prototype._generateAttrToProjector.call(this),d=this._makeInnerScale(),e=function(){return d.rangeBand()};b.width=this._isVertical?e:b.width,b.height=this._isVertical?b.height:e;var f=b.x,g=b.y;return b.x=this._isVertical?function(b,c,d){return f(b,c,d)+a._clusterOffsets.get(d)}:function(a,b,c){return f(a,b,c)},b.y=this._isVertical?function(a,b,c){return g(a,b,c)}:function(b,c,d){return g(b,c,d)+a._clusterOffsets.get(d)},b},d.prototype._updateClusterPosition=function(){var a=this,b=this._makeInnerScale();this.datasets().forEach(function(c,d){return a._clusterOffsets.set(c,b.scale(String(d))-b.rangeBand()/2)})},d.prototype._makeInnerScale=function(){var b=new a.Scales.Category;if(b.domain(this.datasets().map(function(a,b){return String(b)})),this._attrBindings.get("width")){var c=this._attrBindings.get("width"),d=c.accessor,e=c.scale,f=e?function(a,b,c){return e.scale(d(a,b,c))}:d;b.range([0,f(null,0,null)])}else b.range([0,this._getBarPixelWidth()]);return b},d.prototype._getDataToDraw=function(){return this._updateClusterPosition(),c.prototype._getDataToDraw.call(this)},d}(b.Bar);b.ClusteredBar=c}(b=a.Plots||(a.Plots={}))}(Plottable||(Plottable={}));var Plottable;!function(a){var b;!function(){}(b=a.Plots||(a.Plots={}));var c=function(){function b(){}return b.computeStackExtents=function(b,c,d,e,f){var g=a.Utils.Methods.max(d,function(d){var g=d.data();return null!=f&&(g=g.filter(function(a,b){return f(a,b,d)})),a.Utils.Methods.max(g,function(a,f){return+c(a,f,d)+e.get(d).get(String(b(a,f,d)))},0)},0),h=a.Utils.Methods.min(d,function(d){var g=d.data();return null!=f&&(g=g.filter(function(a,b){return f(a,b,d)})),a.Utils.Methods.min(g,function(a,f){return+c(a,f,d)+e.get(d).get(String(b(a,f,d)))},0)},0);return[Math.min(h,0),Math.max(0,g)]},b.computeStackOffsets=function(c,d,e,f){var g=b.getDomainKeys(c,e,f),h=b.generateDefaultMapArray(c,d,g,e,f),i=h.map(function(b){return a.Utils.Methods.populateMap(g,function(a){return{key:a,value:Math.max(0,b.get(a).value)||0}})}),j=h.map(function(b){return a.Utils.Methods.populateMap(g,function(a){return{key:a,value:Math.min(b.get(a).value,0)||0}})}),k=b.generateStackOffsets(b.stack(i,g),b.stack(j,g),c,d,e,f);return k},b.checkSameDomainForStacks=function(c,d,e){var f=d.map(function(a){var b=e.get(a).dataset;return d3.set(b.data().map(function(a,d){return c(a,d,b).toString()})).values()}),g=b.getDomainKeys(c,d,e);f.some(function(a){return a.length!==g.length})&&a.Utils.Methods.warn("the domains across the datasets are not the same. Plot may produce unintended behavior.")},b.keyAccessor=function(a,b){return"vertical"===b?a.x().accessor:a.y().accessor},b.valueAccessor=function(a,b){return"vertical"===b?a.y().accessor:a.x().accessor},b.stack=function(a,b){var c=function(a,b){a.offset=b};return d3.layout.stack().x(function(a){return a.key}).y(function(a){return+a.value}).values(function(a){return b.map(function(b){return a.get(b)})}).out(c)(a),a},b.getDomainKeys=function(a,b,c){var d=d3.set();return b.forEach(function(b){var e=c.get(b).dataset;e.data().forEach(function(b,c){d.add(a(b,c,e))})}),d.values()},b.generateDefaultMapArray=function(b,c,d,e,f){var g=e.map(function(){return a.Utils.Methods.populateMap(d,function(a){return{key:a,value:0}})});return e.forEach(function(a,d){var e=f.get(a).dataset;e.data().forEach(function(a,f){var h=String(b(a,f,e)),i=c(a,f,e);g[d].set(h,{key:h,value:i})})}),g},b.generateStackOffsets=function(a,b,c,d,e,f){var g={};return e.forEach(function(e,h){g[e]=d3.map();var i=f.get(e).dataset,j=a[h],k=b[h],l=i.data().every(function(a,b){return d(a,b,i)<=0});i.data().forEach(function(a,b){var f,h=String(c(a,b,i)),m=j.get(h).offset,n=k.get(h).offset,o=d(a,b,i);f=+o?o>0?m:n:l?n:m,g[e].set(h,f)})}),g},b}();a.StackedPlotUtils=c}(Plottable||(Plottable={}));var __extends=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c},Plottable;!function(a){var b;!function(b){var c=function(b){function c(c,d){b.call(this,c,d),this._baselineValue=0,this.classed("area-plot",!0),this._isVertical=!0,this.attr("fill-opacity",1),this._stackOffsets=new a.Utils.Map,this._stackedExtent=[]}return __extends(c,b),c.prototype._getDrawer=function(b){return new a.Drawers.Area(b).drawLine(!1)},c.prototype._getAnimator=function(){return new a.Animators.Null},c.prototype._setup=function(){b.prototype._setup.call(this),this._baseline=this._renderArea.append("line").classed("baseline",!0)},c.prototype.x=function(a,c){return null==a?b.prototype.x.call(this):(null==c?b.prototype.x.call(this,a):b.prototype.x.call(this,a,c),this._updateStackExtentsAndOffsets(),this)},c.prototype.y=function(a,c){return null==a?b.prototype.y.call(this):(null==c?b.prototype.y.call(this,a):b.prototype.y.call(this,a,c),this._updateStackExtentsAndOffsets(),this)},c.prototype._additionalPaint=function(){var a=this.y().scale.scale(this._baselineValue),b={x1:0,y1:a,x2:this.width(),y2:a};this._getAnimator("baseline").animate(this._baseline,b)},c.prototype._updateYScale=function(){var a=this.y().scale;a.addPaddingException(this,0),a.addIncludedValue(this,0)},c.prototype._onDatasetUpdate=function(){return this._updateStackExtentsAndOffsets(),b.prototype._onDatasetUpdate.call(this),this},c.prototype._generateAttrToProjector=function(){var a=this,c=b.prototype._generateAttrToProjector.call(this),d=this.y().accessor,e=this.x().accessor;return c.y=function(b,c,f){return a.y().scale.scale(+d(b,c,f)+a._stackOffsets.get(f).get(e(b,c,f)))},c.y0=function(b,c,d){return a.y().scale.scale(a._stackOffsets.get(d).get(e(b,c,d)))},c},c.prototype._wholeDatumAttributes=function(){return["x","y","defined"]},c.prototype._updateExtentsForProperty=function(a){b.prototype._updateExtentsForProperty.call(this,a),"x"!==a&&"y"!==a||!this._projectorsReady()||this._updateStackExtentsAndOffsets()},c.prototype._extentsForProperty=function(a){var c=this._isVertical?"y":"x";return a===c?[this._stackedExtent]:b.prototype._extentsForProperty.call(this,a)},c.prototype._updateStackExtentsAndOffsets=function(){if(this._projectorsReady()){var b=this._isVertical?"vertical":"horizontal",c=a.StackedPlotUtils.keyAccessor(this,b),d=a.StackedPlotUtils.valueAccessor(this,b),e=this._datasetKeysInOrder,f=this._key2PlotDatasetKey,g=this._filterForProperty(this._isVertical?"y":"x");a.StackedPlotUtils.checkSameDomainForStacks(c,e,f);var h=a.StackedPlotUtils.computeStackOffsets.call(this,c,d,e,f);for(var i in h)h.hasOwnProperty(i)&&this._stackOffsets.set(f.get(i).dataset,h[i]);this._stackedExtent=a.StackedPlotUtils.computeStackExtents(c,d,this.datasets(),this._stackOffsets,g)}},c}(b.Area);b.StackedArea=c}(b=a.Plots||(a.Plots={}))}(Plottable||(Plottable={}));var __extends=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c},Plottable;!function(a){var b;!function(b){var c=function(c){function d(d,e,f){void 0===f&&(f=b.Bar.ORIENTATION_VERTICAL),c.call(this,d,e,f),this._stackOffsets=new a.Utils.Map,this._stackedExtent=[]}return __extends(d,c),d.prototype._getAnimator=function(b){if(this._animate&&this._animateOnNextRender){if(this.animator(b))return this.animator(b);if("stacked-bar"===b){var c=this._isVertical?this.y().scale:this.x().scale,d=c.scale(this.baseline());return new a.Animators.MovingRect(d,this._isVertical)}}return new a.Animators.Null},d.prototype.x=function(a,b){return null==a?c.prototype.x.call(this):(null==b?c.prototype.x.call(this,a):c.prototype.x.call(this,a,b),this._updateStackExtentsAndOffsets(),this)},d.prototype.y=function(a,b){return null==a?c.prototype.y.call(this):(null==b?c.prototype.y.call(this,a):c.prototype.y.call(this,a,b),this._updateStackExtentsAndOffsets(),this)},d.prototype._generateAttrToProjector=function(){var a=this,b=c.prototype._generateAttrToProjector.call(this),d=this._isVertical?"y":"x",e=this._isVertical?"x":"y",f=this._isVertical?this.y().scale:this.x().scale,g=this._propertyBindings.get(d).accessor,h=this._propertyBindings.get(e).accessor,i=function(b,c,d){return f.scale(a._stackOffsets.get(d).get(h(b,c,d)))},j=function(b,c,d){return f.scale(+g(b,c,d)+a._stackOffsets.get(d).get(h(b,c,d)))},k=function(a,b,c){return Math.abs(j(a,b,c)-i(a,b,c))},l=function(a,b,c){return+g(a,b,c)<0?i(a,b,c):j(a,b,c)};return b[d]=function(b,c,d){return a._isVertical?l(b,c,d):l(b,c,d)-k(b,c,d)},b},d.prototype._generateDrawSteps=function(){return[{attrToProjector:this._generateAttrToProjector(),animator:this._getAnimator("stacked-bar")}]},d.prototype._onDatasetUpdate=function(){return this._updateStackExtentsAndOffsets(),c.prototype._onDatasetUpdate.call(this),this},d.prototype._updateExtentsForProperty=function(a){c.prototype._updateExtentsForProperty.call(this,a),"x"!==a&&"y"!==a||!this._projectorsReady()||this._updateStackExtentsAndOffsets()},d.prototype._extentsForProperty=function(a){var b=this._isVertical?"y":"x";return a===b?[this._stackedExtent]:c.prototype._extentsForProperty.call(this,a)},d.prototype._updateStackExtentsAndOffsets=function(){if(this._projectorsReady()){var b=this._isVertical?"vertical":"horizontal",c=a.StackedPlotUtils.keyAccessor(this,b),d=a.StackedPlotUtils.valueAccessor(this,b),e=this._datasetKeysInOrder,f=this._key2PlotDatasetKey,g=this._filterForProperty(this._isVertical?"y":"x"),h=a.StackedPlotUtils.computeStackOffsets.call(this,c,d,e,f);for(var i in h)h.hasOwnProperty(i)&&this._stackOffsets.set(f.get(i).dataset,h[i]);this._stackedExtent=a.StackedPlotUtils.computeStackExtents(c,d,this.datasets(),this._stackOffsets,g)}},d}(b.Bar);b.StackedBar=c}(b=a.Plots||(a.Plots={}))}(Plottable||(Plottable={}));var Plottable;!function(a){var b;!function(){}(b=a.Animators||(a.Animators={}))}(Plottable||(Plottable={}));var Plottable;!function(a){var b;!function(a){var b=function(){function a(){}return a.prototype.getTiming=function(){return 0},a.prototype.animate=function(a,b){return a.attr(b)},a}();a.Null=b}(b=a.Animators||(a.Animators={}))}(Plottable||(Plottable={}));var Plottable;!function(a){var b;!function(a){var b=function(){function a(){this._duration=a.DEFAULT_DURATION_MILLISECONDS,this._delay=a.DEFAULT_DELAY_MILLISECONDS,this._easing=a.DEFAULT_EASING,this._maxIterativeDelay=a.DEFAULT_MAX_ITERATIVE_DELAY_MILLISECONDS,this._maxTotalDuration=a.DEFAULT_MAX_TOTAL_DURATION_MILLISECONDS}return a.prototype.getTiming=function(a){var b=Math.max(this.maxTotalDuration()-this.duration(),0),c=Math.min(this.maxIterativeDelay(),b/Math.max(a-1,1)),d=c*a+this.delay()+this.duration();return d},a.prototype.animate=function(a,b){var c=this,d=a[0].length,e=Math.max(this.maxTotalDuration()-this.duration(),0),f=Math.min(this.maxIterativeDelay(),e/Math.max(d-1,1));return a.transition().ease(this.easing()).duration(this.duration()).delay(function(a,b){return c.delay()+f*b}).attr(b)},a.prototype.duration=function(a){return null==a?this._duration:(this._duration=a,this)},a.prototype.delay=function(a){return null==a?this._delay:(this._delay=a,this)},a.prototype.easing=function(a){return null==a?this._easing:(this._easing=a,this)},a.prototype.maxIterativeDelay=function(a){return null==a?this._maxIterativeDelay:(this._maxIterativeDelay=a,this)},a.prototype.maxTotalDuration=function(a){return null==a?this._maxTotalDuration:(this._maxTotalDuration=a,this)},a.DEFAULT_DURATION_MILLISECONDS=300,a.DEFAULT_DELAY_MILLISECONDS=0,a.DEFAULT_MAX_ITERATIVE_DELAY_MILLISECONDS=15,a.DEFAULT_MAX_TOTAL_DURATION_MILLISECONDS=600,a.DEFAULT_EASING="exp-out",a}();a.Base=b}(b=a.Animators||(a.Animators={}))}(Plottable||(Plottable={}));var __extends=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c},Plottable;!function(a){var b;!function(a){var b=function(a){function b(b,c){void 0===b&&(b=!0),void 0===c&&(c=!1),a.call(this),this.isVertical=b,this.isReverse=c}return __extends(b,a),b.prototype.animate=function(c,d){var e={};return b.ANIMATED_ATTRIBUTES.forEach(function(a){return e[a]=d[a]}),e[this._getMovingAttr()]=this._startMovingProjector(d),e[this._getGrowingAttr()]=function(){return 0},c.attr(e),a.prototype.animate.call(this,c,d)},b.prototype._startMovingProjector=function(a){if(this.isVertical===this.isReverse)return a[this._getMovingAttr()];var b=a[this._getMovingAttr()],c=a[this._getGrowingAttr()];return function(a,d,e){return b(a,d,e)+c(a,d,e)}},b.prototype._getGrowingAttr=function(){return this.isVertical?"height":"width"},b.prototype._getMovingAttr=function(){return this.isVertical?"y":"x"},b.ANIMATED_ATTRIBUTES=["height","width","x","y","fill"],b}(a.Base);a.Rect=b}(b=a.Animators||(a.Animators={}))}(Plottable||(Plottable={}));var __extends=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c},Plottable;!function(a){var b;!function(a){var b=function(a){function b(b,c){void 0===c&&(c=!0),a.call(this,c),this.startPixelValue=b}return __extends(b,a),b.prototype._startMovingProjector=function(){return d3.functor(this.startPixelValue)},b}(a.Rect);a.MovingRect=b}(b=a.Animators||(a.Animators={}))}(Plottable||(Plottable={}));var Plottable;!function(a){var b=function(){function a(){this._event2Callback={},this._callbacks=[],this._connected=!1}return a.prototype._hasNoListeners=function(){return this._callbacks.every(function(a){return 0===a.values().length})},a.prototype._connect=function(){var a=this;this._connected||(Object.keys(this._event2Callback).forEach(function(b){var c=a._event2Callback[b];document.addEventListener(b,c)}),this._connected=!0)},a.prototype._disconnect=function(){var a=this;this._connected&&this._hasNoListeners()&&(Object.keys(this._event2Callback).forEach(function(b){var c=a._event2Callback[b];document.removeEventListener(b,c)}),this._connected=!1)},a.prototype.setCallback=function(a,b){this._connect(),a.add(b)},a.prototype.unsetCallback=function(a,b){a["delete"](b),this._disconnect()},a}();a.Dispatcher=b}(Plottable||(Plottable={}));var __extends=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c},Plottable;!function(a){var b;!function(b){var c=function(b){function c(c){var d=this;b.call(this),this.translator=a.Utils.ClientToSVGTranslator.getTranslator(c),this._lastMousePosition={x:-1,y:-1},this._moveCallbacks=new a.Utils.CallbackSet,this._downCallbacks=new a.Utils.CallbackSet,this._upCallbacks=new a.Utils.CallbackSet,this._wheelCallbacks=new a.Utils.CallbackSet,this._dblClickCallbacks=new a.Utils.CallbackSet,this._callbacks=[this._moveCallbacks,this._downCallbacks,this._upCallbacks,this._wheelCallbacks,this._dblClickCallbacks];var e=function(a){return d._measureAndDispatch(a,d._moveCallbacks)};this._event2Callback.mouseover=e,this._event2Callback.mousemove=e,this._event2Callback.mouseout=e,this._event2Callback.mousedown=function(a){return d._measureAndDispatch(a,d._downCallbacks)},this._event2Callback.mouseup=function(a){return d._measureAndDispatch(a,d._upCallbacks)},this._event2Callback.wheel=function(a){return d._measureAndDispatch(a,d._wheelCallbacks)},this._event2Callback.dblclick=function(a){return d._measureAndDispatch(a,d._dblClickCallbacks)}}return __extends(c,b),c.getDispatcher=function(b){var d=a.Utils.DOM.getBoundingSVG(b),e=d[c._DISPATCHER_KEY];return null==e&&(e=new c(d),d[c._DISPATCHER_KEY]=e),e},c.prototype.onMouseMove=function(a){return this.setCallback(this._moveCallbacks,a),this},c.prototype.offMouseMove=function(a){return this.unsetCallback(this._moveCallbacks,a),this},c.prototype.onMouseDown=function(a){return this.setCallback(this._downCallbacks,a),this},c.prototype.offMouseDown=function(a){return this.unsetCallback(this._downCallbacks,a),this},c.prototype.onMouseUp=function(a){return this.setCallback(this._upCallbacks,a),this},c.prototype.offMouseUp=function(a){return this.unsetCallback(this._upCallbacks,a),this},c.prototype.onWheel=function(a){return this.setCallback(this._wheelCallbacks,a),this},c.prototype.offWheel=function(a){return this.unsetCallback(this._wheelCallbacks,a),this},c.prototype.onDblClick=function(a){return this.setCallback(this._dblClickCallbacks,a),this},c.prototype.offDblClick=function(a){return this.unsetCallback(this._dblClickCallbacks,a),this},c.prototype._measureAndDispatch=function(a,b){var c=this.translator.computePosition(a.clientX,a.clientY);null!=c&&(this._lastMousePosition=c,b.callCallbacks(this.getLastMousePosition(),a))},c.prototype.getLastMousePosition=function(){return this._lastMousePosition},c._DISPATCHER_KEY="__Plottable_Dispatcher_Mouse",c}(a.Dispatcher);b.Mouse=c}(b=a.Dispatchers||(a.Dispatchers={}))}(Plottable||(Plottable={}));var __extends=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c},Plottable;!function(a){var b;!function(b){var c=function(b){function c(c){var d=this;b.call(this),this.translator=a.Utils.ClientToSVGTranslator.getTranslator(c),this._startCallbacks=new a.Utils.CallbackSet,this._moveCallbacks=new a.Utils.CallbackSet,this._endCallbacks=new a.Utils.CallbackSet,this._cancelCallbacks=new a.Utils.CallbackSet,this._callbacks=[this._moveCallbacks,this._startCallbacks,this._endCallbacks,this._cancelCallbacks],this._event2Callback.touchstart=function(a){return d._measureAndDispatch(a,d._startCallbacks)},this._event2Callback.touchmove=function(a){return d._measureAndDispatch(a,d._moveCallbacks)},this._event2Callback.touchend=function(a){return d._measureAndDispatch(a,d._endCallbacks)},this._event2Callback.touchcancel=function(a){return d._measureAndDispatch(a,d._cancelCallbacks)}}return __extends(c,b),c.getDispatcher=function(b){var d=a.Utils.DOM.getBoundingSVG(b),e=d[c._DISPATCHER_KEY];return null==e&&(e=new c(d),d[c._DISPATCHER_KEY]=e),e},c.prototype.onTouchStart=function(a){return this.setCallback(this._startCallbacks,a),this},c.prototype.offTouchStart=function(a){return this.unsetCallback(this._startCallbacks,a),this},c.prototype.onTouchMove=function(a){return this.setCallback(this._moveCallbacks,a),this},c.prototype.offTouchMove=function(a){return this.unsetCallback(this._moveCallbacks,a),this},c.prototype.onTouchEnd=function(a){return this.setCallback(this._endCallbacks,a),this},c.prototype.offTouchEnd=function(a){return this.unsetCallback(this._endCallbacks,a),this},c.prototype.onTouchCancel=function(a){return this.setCallback(this._cancelCallbacks,a),this},c.prototype.offTouchCancel=function(a){return this.unsetCallback(this._cancelCallbacks,a),this},c.prototype._measureAndDispatch=function(a,b){for(var c=a.changedTouches,d={},e=[],f=0;f<c.length;f++){var g=c[f],h=g.identifier,i=this.translator.computePosition(g.clientX,g.clientY);null!=i&&(d[h]=i,e.push(h))}e.length>0&&b.callCallbacks(e,d,a)},c._DISPATCHER_KEY="__Plottable_Dispatcher_Touch",c}(a.Dispatcher);b.Touch=c}(b=a.Dispatchers||(a.Dispatchers={}))}(Plottable||(Plottable={}));var __extends=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c},Plottable;!function(a){var b;!function(b){var c=function(b){function c(){var c=this;b.call(this),this._event2Callback.keydown=function(a){return c._processKeydown(a)},this._keydownCallbacks=new a.Utils.CallbackSet,this._callbacks=[this._keydownCallbacks]}return __extends(c,b),c.getDispatcher=function(){var a=document[c._DISPATCHER_KEY];return null==a&&(a=new c,document[c._DISPATCHER_KEY]=a),a},c.prototype.onKeyDown=function(a){return this.setCallback(this._keydownCallbacks,a),this},c.prototype.offKeyDown=function(a){return this.unsetCallback(this._keydownCallbacks,a),this},c.prototype._processKeydown=function(a){this._keydownCallbacks.callCallbacks(a.keyCode,a)},c._DISPATCHER_KEY="__Plottable_Dispatcher_Key",c}(a.Dispatcher);b.Key=c}(b=a.Dispatchers||(a.Dispatchers={}))}(Plottable||(Plottable={}));var Plottable;!function(a){var b=function(){function a(){var a=this;this._anchorCallback=function(b){return a._anchor(b)}}return a.prototype._anchor=function(){this._isAnchored=!0},a.prototype._unanchor=function(){this._isAnchored=!1},a.prototype.attachTo=function(a){return this._componentAttachedTo&&this.detachFrom(this._componentAttachedTo),this._componentAttachedTo=a,a.onAnchor(this._anchorCallback),this},a.prototype.detachFrom=function(a){return this._isAnchored&&this._unanchor(),this._componentAttachedTo=null,a.offAnchor(this._anchorCallback),this},a.prototype._translateToComponentSpace=function(a){var b=this._componentAttachedTo.originToSVG();return{x:a.x-b.x,y:a.y-b.y}},a.prototype._isInsideComponent=function(a){return 0<=a.x&&0<=a.y&&a.x<=this._componentAttachedTo.width()&&a.y<=this._componentAttachedTo.height()},a}();a.Interaction=b}(Plottable||(Plottable={}));var __extends=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c},Plottable;!function(a){var b;!function(b){var c=function(b){function c(){var c=this;b.apply(this,arguments),this._clickedDown=!1,this._onClickCallbacks=new a.Utils.CallbackSet,this._mouseDownCallback=function(a){return c._handleClickDown(a)},this._mouseUpCallback=function(a){return c._handleClickUp(a)},this._touchStartCallback=function(a,b){return c._handleClickDown(b[a[0]])},this._touchEndCallback=function(a,b){return c._handleClickUp(b[a[0]])},this._touchCancelCallback=function(){return c._clickedDown=!1}}return __extends(c,b),c.prototype._anchor=function(c){b.prototype._anchor.call(this,c),this._mouseDispatcher=a.Dispatchers.Mouse.getDispatcher(c.content().node()),this._mouseDispatcher.onMouseDown(this._mouseDownCallback),this._mouseDispatcher.onMouseUp(this._mouseUpCallback),this._touchDispatcher=a.Dispatchers.Touch.getDispatcher(c.content().node()),this._touchDispatcher.onTouchStart(this._touchStartCallback),this._touchDispatcher.onTouchEnd(this._touchEndCallback),this._touchDispatcher.onTouchCancel(this._touchCancelCallback)},c.prototype._unanchor=function(){b.prototype._unanchor.call(this),this._mouseDispatcher.offMouseDown(this._mouseDownCallback),this._mouseDispatcher.offMouseUp(this._mouseUpCallback),this._mouseDispatcher=null,this._touchDispatcher.offTouchStart(this._touchStartCallback),this._touchDispatcher.offTouchEnd(this._touchEndCallback),this._touchDispatcher.offTouchCancel(this._touchCancelCallback),this._touchDispatcher=null},c.prototype._handleClickDown=function(a){var b=this._translateToComponentSpace(a);this._isInsideComponent(b)&&(this._clickedDown=!0)},c.prototype._handleClickUp=function(a){var b=this._translateToComponentSpace(a);this._clickedDown&&this._isInsideComponent(b)&&this._onClickCallbacks.callCallbacks(b),this._clickedDown=!1},c.prototype.onClick=function(a){return this._onClickCallbacks.add(a),this
},c.prototype.offClick=function(a){return this._onClickCallbacks["delete"](a),this},c}(a.Interaction);b.Click=c}(b=a.Interactions||(a.Interactions={}))}(Plottable||(Plottable={}));var __extends=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c},Plottable;!function(a){var b;!function(b){var c;!function(a){a[a.NotClicked=0]="NotClicked",a[a.SingleClicked=1]="SingleClicked",a[a.DoubleClicked=2]="DoubleClicked"}(c||(c={}));var d=function(b){function c(){var c=this;b.apply(this,arguments),this._clickState=0,this._clickedDown=!1,this._onDoubleClickCallbacks=new a.Utils.CallbackSet,this._mouseDownCallback=function(a){return c._handleClickDown(a)},this._mouseUpCallback=function(a){return c._handleClickUp(a)},this._dblClickCallback=function(){return c._handleDblClick()},this._touchStartCallback=function(a,b){return c._handleClickDown(b[a[0]])},this._touchEndCallback=function(a,b){return c._handleClickUp(b[a[0]])},this._touchCancelCallback=function(){return c._handleClickCancel()}}return __extends(c,b),c.prototype._anchor=function(c){b.prototype._anchor.call(this,c),this._mouseDispatcher=a.Dispatchers.Mouse.getDispatcher(c.content().node()),this._mouseDispatcher.onMouseDown(this._mouseDownCallback),this._mouseDispatcher.onMouseUp(this._mouseUpCallback),this._mouseDispatcher.onDblClick(this._dblClickCallback),this._touchDispatcher=a.Dispatchers.Touch.getDispatcher(c.content().node()),this._touchDispatcher.onTouchStart(this._touchStartCallback),this._touchDispatcher.onTouchEnd(this._touchEndCallback),this._touchDispatcher.onTouchCancel(this._touchCancelCallback)},c.prototype._unanchor=function(){b.prototype._unanchor.call(this),this._mouseDispatcher.offMouseDown(this._mouseDownCallback),this._mouseDispatcher.offMouseUp(this._mouseUpCallback),this._mouseDispatcher.offDblClick(this._dblClickCallback),this._mouseDispatcher=null,this._touchDispatcher.offTouchStart(this._touchStartCallback),this._touchDispatcher.offTouchEnd(this._touchEndCallback),this._touchDispatcher.offTouchCancel(this._touchCancelCallback),this._touchDispatcher=null},c.prototype._handleClickDown=function(a){var b=this._translateToComponentSpace(a);this._isInsideComponent(b)&&(1===this._clickState&&c.pointsEqual(b,this._clickedPoint)||(this._clickState=0),this._clickedPoint=b,this._clickedDown=!0)},c.prototype._handleClickUp=function(a){var b=this._translateToComponentSpace(a);this._clickState=this._clickedDown&&c.pointsEqual(b,this._clickedPoint)?0===this._clickState?1:2:0,this._clickedDown=!1},c.prototype._handleDblClick=function(){2===this._clickState&&(this._onDoubleClickCallbacks.callCallbacks(this._clickedPoint),this._clickState=0)},c.prototype._handleClickCancel=function(){this._clickState=0,this._clickedDown=!1},c.pointsEqual=function(a,b){return a.x===b.x&&a.y===b.y},c.prototype.onDoubleClick=function(a){return this._onDoubleClickCallbacks.add(a),this},c.prototype.offDoubleClick=function(a){return this._onDoubleClickCallbacks["delete"](a),this},c}(a.Interaction);b.DoubleClick=d}(b=a.Interactions||(a.Interactions={}))}(Plottable||(Plottable={}));var __extends=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c},Plottable;!function(a){var b;!function(b){var c=function(b){function c(){var a=this;b.apply(this,arguments),this._keyCodeCallbacks={},this._mouseMoveCallback=function(){return!1},this._keyDownCallback=function(b){return a._handleKeyEvent(b)}}return __extends(c,b),c.prototype._anchor=function(c){b.prototype._anchor.call(this,c),this._positionDispatcher=a.Dispatchers.Mouse.getDispatcher(this._componentAttachedTo._element.node()),this._positionDispatcher.onMouseMove(this._mouseMoveCallback),this._keyDispatcher=a.Dispatchers.Key.getDispatcher(),this._keyDispatcher.onKeyDown(this._keyDownCallback)},c.prototype._unanchor=function(){b.prototype._unanchor.call(this),this._positionDispatcher.offMouseMove(this._mouseMoveCallback),this._positionDispatcher=null,this._keyDispatcher.offKeyDown(this._keyDownCallback),this._keyDispatcher=null},c.prototype._handleKeyEvent=function(a){var b=this._translateToComponentSpace(this._positionDispatcher.getLastMousePosition());this._isInsideComponent(b)&&this._keyCodeCallbacks[a]&&this._keyCodeCallbacks[a].callCallbacks(a)},c.prototype.onKey=function(b,c){return this._keyCodeCallbacks[b]||(this._keyCodeCallbacks[b]=new a.Utils.CallbackSet),this._keyCodeCallbacks[b].add(c),this},c.prototype.offKey=function(a,b){return this._keyCodeCallbacks[a]["delete"](b),0===this._keyCodeCallbacks[a].values().length&&delete this._keyCodeCallbacks[a],this},c}(a.Interaction);b.Key=c}(b=a.Interactions||(a.Interactions={}))}(Plottable||(Plottable={}));var __extends=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c},Plottable;!function(a){var b;!function(b){var c=function(b){function c(){var c=this;b.apply(this,arguments),this._overComponent=!1,this._pointerEnterCallbacks=new a.Utils.CallbackSet,this._pointerMoveCallbacks=new a.Utils.CallbackSet,this._pointerExitCallbacks=new a.Utils.CallbackSet,this._mouseMoveCallback=function(a){return c._handlePointerEvent(a)},this._touchStartCallback=function(a,b){return c._handlePointerEvent(b[a[0]])}}return __extends(c,b),c.prototype._anchor=function(c){b.prototype._anchor.call(this,c),this._mouseDispatcher=a.Dispatchers.Mouse.getDispatcher(this._componentAttachedTo.content().node()),this._mouseDispatcher.onMouseMove(this._mouseMoveCallback),this._touchDispatcher=a.Dispatchers.Touch.getDispatcher(this._componentAttachedTo.content().node()),this._touchDispatcher.onTouchStart(this._touchStartCallback)},c.prototype._unanchor=function(){b.prototype._unanchor.call(this),this._mouseDispatcher.offMouseMove(this._mouseMoveCallback),this._mouseDispatcher=null,this._touchDispatcher.offTouchStart(this._touchStartCallback),this._touchDispatcher=null},c.prototype._handlePointerEvent=function(a){var b=this._translateToComponentSpace(a);if(this._isInsideComponent(b)){var c=this._overComponent;this._overComponent=!0,c||this._pointerEnterCallbacks.callCallbacks(b),this._pointerMoveCallbacks.callCallbacks(b)}else this._overComponent&&(this._overComponent=!1,this._pointerExitCallbacks.callCallbacks(b))},c.prototype.onPointerEnter=function(a){return this._pointerEnterCallbacks.add(a),this},c.prototype.offPointerEnter=function(a){return this._pointerEnterCallbacks["delete"](a),this},c.prototype.onPointerMove=function(a){return this._pointerMoveCallbacks.add(a),this},c.prototype.offPointerMove=function(a){return this._pointerMoveCallbacks["delete"](a),this},c.prototype.onPointerExit=function(a){return this._pointerExitCallbacks.add(a),this},c.prototype.offPointerExit=function(a){return this._pointerExitCallbacks["delete"](a),this},c}(a.Interaction);b.Pointer=c}(b=a.Interactions||(a.Interactions={}))}(Plottable||(Plottable={}));var __extends=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c},Plottable;!function(a){var b;!function(b){var c=function(c){function d(a,d){var e=this;c.call(this),this._wheelCallback=function(a,b){return e._handleWheelEvent(a,b)},this._touchStartCallback=function(a,b,c){return e._handleTouchStart(a,b,c)},this._touchMoveCallback=function(a,b,c){return e._handlePinch(a,b,c)},this._touchEndCallback=function(a,b,c){return e._handleTouchEnd(a,b,c)},this._touchCancelCallback=function(a,b,c){return e._handleTouchEnd(a,b,c)},this._xScale=a,this._yScale=d,this._dragInteraction=new b.Drag,this._setupDragInteraction(),this._touchIds=d3.map()}return __extends(d,c),d.prototype._anchor=function(b){c.prototype._anchor.call(this,b),this._dragInteraction.attachTo(b),this._mouseDispatcher=a.Dispatchers.Mouse.getDispatcher(this._componentAttachedTo.content().node()),this._mouseDispatcher.onWheel(this._wheelCallback),this._touchDispatcher=a.Dispatchers.Touch.getDispatcher(this._componentAttachedTo.content().node()),this._touchDispatcher.onTouchStart(this._touchStartCallback),this._touchDispatcher.onTouchMove(this._touchMoveCallback),this._touchDispatcher.onTouchEnd(this._touchEndCallback),this._touchDispatcher.onTouchCancel(this._touchCancelCallback)},d.prototype._unanchor=function(){c.prototype._unanchor.call(this),this._mouseDispatcher.offWheel(this._wheelCallback),this._mouseDispatcher=null,this._touchDispatcher.offTouchStart(this._touchStartCallback),this._touchDispatcher.offTouchMove(this._touchMoveCallback),this._touchDispatcher.offTouchEnd(this._touchEndCallback),this._touchDispatcher.offTouchCancel(this._touchCancelCallback),this._touchDispatcher=null,this._dragInteraction.detachFrom(this._componentAttachedTo)},d.prototype._handleTouchStart=function(a,b){for(var c=0;c<a.length&&this._touchIds.size()<2;c++){var d=a[c];this._touchIds.set(d.toString(),this._translateToComponentSpace(b[d]))}},d.prototype._handlePinch=function(a,b){var c=this;if(!(this._touchIds.size()<2)){var e=this.centerPoint(),f=this.cornerDistance();a.forEach(function(a){c._touchIds.has(a.toString())&&c._touchIds.set(a.toString(),c._translateToComponentSpace(b[a]))});var g=this.centerPoint(),h=this.cornerDistance();null!=this._xScale&&0!==h&&0!==f&&(d.magnifyScale(this._xScale,f/h,e.x),d.translateScale(this._xScale,e.x-g.x)),null!=this._yScale&&0!==h&&0!==f&&(d.magnifyScale(this._yScale,f/h,e.y),d.translateScale(this._yScale,e.y-g.y))}},d.prototype.centerPoint=function(){var a=this._touchIds.values(),b=a[0],c=a[1],d=Math.min(b.x,c.x),e=Math.max(b.x,c.x),f=Math.min(b.y,c.y),g=Math.max(b.y,c.y);return{x:(d+e)/2,y:(g+f)/2}},d.prototype.cornerDistance=function(){var a=this._touchIds.values(),b=a[0],c=a[1],d=Math.min(b.x,c.x),e=Math.max(b.x,c.x),f=Math.min(b.y,c.y),g=Math.max(b.y,c.y);return Math.sqrt(Math.pow(e-d,2)+Math.pow(g-f,2))},d.prototype._handleTouchEnd=function(a){var b=this;a.forEach(function(a){b._touchIds.remove(a.toString())})},d.magnifyScale=function(a,b,c){var d=function(d){return a.invert(c-(c-d)*b)};a.domain(a.range().map(d))},d.translateScale=function(a,b){var c=function(c){return a.invert(c+b)};a.domain(a.range().map(c))},d.prototype._handleWheelEvent=function(a,b){var c=this._translateToComponentSpace(a);if(this._isInsideComponent(c)){b.preventDefault();var e=b.deltaY*(b.deltaMode?d.PIXELS_PER_LINE:1),f=Math.pow(2,.002*e);null!=this._xScale&&d.magnifyScale(this._xScale,f,c.x),null!=this._yScale&&d.magnifyScale(this._yScale,f,c.y)}},d.prototype._setupDragInteraction=function(){var a=this;this._dragInteraction.constrainToComponent(!1);var b;this._dragInteraction.onDragStart(function(){return b=null}),this._dragInteraction.onDrag(function(c,e){if(!(a._touchIds.size()>=2)){if(null!=a._xScale){var f=e.x-(null==b?c.x:b.x);d.translateScale(a._xScale,-f)}if(null!=a._yScale){var g=e.y-(null==b?c.y:b.y);d.translateScale(a._yScale,-g)}b=e}})},d.PIXELS_PER_LINE=120,d}(a.Interaction);b.PanZoom=c}(b=a.Interactions||(a.Interactions={}))}(Plottable||(Plottable={}));var __extends=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c},Plottable;!function(a){var b;!function(b){var c=function(b){function c(){var c=this;b.apply(this,arguments),this._dragging=!1,this._constrain=!0,this._dragStartCallbacks=new a.Utils.CallbackSet,this._dragCallbacks=new a.Utils.CallbackSet,this._dragEndCallbacks=new a.Utils.CallbackSet,this._mouseDownCallback=function(a,b){return c._startDrag(a,b)},this._mouseMoveCallback=function(a,b){return c._doDrag(a,b)},this._mouseUpCallback=function(a,b){return c._endDrag(a,b)},this._touchStartCallback=function(a,b,d){return c._startDrag(b[a[0]],d)},this._touchMoveCallback=function(a,b,d){return c._doDrag(b[a[0]],d)},this._touchEndCallback=function(a,b,d){return c._endDrag(b[a[0]],d)}}return __extends(c,b),c.prototype._anchor=function(c){b.prototype._anchor.call(this,c),this._mouseDispatcher=a.Dispatchers.Mouse.getDispatcher(this._componentAttachedTo.content().node()),this._mouseDispatcher.onMouseDown(this._mouseDownCallback),this._mouseDispatcher.onMouseMove(this._mouseMoveCallback),this._mouseDispatcher.onMouseUp(this._mouseUpCallback),this._touchDispatcher=a.Dispatchers.Touch.getDispatcher(this._componentAttachedTo.content().node()),this._touchDispatcher.onTouchStart(this._touchStartCallback),this._touchDispatcher.onTouchMove(this._touchMoveCallback),this._touchDispatcher.onTouchEnd(this._touchEndCallback)},c.prototype._unanchor=function(){b.prototype._unanchor.call(this),this._mouseDispatcher.offMouseDown(this._mouseDownCallback),this._mouseDispatcher.offMouseMove(this._mouseMoveCallback),this._mouseDispatcher.offMouseUp(this._mouseUpCallback),this._mouseDispatcher=null,this._touchDispatcher.offTouchStart(this._touchStartCallback),this._touchDispatcher.offTouchMove(this._touchMoveCallback),this._touchDispatcher.offTouchEnd(this._touchEndCallback),this._touchDispatcher=null},c.prototype._translateAndConstrain=function(b){var c=this._translateToComponentSpace(b);return this._constrain?{x:a.Utils.Methods.clamp(c.x,0,this._componentAttachedTo.width()),y:a.Utils.Methods.clamp(c.y,0,this._componentAttachedTo.height())}:c},c.prototype._startDrag=function(a,b){if(!(b instanceof MouseEvent&&0!==b.button)){var c=this._translateToComponentSpace(a);this._isInsideComponent(c)&&(b.preventDefault(),this._dragging=!0,this._dragOrigin=c,this._dragStartCallbacks.callCallbacks(this._dragOrigin))}},c.prototype._doDrag=function(a){this._dragging&&this._dragCallbacks.callCallbacks(this._dragOrigin,this._translateAndConstrain(a))},c.prototype._endDrag=function(a,b){b instanceof MouseEvent&&0!==b.button||this._dragging&&(this._dragging=!1,this._dragEndCallbacks.callCallbacks(this._dragOrigin,this._translateAndConstrain(a)))},c.prototype.constrainToComponent=function(a){return null==a?this._constrain:(this._constrain=a,this)},c.prototype.onDragStart=function(a){return this._dragStartCallbacks.add(a),this},c.prototype.offDragStart=function(a){return this._dragStartCallbacks["delete"](a),this},c.prototype.onDrag=function(a){return this._dragCallbacks.add(a),this},c.prototype.offDrag=function(a){return this._dragCallbacks["delete"](a),this},c.prototype.onDragEnd=function(a){return this._dragEndCallbacks.add(a),this},c.prototype.offDragEnd=function(a){return this._dragEndCallbacks["delete"](a),this},c}(a.Interaction);b.Drag=c}(b=a.Interactions||(a.Interactions={}))}(Plottable||(Plottable={}));var __extends=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c},Plottable;!function(a){var b;!function(b){var c=function(b){function c(){b.call(this),this._detectionRadius=3,this._resizable=!1,this._hasCorners=!0,this._clipPathEnabled=!0,this.classed("drag-box-layer",!0),this._dragInteraction=new a.Interactions.Drag,this._setUpCallbacks(),this._dragInteraction.attachTo(this),this._dragStartCallbacks=new a.Utils.CallbackSet,this._dragCallbacks=new a.Utils.CallbackSet,this._dragEndCallbacks=new a.Utils.CallbackSet}return __extends(c,b),c.prototype._setUpCallbacks=function(){var a,b,c,d,e=this;this._dragInteraction.onDragStart(function(f){a=e._getResizingEdges(f),e.boxVisible()&&(a.top||a.bottom||a.left||a.right)?d=!1:(e.bounds({topLeft:f,bottomRight:f}),d=!0),e.boxVisible(!0);var g=e.bounds();b={x:g.topLeft.x,y:g.topLeft.y},c={x:g.bottomRight.x,y:g.bottomRight.y},e._dragStartCallbacks.callCallbacks(g)}),this._dragInteraction.onDrag(function(f,g){d?(c.x=g.x,c.y=g.y):(a.bottom?c.y=g.y:a.top&&(b.y=g.y),a.right?c.x=g.x:a.left&&(b.x=g.x)),e.bounds({topLeft:b,bottomRight:c}),e._dragCallbacks.callCallbacks(e.bounds())}),this._dragInteraction.onDragEnd(function(a,b){d&&a.x===b.x&&a.y===b.y&&e.boxVisible(!1),e._dragEndCallbacks.callCallbacks(e.bounds())})},c.prototype._setup=function(){var a=this;b.prototype._setup.call(this);var c=function(){return a._box.append("line").style({opacity:0,stroke:"pink"})};if(this._detectionEdgeT=c().classed("drag-edge-tb",!0),this._detectionEdgeB=c().classed("drag-edge-tb",!0),this._detectionEdgeL=c().classed("drag-edge-lr",!0),this._detectionEdgeR=c().classed("drag-edge-lr",!0),this._hasCorners){var d=function(){return a._box.append("circle").style({opacity:0,fill:"pink"})};this._detectionCornerTL=d().classed("drag-corner-tl",!0),this._detectionCornerTR=d().classed("drag-corner-tr",!0),this._detectionCornerBL=d().classed("drag-corner-bl",!0),this._detectionCornerBR=d().classed("drag-corner-br",!0)}},c.prototype._getResizingEdges=function(a){var b={top:!1,bottom:!1,left:!1,right:!1};if(!this.resizable())return b;var c=this.bounds(),d=c.topLeft.y,e=c.bottomRight.y,f=c.topLeft.x,g=c.bottomRight.x,h=this._detectionRadius;return f-h<=a.x&&a.x<=g+h&&(b.top=d-h<=a.y&&a.y<=d+h,b.bottom=e-h<=a.y&&a.y<=e+h),d-h<=a.y&&a.y<=e+h&&(b.left=f-h<=a.x&&a.x<=f+h,b.right=g-h<=a.x&&a.x<=g+h),b},c.prototype.renderImmediately=function(){if(b.prototype.renderImmediately.call(this),this.boxVisible()){var a=this.bounds(),c=a.topLeft.y,d=a.bottomRight.y,e=a.topLeft.x,f=a.bottomRight.x;return this._detectionEdgeT.attr({x1:e,y1:c,x2:f,y2:c,"stroke-width":2*this._detectionRadius}),this._detectionEdgeB.attr({x1:e,y1:d,x2:f,y2:d,"stroke-width":2*this._detectionRadius}),this._detectionEdgeL.attr({x1:e,y1:c,x2:e,y2:d,"stroke-width":2*this._detectionRadius}),this._detectionEdgeR.attr({x1:f,y1:c,x2:f,y2:d,"stroke-width":2*this._detectionRadius}),this._hasCorners&&(this._detectionCornerTL.attr({cx:e,cy:c,r:this._detectionRadius}),this._detectionCornerTR.attr({cx:f,cy:c,r:this._detectionRadius}),this._detectionCornerBL.attr({cx:e,cy:d,r:this._detectionRadius}),this._detectionCornerBR.attr({cx:f,cy:d,r:this._detectionRadius})),this}},c.prototype.detectionRadius=function(a){if(null==a)return this._detectionRadius;if(0>a)throw new Error("detection radius cannot be negative.");return this._detectionRadius=a,this.render(),this},c.prototype.resizable=function(a){return null==a?this._resizable:(this._resizable=a,this._setResizableClasses(a),this)},c.prototype._setResizableClasses=function(a){this.classed("x-resizable",a),this.classed("y-resizable",a)},c.prototype.onDragStart=function(a){return this._dragStartCallbacks.add(a),this},c.prototype.offDragStart=function(a){return this._dragStartCallbacks["delete"](a),this},c.prototype.onDrag=function(a){return this._dragCallbacks.add(a),this},c.prototype.offDrag=function(a){return this._dragCallbacks["delete"](a),this},c.prototype.onDragEnd=function(a){return this._dragEndCallbacks.add(a),this},c.prototype.offDragEnd=function(a){return this._dragEndCallbacks["delete"](a),this},c}(b.SelectionBoxLayer);b.DragBoxLayer=c}(b=a.Components||(a.Components={}))}(Plottable||(Plottable={}));var __extends=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c},Plottable;!function(a){var b;!function(a){var b=function(a){function b(){a.call(this),this.classed("x-drag-box-layer",!0),this._hasCorners=!1}return __extends(b,a),b.prototype.computeLayout=function(b,c,d){return a.prototype.computeLayout.call(this,b,c,d),this.bounds(this.bounds()),this},b.prototype._setBounds=function(b){a.prototype._setBounds.call(this,{topLeft:{x:b.topLeft.x,y:0},bottomRight:{x:b.bottomRight.x,y:this.height()}})},b.prototype._setResizableClasses=function(a){this.classed("x-resizable",a)},b}(a.DragBoxLayer);a.XDragBoxLayer=b}(b=a.Components||(a.Components={}))}(Plottable||(Plottable={}));var __extends=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c},Plottable;!function(a){var b;!function(a){var b=function(a){function b(){a.call(this),this.classed("y-drag-box-layer",!0),this._hasCorners=!1}return __extends(b,a),b.prototype.computeLayout=function(b,c,d){return a.prototype.computeLayout.call(this,b,c,d),this.bounds(this.bounds()),this},b.prototype._setBounds=function(b){a.prototype._setBounds.call(this,{topLeft:{x:0,y:b.topLeft.y},bottomRight:{x:this.width(),y:b.bottomRight.y}})},b.prototype._setResizableClasses=function(a){this.classed("y-resizable",a)},b}(a.DragBoxLayer);a.YDragBoxLayer=b}(b=a.Components||(a.Components={}))}(Plottable||(Plottable={}));var SVGTypewriter;!function(a){!function(a){!function(a){function b(a,b){if(null==a||null==b)return a===b;if(a.length!==b.length)return!1;for(var c=0;c<a.length;c++)if(a[c]!==b[c])return!1;return!0}function c(a,c){if(null==a||null==c)return a===c;var d=Object.keys(a).sort(),e=Object.keys(c).sort(),f=d.map(function(b){return a[b]}),g=e.map(function(a){return c[a]});return b(d,e)&&b(f,g)}a.arrayEq=b,a.objEq=c}(a.Methods||(a.Methods={}));a.Methods}(a.Utils||(a.Utils={}));a.Utils}(SVGTypewriter||(SVGTypewriter={}));var SVGTypewriter;!function(a){!function(a){!function(a){function b(a,b,c){var d=d3.transform(a.attr("transform"));return null==b?d.translate:(c=null==c?0:c,d.translate[0]=b,d.translate[1]=c,a.attr("transform",d.toString()),a)}function c(a){var b;try{b=a.node().getBBox()}catch(c){b={x:0,y:0,width:0,height:0}}return b}a.transform=b,a.getBBox=c}(a.DOM||(a.DOM={}));a.DOM}(a.Utils||(a.Utils={}));a.Utils}(SVGTypewriter||(SVGTypewriter={}));var SVGTypewriter;!function(a){!function(a){var b=function(){function a(a,b){void 0===b&&(b=function(a,b){return a===b}),this.cache=d3.map(),this.compute=a,this.valueEq=b}return a.prototype.get=function(a){return this.cache.has(a)||this.cache.set(a,this.compute(a)),this.cache.get(a)},a.prototype.clear=function(){return this.cache=d3.map(),this},a}();a.Cache=b}(a.Utils||(a.Utils={}));a.Utils}(SVGTypewriter||(SVGTypewriter={}));var SVGTypewriter;!function(a){!function(a){var b=function(){function a(){this.WordDividerRegExp=new RegExp("\\W"),this.WhitespaceRegExp=new RegExp("\\s")}return a.prototype.tokenize=function(a){var b=this;return a.split("").reduce(function(a,c){return a.slice(0,-1).concat(b.shouldCreateNewToken(a[a.length-1],c))},[""])},a.prototype.shouldCreateNewToken=function(a,b){if(!a)return[b];var c=a[a.length-1];return this.WhitespaceRegExp.test(c)&&this.WhitespaceRegExp.test(b)?[a+b]:this.WhitespaceRegExp.test(c)||this.WhitespaceRegExp.test(b)?[a,b]:this.WordDividerRegExp.test(c)||this.WordDividerRegExp.test(b)?c===b?[a+b]:[a,b]:[a+b]},a}();a.Tokenizer=b}(a.Utils||(a.Utils={}));a.Utils}(SVGTypewriter||(SVGTypewriter={}));var SVGTypewriter;!function(a){!function(a){!function(a){function b(a){return a.replace(/\s+/g," ")}function c(a){return a&&""!==a.trim()}function d(a,b){if(!a)return a;var d=a.split(""),e=b?function(a){return a.split(b).some(c)}:c;return d.reduce(function(a,b){return e(a+b)?a+b:a},"")}function e(a,b){if(!a)return a;var c=a.split("");return c.reverse(),c=d(c.join(""),b).split(""),c.reverse(),c.join("")}a.combineWhitespace=b,a.isNotEmptyString=c,a.trimStart=d,a.trimEnd=e}(a.StringMethods||(a.StringMethods={}));a.StringMethods}(a.Utils||(a.Utils={}));a.Utils}(SVGTypewriter||(SVGTypewriter={}));var SVGTypewriter;!function(a){!function(a){var b=function(){function a(){this.duration(a.DEFAULT_DURATION_MILLISECONDS),this.delay(0),this.easing(a.DEFAULT_EASING),this.moveX(0),this.moveY(0)}return a.prototype.animate=function(a){var b=d3.transform("");return b.translate=[this.moveX(),this.moveY()],a.attr("transform",b.toString()),b.translate=[0,0],this._animate(a,{transform:b.toString()})},a.prototype._animate=function(a,b){return a.transition().ease(this.easing()).duration(this.duration()).delay(this.delay()).attr(b)},a.prototype.duration=function(a){return null==a?this._duration:(this._duration=a,this)},a.prototype.moveX=function(a){return null==a?this._moveX:(this._moveX=a,this)},a.prototype.moveY=function(a){return null==a?this._moveY:(this._moveY=a,this)},a.prototype.delay=function(a){return null==a?this._delay:(this._delay=a,this)},a.prototype.easing=function(a){return null==a?this._easing:(this._easing=a,this)},a.DEFAULT_DURATION_MILLISECONDS=300,a.DEFAULT_EASING="exp-out",a}();a.BaseAnimator=b}(a.Animators||(a.Animators={}));a.Animators}(SVGTypewriter||(SVGTypewriter={}));var __extends=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c},SVGTypewriter;!function(a){!function(b){var c=function(b){function c(){this.direction("bottom"),b.call(this)}return __extends(c,b),c.prototype.direction=function(a){if(null==a)return this._direction;if(-1===c.SupportedDirections.indexOf(a))throw new Error("unsupported direction - "+a);return this._direction=a,this},c.prototype.animate=function(c){var d=a.Utils.DOM.getBBox(c),e=c.select(".clip-rect");switch(e.attr("width",0),e.attr("height",0),this._direction){case"top":e.attr("y",d.y+d.height),e.attr("x",d.x),e.attr("width",d.width);break;case"bottom":e.attr("y",d.y),e.attr("x",d.x),e.attr("width",d.width);break;case"left":e.attr("y",d.y),e.attr("x",d.x),e.attr("height",d.height);break;case"right":e.attr("y",d.y),e.attr("x",d.x+d.width),e.attr("height",d.height)}return this._animate(e,d),b.prototype.animate.call(this,c)},c.SupportedDirections=["top","bottom","left","right"],c}(b.BaseAnimator);b.UnveilAnimator=c}(a.Animators||(a.Animators={}));a.Animators}(SVGTypewriter||(SVGTypewriter={}));var __extends=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c},SVGTypewriter;!function(a){!function(a){var b=function(a){function b(){a.apply(this,arguments)}return __extends(b,a),b.prototype.animate=function(b){var c=b.select(".text-area");c.attr("opacity",0);var d={opacity:1};return this._animate(c,d),a.prototype.animate.call(this,b)},b}(a.BaseAnimator);a.OpacityAnimator=b}(a.Animators||(a.Animators={}));a.Animators}(SVGTypewriter||(SVGTypewriter={}));var SVGTypewriter;!function(a){!function(b){var c=function(){function b(){this.maxLines(1/0),this.textTrimming("ellipsis"),this.allowBreakingWords(!0),this._tokenizer=new a.Utils.Tokenizer,this._breakingCharacter="-"}return b.prototype.maxLines=function(a){return null==a?this._maxLines:(this._maxLines=a,this)},b.prototype.textTrimming=function(a){if(null==a)return this._textTrimming;if("ellipsis"!==a&&"none"!==a)throw new Error(a+" - unsupported text trimming option.");return this._textTrimming=a,this},b.prototype.allowBreakingWords=function(a){return null==a?this._allowBreakingWords:(this._allowBreakingWords=a,this)},b.prototype.wrap=function(a,b,c,d){var e=this;void 0===d&&(d=1/0);var f={originalText:a,wrappedText:"",noLines:0,noBrokeWords:0,truncatedText:""},g={wrapping:f,currentLine:"",availableWidth:c,availableLines:Math.min(Math.floor(d/b.measure().height),this._maxLines),canFitText:!0},h=a.split("\n");return h.reduce(function(a,c,d){return e.breakLineToFitWidth(a,c,d!==h.length-1,b)},g).wrapping},b.prototype.breakLineToFitWidth=function(b,c,d,e){var f=this;b.canFitText||""===b.wrapping.truncatedText||(b.wrapping.truncatedText+="\n");var g=this._tokenizer.tokenize(c);b=g.reduce(function(a,b){return f.wrapNextToken(b,a,e)},b);var h=a.Utils.StringMethods.trimEnd(b.currentLine);if(b.wrapping.noLines+=+(""!==h),b.wrapping.noLines===b.availableLines&&"none"!==this._textTrimming&&d){var i=this.addEllipsis(h,b.availableWidth,e);b.wrapping.wrappedText+=i.wrappedToken,b.wrapping.truncatedText+=i.remainingToken,b.canFitText=!1}else b.wrapping.wrappedText+=h;return b.currentLine="\n",b},b.prototype.canFitToken=function(a,b,c){var d=this,e=this._allowBreakingWords?a.split("").map(function(b,c){return c!==a.length-1?b+d._breakingCharacter:b}):[a];return c.measure(a).width<=b||e.every(function(a){return c.measure(a).width<=b})},b.prototype.addEllipsis=function(b,c,d){if("none"===this._textTrimming)return{wrappedToken:b,remainingToken:""};var e=b.substring(0).trim(),f=d.measure(e).width,g=d.measure("...").width,h=b.length>0&&"\n"===b[0]?"\n":"";if(g>=c){var i=g/3,j=Math.floor(c/i);return{wrappedToken:h+"...".substr(0,j),remainingToken:b}}for(;f+g>c;)e=a.Utils.StringMethods.trimEnd(e.substr(0,e.length-1)),f=d.measure(e).width;return{wrappedToken:h+e+"...",remainingToken:a.Utils.StringMethods.trimEnd(b.substring(e.length),"-").trim()}},b.prototype.wrapNextToken=function(b,c,d){if(!c.canFitText||c.availableLines===c.wrapping.noLines||!this.canFitToken(b,c.availableWidth,d))return this.finishWrapping(b,c,d);for(var e=b;e;){var f=this.breakTokenToFitInWidth(e,c.currentLine,c.availableWidth,d);if(c.currentLine=f.line,e=f.remainingToken,null!=e){if(c.wrapping.noBrokeWords+=+f.breakWord,++c.wrapping.noLines,c.availableLines===c.wrapping.noLines){var g=this.addEllipsis(c.currentLine,c.availableWidth,d);return c.wrapping.wrappedText+=g.wrappedToken,c.wrapping.truncatedText+=g.remainingToken+e,c.currentLine="\n",c}c.wrapping.wrappedText+=a.Utils.StringMethods.trimEnd(c.currentLine),c.currentLine="\n"}}return c},b.prototype.finishWrapping=function(a,b,c){if(b.canFitText&&b.availableLines!==b.wrapping.noLines&&this._allowBreakingWords&&"none"!==this._textTrimming){var d=this.addEllipsis(b.currentLine+a,b.availableWidth,c);b.wrapping.wrappedText+=d.wrappedToken,b.wrapping.truncatedText+=d.remainingToken,b.wrapping.noBrokeWords+=+(d.remainingToken.length<a.length),b.wrapping.noLines+=+(d.wrappedToken.length>0),b.currentLine=""}else b.wrapping.truncatedText+=a;return b.canFitText=!1,b},b.prototype.breakTokenToFitInWidth=function(a,b,c,d,e){if(void 0===e&&(e=this._breakingCharacter),d.measure(b+a).width<=c)return{remainingToken:null,line:b+a,breakWord:!1};if(""===a.trim())return{remainingToken:"",line:b,breakWord:!1};if(!this._allowBreakingWords)return{remainingToken:a,line:b,breakWord:!1};for(var f=0;f<a.length&&d.measure(b+a.substring(0,f+1)+e).width<=c;)++f;var g="";return f>0&&(g=e),{remainingToken:a.substring(f),line:b+a.substring(0,f)+g,breakWord:f>0}},b}();b.Wrapper=c}(a.Wrappers||(a.Wrappers={}));a.Wrappers}(SVGTypewriter||(SVGTypewriter={}));var __extends=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c},SVGTypewriter;!function(a){!function(a){var b=function(a){function b(){a.apply(this,arguments)}return __extends(b,a),b.prototype.wrap=function(c,d,e,f){var g=this;void 0===f&&(f=1/0);var h=c.split("\n");if(h.length>1)throw new Error("SingleLineWrapper is designed to work only on single line");var i=function(b){return a.prototype.wrap.call(g,c,d,b,f)},j=i(e);if(j.noLines<2)return j;for(var k=0,l=e,m=0;m<b.NO_WRAP_ITERATIONS&&l>k;++m){var n=(l+k)/2,o=i(n);this.areSameResults(j,o)?(l=n,j=o):k=n}return j},b.prototype.areSameResults=function(a,b){return a.noLines===b.noLines&&a.truncatedText===b.truncatedText},b.NO_WRAP_ITERATIONS=5,b}(a.Wrapper);a.SingleLineWrapper=b}(a.Wrappers||(a.Wrappers={}));a.Wrappers}(SVGTypewriter||(SVGTypewriter={}));var SVGTypewriter;!function(a){!function(b){var c=function(){function b(a,c){this._writerID=b.nextID++,this._elementID=0,this.measurer(a),c&&this.wrapper(c),this.addTitleElement(!1)}return b.prototype.measurer=function(a){return this._measurer=a,this},b.prototype.wrapper=function(a){return this._wrapper=a,this},b.prototype.addTitleElement=function(a){return this._addTitleElement=a,this},b.prototype.writeLine=function(c,d,e,f,g){var h=d.append("text");h.text(c);var i=e*b.XOffsetFactor[f],j=b.AnchorConverter[f];h.attr("text-anchor",j).classed("text-line",!0),a.Utils.DOM.transform(h,i,g).attr("y","-0.25em")},b.prototype.writeText=function(a,c,d,e,f,g){var h=this,i=a.split("\n"),j=this._measurer.measure().height,k=b.YOffsetFactor[g]*(e-i.length*j);i.forEach(function(a,b){h.writeLine(a,c,d,f,(b+1)*j+k)})},b.prototype.write=function(a,c,d,e){if(-1===b.SupportedRotation.indexOf(e.textRotation))throw new Error("unsupported rotation - "+e.textRotation);var f=Math.abs(Math.abs(e.textRotation)-90)>45,g=f?c:d,h=f?d:c,i=e.selection.append("g").classed("text-container",!0);
this._addTitleElement&&i.append("title").text(a);var j=i.append("g").classed("text-area",!0),k=this._wrapper?this._wrapper.wrap(a,this._measurer,g,h).wrappedText:a;this.writeText(k,j,g,h,e.xAlign,e.yAlign);var l=d3.transform(""),m=d3.transform("");switch(l.rotate=e.textRotation,e.textRotation){case 90:l.translate=[c,0],m.rotate=-90,m.translate=[0,200];break;case-90:l.translate=[0,d],m.rotate=90,m.translate=[c,0];break;case 180:l.translate=[c,d],m.translate=[c,d],m.rotate=180}j.attr("transform",l.toString()),this.addClipPath(i,m),e.animator&&e.animator.animate(i)},b.prototype.addClipPath=function(b){var c=this._elementID++,d=/MSIE [5-9]/.test(navigator.userAgent)?"":document.location.href;d=d.split("#")[0];var e="clipPath"+this._writerID+"_"+c;b.select(".text-area").attr("clip-path",'url("'+d+"#"+e+'")');var f=b.append("clipPath").attr("id",e),g=a.Utils.DOM.getBBox(b.select(".text-area")),h=f.append("rect");h.classed("clip-rect",!0).attr(g)},b.nextID=0,b.SupportedRotation=[-90,0,180,90],b.AnchorConverter={left:"start",center:"middle",right:"end"},b.XOffsetFactor={left:0,center:.5,right:1},b.YOffsetFactor={top:0,center:.5,bottom:1},b}();b.Writer=c}(a.Writers||(a.Writers={}));a.Writers}(SVGTypewriter||(SVGTypewriter={}));var SVGTypewriter;!function(a){!function(b){var c=function(){function b(a,b){this.textMeasurer=this.getTextMeasurer(a,b)}return b.prototype.checkSelectionIsText=function(a){return"text"===a[0][0].tagName||!a.select("text").empty()},b.prototype.getTextMeasurer=function(a,b){var c=this;if(this.checkSelectionIsText(a)){var d,e=a.node().parentNode;return d="text"===a[0][0].tagName?a:a.select("text"),a.remove(),function(b){e.appendChild(a.node());var f=c.measureBBox(d,b);return a.remove(),f}}var f=a.append("text");return b&&f.classed(b,!0),f.remove(),function(b){a.node().appendChild(f.node());var d=c.measureBBox(f,b);return f.remove(),d}},b.prototype.measureBBox=function(b,c){b.text(c);var d=a.Utils.DOM.getBBox(b);return{width:d.width,height:d.height}},b.prototype.measure=function(a){return void 0===a&&(a=b.HEIGHT_TEXT),this.textMeasurer(a)},b.HEIGHT_TEXT="bqpdl",b}();b.AbstractMeasurer=c}(a.Measurers||(a.Measurers={}));a.Measurers}(SVGTypewriter||(SVGTypewriter={}));var __extends=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c},SVGTypewriter;!function(a){!function(a){var b=function(b){function c(a,c,d){void 0===c&&(c=null),void 0===d&&(d=!1),b.call(this,a,c),this.useGuards=d}return __extends(c,b),c.prototype._addGuards=function(b){return a.AbstractMeasurer.HEIGHT_TEXT+b+a.AbstractMeasurer.HEIGHT_TEXT},c.prototype.getGuardWidth=function(){return null==this.guardWidth&&(this.guardWidth=b.prototype.measure.call(this).width),this.guardWidth},c.prototype._measureLine=function(a){var c=this.useGuards?this._addGuards(a):a,d=b.prototype.measure.call(this,c);return d.width-=this.useGuards?2*this.getGuardWidth():0,d},c.prototype.measure=function(b){var c=this;if(void 0===b&&(b=a.AbstractMeasurer.HEIGHT_TEXT),""===b.trim())return{width:0,height:0};var d=b.trim().split("\n").map(function(a){return c._measureLine(a)});return{width:d3.max(d,function(a){return a.width}),height:d3.sum(d,function(a){return a.height})}},c}(a.AbstractMeasurer);a.Measurer=b}(a.Measurers||(a.Measurers={}));a.Measurers}(SVGTypewriter||(SVGTypewriter={}));var __extends=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c},SVGTypewriter;!function(a){!function(a){var b=function(a){function b(){a.apply(this,arguments)}return __extends(b,a),b.prototype._measureCharacter=function(b){return a.prototype._measureLine.call(this,b)},b.prototype._measureLine=function(a){var b=this,c=a.split("").map(function(a){return b._measureCharacter(a)});return{width:d3.sum(c,function(a){return a.width}),height:d3.max(c,function(a){return a.height})}},b}(a.Measurer);a.CharacterMeasurer=b}(a.Measurers||(a.Measurers={}));a.Measurers}(SVGTypewriter||(SVGTypewriter={}));var __extends=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c},SVGTypewriter;!function(a){!function(b){var c=function(b){function c(c,d){var e=this;b.call(this,c,d),this.cache=new a.Utils.Cache(function(a){return e._measureCharacterNotFromCache(a)},a.Utils.Methods.objEq)}return __extends(c,b),c.prototype._measureCharacterNotFromCache=function(a){return b.prototype._measureCharacter.call(this,a)},c.prototype._measureCharacter=function(a){return this.cache.get(a)},c.prototype.reset=function(){this.cache.clear()},c}(b.CharacterMeasurer);b.CacheCharacterMeasurer=c}(a.Measurers||(a.Measurers={}));a.Measurers}(SVGTypewriter||(SVGTypewriter={}));